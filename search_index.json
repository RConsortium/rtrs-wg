[["index.html", "Tables in Clinical Trials with R Chapter 1 About 1.1 Introduction 1.2 Call for Contributions 1.3 Data Used For Examples 1.4 Installing the R packages", " Tables in Clinical Trials with R R Consortium Tables Working Group 2023-03-21 Chapter 1 About 1.1 Introduction In this book we present various aspects of creating tables with the R language to analyze and report clinical trials data. The book is initiated by the R Consortium working group R Tables for Regulatory Submissions (RTRS). The R Consortium working group R Tables for Regulatory Submissions (RTRS) includes representation from several large pharmaceutical companies and CRO’s. The goal of the working group is to create standards for creating tables that meet the requirements of FDA submission documents, and hence enhance the suitability of R for FDA submissions. It is part of a larger R Consortium effort to facilitate the certification and validation of R packages and tools for FDA submissions thereby allowing drug developers to submit documentation for regulatory approval using the R programming environment in conjunction with open-source packages without the need for closed and often expensive proprietary tools. 1.2 Call for Contributions The content of this book is intended to grow via community contribution, so please add your subject matter expertise to this content by cloning the github repository of this book and make a pull request with your changes. We welcome all contribution, including but not limited to: summarizing table packages adding new example tables clarifying requirements and analyses improving R code In case you are new to using git and GitHub but would like to make a contribution then please write a GitHub issue and we will reach out to you to add the content. The most convenient way to get started is to: clone the GitHub repository of this book install the RStudio IDE Open the RStudio project in rtrs-wg/tables-book/tables-book.Rproj start working, see the Bookdown documentation, you can develop the book with the bookdown::serve_book() call. once ready to share your work create a PR use GitHub issues to communicate with us if you have difficulties 1.3 Data Used For Examples We use synthetic data for the examples in this book. The data is available from the random.cidsc.data R package which contains a number of datasets that follow the CDISC ADaM specifications. Code remotes::install_github(&quot;insightsengineering/random.cdisc.data&quot;) The data in random.cdisc.data is completely synthetic, meaning no patient data has been used to create it. The data is also fairly basic, meaning real study data often has more signal and patterns. Code data(package=&quot;random.cdisc.data&quot;)$results[, &quot;Item&quot;] [1] &quot;cadab&quot; &quot;cadae&quot; &quot;cadaette&quot; &quot;cadcm&quot; &quot;caddv&quot; &quot;cadeg&quot; [7] &quot;cadex&quot; &quot;cadhy&quot; &quot;cadlb&quot; &quot;cadmh&quot; &quot;cadpc&quot; &quot;cadpp&quot; [13] &quot;cadqlqc&quot; &quot;cadqs&quot; &quot;cadrs&quot; &quot;cadsl&quot; &quot;cadsub&quot; &quot;cadtr&quot; [19] &quot;cadtte&quot; &quot;cadvs&quot; In this document, the prepending c stands for caches. So, for example the cached synthetic subject level dataset ADSL: Code data(&quot;cadsl&quot;, package = &quot;random.cdisc.data&quot;) head(cadsl) # A tibble: 6 × 55 STUDYID USUBJID SUBJID SITEID AGE AGEU SEX RACE ETHNIC COUNTRY DTHFL &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; 1 AB12345 AB12345-CH… id-128 CHN-3 32 YEARS M ASIAN HISPA… CHN Y 2 AB12345 AB12345-CH… id-262 CHN-15 35 YEARS M BLAC… NOT H… CHN N 3 AB12345 AB12345-RU… id-378 RUS-3 30 YEARS F ASIAN NOT H… RUS N 4 AB12345 AB12345-CH… id-220 CHN-11 26 YEARS F ASIAN NOT H… CHN N 5 AB12345 AB12345-CH… id-267 CHN-7 40 YEARS M ASIAN NOT H… CHN N 6 AB12345 AB12345-CH… id-201 CHN-15 49 YEARS M ASIAN NOT H… CHN Y # … with 44 more variables: INVID &lt;chr&gt;, INVNAM &lt;chr&gt;, ARM &lt;fct&gt;, ARMCD &lt;fct&gt;, # ACTARM &lt;fct&gt;, ACTARMCD &lt;fct&gt;, TRT01P &lt;fct&gt;, TRT01A &lt;fct&gt;, TRT02P &lt;fct&gt;, # TRT02A &lt;fct&gt;, REGION1 &lt;fct&gt;, STRATA1 &lt;fct&gt;, STRATA2 &lt;fct&gt;, BMRKR1 &lt;dbl&gt;, # BMRKR2 &lt;fct&gt;, ITTFL &lt;fct&gt;, SAFFL &lt;fct&gt;, BMEASIFL &lt;fct&gt;, BEP01FL &lt;fct&gt;, # AEWITHFL &lt;fct&gt;, RANDDT &lt;date&gt;, TRTSDTM &lt;dttm&gt;, TRTEDTM &lt;dttm&gt;, # TRT01SDTM &lt;dttm&gt;, TRT01EDTM &lt;dttm&gt;, TRT02SDTM &lt;dttm&gt;, TRT02EDTM &lt;dttm&gt;, # AP01SDTM &lt;dttm&gt;, AP01EDTM &lt;dttm&gt;, AP02SDTM &lt;dttm&gt;, AP02EDTM &lt;dttm&gt;, … Code adsl &lt;- cadsl 1.4 Installing the R packages At some point we may switch to renv to install the R packages used for this book. For right now you can install the packages yourself with: Code install.packages(c(&quot;rtables&quot;, &quot;gt&quot;, &quot;remotes&quot;, &quot;tidyverse&quot;, &quot;bookdown&quot;, &quot;r2rtf&quot;)) install.packages(&#39;flextable&#39;, repos = &#39;https://davidgohel.r-universe.dev&#39;) remotes::install_github(&quot;insightsengineering/random.cdisc.data&quot;) remotes::install_github(&quot;insightsengineering/scda&quot;) remotes::install_github(&quot;insightsengineering/nestcolor&quot;) remotes::install_github(&quot;insightsengineering/tern&quot;, ref = &quot;v0.7.10&quot;) remotes::install_github(&quot;dmurdoch/tables&quot;) remotes::install_github(&quot;pharmaverse/tidytlg&quot;) remotes::install_github(&quot;GSK-Biostatistics/tfrmt&quot;) In each of the sections below, we will reset R to close to the present state at the start of the section, so readers can execute the demonstration code more or less independently of the other sections. This is done using the functions defined below. In your own documents, you wouldn’t need these resets. "],["tablepkgs.html", "Chapter 2 Overview table R packages 2.1 gt 2.2 r2rtf 2.3 rtables 2.4 flextable 2.5 tfrmt 2.6 tables", " Chapter 2 Overview table R packages We summarize various R packages (ordered alphabetically) to create production-ready tables in clinical research. The list is by no means complete; if you know another package that has been useful for you to create tables or listing using clinical trial data. Please contribute to this chapter. 2.1 gt The gt package (Iannone et al. 2022, website) provides a high-level and declarative interface for composing tables. Contains a variety of formatter functions for transforming cell values from an input data frame to the desired reporting values (combines mutation and aesthetic styling with options for: scientific notation, uncertainty, ranges, percentages, suffixes, localized currency, etc.). Multiple output formats are supported with the same declarative interface (e.g., HTML, LaTeX/PDF, and RTF). 2.2 r2rtf The r2rtf package (R-r2rtf?, website) creates production-ready tables and figures in RTF format. The R package is designed to provide simple “verb” functions that correspond to each component of a table, to help you translate data frame(s) to a table in RTF file. enables pipes (%&gt;%). only focus on table format. Data manipulation and analysis shall be handled by other R packages. (e.g., tidyverse) minimizes package dependency Chapter 1-9 of The R for Clinical Study Reports and Submission book provides examples by using r2rtf package. 2.3 rtables The rtables package (Becker and Waddell 2023) defines a pipe-able grammar for declaring complex table structure layouts via nested splitting - in row- and column-space - and the specification of analysis functions which will calculate cell values within that structure. These pre-data table layouts are then applied to data to build the table, during which all necessary data grouping implied by the row and column splits, cell value calculation, and tabulation occurs automatically. Additional table features such as titles, footers, and referential footnotes are supported. ASCII, HTML, and PDF are supported as output formats for rendering tables. rtables source code is on GitHub as well as the documentation. rtables is also available on CRAN. 2.4 flextable flextable (Gohel and Skintzos 2023) is providing a grammar for creating and customizing tables. The following formats are supported: ‘Word’ (.docx), ‘PowerPoint’ (.pptx), ‘PDF’ ,‘HTML’ and R ‘Grid Graphics’. The syntax is the same for the user regardless of the type of output to be produced. A set of functions allows the creation, definition of cell arrangement, addition of headers or footers, formatting and definition of cell content (i.e. text and or images). The package also offers a set of high-level functions that allow, for example, tabular reporting of statistical models and the creation of complex cross tabulations. Source code is on GitHub, a user manual is available. flextable is available on CRAN. 2.5 tfrmt The tfrmt (website) package provides a language for defining display-related metadata and table formatting before any data is available. This package offers an intuitive interface for defining and layering standard or custom formats, to which ARD (analysis results data) is supplied. It also presents the novel ability to easily generate mock displays using metadata that will be used for the actual displays. tfrmt is built on top of the gt package, which is intended to support a variety of output formats in the future. Table features (titles, header, footnotes, etc.) as well as specific formatting (e.g. rounding, scientific notation, alignment, spacing) are supported. tfrmt source code is on GitHub. tfrmt is also available on CRAN. 2.6 tables The tables package (Murdoch 2023) provides a formula-driven interface for computing the contents of tables and formatting them. It was inspired by SAS PROC TABULATE, but is not compatible with it. The user computes a table object by specifying a formula, with the left-hand side giving the rows, and the right-hand side giving the columns; the formula describes the summary functions to apply and how to organize them. The objects can be subsetted or combined using matrix-like operations. Tables can be rendered in plain text, LaTeX code to appear in a PDF document, or HTML code for a web document. The package is on CRAN. Source is maintained on R-forge at https://r-forge.r-project.org/projects/tables/ and mirrored on Github at https://github.com/rforge/tables/. Vignettes in the package serve as a user manual. Browse them at https://rdrr.io/cran/tables/, or install the package, then run browseVignettes(package = \"tables\"). &lt;&lt;&lt;&lt;&lt;&lt;&lt; HEAD ## tidytlg Tidytlg provides a framework for creating tables, listings, and graphs (TLGs) using Tidyverse. It offers a suite of analysis functions to summarize descriptive statistics (univariate statistics and counts (percentages)) for table creation and a function to convert analysis results to rtf/html outputs. For graphic output, tidytlg can integrate plot objects created by ggplot2 or a png file with titles and footnotes to produce rtf/html output. tidytlg source code is on GitHub as well as the documentation. ======= origin/main References "],["formatting-and-rendering-tables.html", "Chapter 3 Formatting and Rendering Tables 3.1 Title &amp; Footnotes 3.2 Captions 3.3 Pagination 3.4 Rendering Tables", " Chapter 3 Formatting and Rendering Tables Table generation usually is a two step process Derive the cell value and tabulate them. Create the final table output, save it to a file to be shared with collaborators. Chapter Commonly Used Tables focuses with the work involved in 1, in this chapter we discuss the various aspects of creating the final outputs that is commonly stored in a file with a particular file format (pdf, txt, html, docx or rtf). 3.1 Title &amp; Footnotes Commonly rendered tables that are reported to the health authorities have titles and footnotes with information such as: what is summarized in the table database lock date patient sub-population notes by study team notes regarding statistical algorithms chosen provenance information including path to program and when the table was created Often footnotes include cell references. 3.1.1 rtables The basic_table function in rtables has the argument titles, subtitles, main_footer, prov_footer to add titles and footnotes to tables. rtables also supports referential footnotes. So for example a basic demographics table created with rtables via tern with title and footnotes would look as follows: Code resetSession() library(rtables) lyt &lt;- basic_table( title = &quot;Demographic Table - All Patients&quot;, subtitles = c(&quot;Cutoff Date: June 01, 2022&quot;, &quot;Arm B received a placebo.&quot;), main_footer = c(&quot;Missing data is omitted.&quot;) ) |&gt; split_cols_by(&quot;ARM&quot;) |&gt; analyze(c(&quot;AGE&quot;, &quot;SEX&quot;)) build_table(lyt, adsl) Demographic Table - All Patients Cutoff Date: June 01, 2022 Arm B received a placebo. ———————————————————————————————————————————————— A: Drug X B: Placebo C: Combination ———————————————————————————————————————————————— AGE Mean 33.77 35.43 35.43 SEX F 79 82 70 M 55 52 62 ———————————————————————————————————————————————— Missing data is omitted. 3.1.2 flextable Titles and notes can be added and formatted with the ‘flextable’ package. It is possible to add them in the header and in the footer. Several methods are possible but for most needs, the add_header_lines() and add_footer_lines() functions will be the easiest to use. Let’s create first a flextable from an aggregation that will be used to illustrate the features. Code resetSession() library(flextable) library(dplyr) z &lt;- adsl |&gt; group_by(ARM, SEX) |&gt; summarise(avg = mean(AGE), sd = sd(AGE)) |&gt; tabulator(rows = &quot;SEX&quot;, columns = &quot;ARM&quot;, Y = as_paragraph(avg, &quot; (&quot;, sd, &quot;)&quot;)) |&gt; as_flextable() z .cl-de6fd90c{}.cl-de65723c{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-de6a20de{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-de6a20f2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-de6a20f3{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-de6a20fc{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-de6a20fd{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-de6a20fe{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-de6a3ff6{width:0.562in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-de6a4000{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-de6a400a{width:1.015in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-de6a4014{width:1.065in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-de6a4015{width:1.442in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-de6a401e{width:0.562in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-de6a401f{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-de6a4020{width:1.015in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-de6a4028{width:1.065in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-de6a4029{width:1.442in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-de6a402a{width:0.562in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-de6a4032{width:1.015in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-de6a4033{width:1.065in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-de6a403c{width:1.442in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}SEXA: Drug XB: PlaceboC: CombinationF32.8 (6.1)34.2 (7.0)35.2 (7.4)M35.2 (7.0)37.3 (8.9)35.7 (8.2) The following shows how to add titles or notes: Code z |&gt; add_header_lines(&quot;hello world&quot;) |&gt; add_footer_lines(&quot;bye bye world&quot;) .cl-df382984{}.cl-df2e4f72{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-df32996a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-df32997e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-df32997f{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-df329988{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-df329992{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-df329993{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-df329994{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-df32b666{width:0.562in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df32b670{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df32b67a{width:1.015in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df32b67b{width:1.065in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df32b684{width:1.442in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df32b685{width:0.562in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df32b68e{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df32b68f{width:1.015in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df32b690{width:1.065in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df32b698{width:1.442in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df32b699{width:0.562in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df32b6a2{width:1.015in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df32b6a3{width:1.065in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df32b6ac{width:1.442in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df32b6b6{width:0.562in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df32b6b7{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df32b6b8{width:1.015in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df32b6c0{width:1.065in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-df32b6c1{width:1.442in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}hello worldSEXA: Drug XB: PlaceboC: CombinationF32.8 (6.1)34.2 (7.0)35.2 (7.4)M35.2 (7.0)37.3 (8.9)35.7 (8.2)bye bye world For Word output, users can prepend a table number that will auto-incremente. Code docx_file &lt;- &quot;reports/flextable-title-01.docx&quot; ft &lt;- add_header_lines(z, &quot;hello world&quot;) |&gt; prepend_chunks( i = 1, j = 1, part = &quot;header&quot;, as_chunk(&quot;Table &quot;), as_word_field(&quot;SEQ tab \\u005C* Arabic&quot;), as_chunk(&quot;: &quot;)) |&gt; add_footer_lines(&quot;bye bye world&quot;) |&gt; theme_vanilla() save_as_docx(ft, ft, path = docx_file) reports/flextable-title-01.docx Footnotes are also available in ‘flextable’ with function footnote(). The function lets users add footnotes and references to it on the table. Code footnote(z, i = c(1, 2, 2), j = c(1, 5, 7), value = as_paragraph(&quot;hello world&quot;), ref_symbols = &quot;(1)&quot;) .cl-dfdca4d2{}.cl-dfd1cfb2{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-dfd1cfc6{font-family:'DejaVu Sans';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-dfd6a992{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dfd6a9a6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-dfd6a9a7{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dfd6a9ba{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dfd6a9bb{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-dfd6a9c4{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dfd6a9ce{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-dfd6cb66{width:0.562in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dfd6cb70{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dfd6cb7a{width:1.015in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dfd6cb84{width:1.065in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dfd6cb85{width:1.442in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dfd6cb8e{width:0.562in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dfd6cb98{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dfd6cb99{width:1.015in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dfd6cba2{width:1.065in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dfd6cba3{width:1.442in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dfd6cbac{width:0.562in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dfd6cbad{width:1.015in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dfd6cbb6{width:1.065in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dfd6cbb7{width:1.442in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dfd6cbc0{width:0.562in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dfd6cbca{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dfd6cbcb{width:1.015in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dfd6cbd4{width:1.065in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-dfd6cbd5{width:1.442in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}SEXA: Drug XB: PlaceboC: CombinationF(1)32.8 (6.1)34.2 (7.0)35.2 (7.4)M35.2 (7.0)37.3 (8.9)(1)35.7 (8.2)(1)(1)hello world 3.1.3 tables The tables package concentrates on the table itself. The titles are generally written as part of the surrounding document. Footnotes would be added after constructing the table by modifying individual entries. Alternatively for HTML output, only the footnote markers need to be added by modifying entries, and then the footnotes can be applied by using toHTML(tab, options = list(doFooter = TRUE, HTMLfooter = HTMLfootnotes(...)). Code resetSession() adsl &lt;- cadsl library(tables) table_options(doCSS = TRUE) sd_in_parens &lt;- function(x) sprintf(&quot;(%.1f)&quot;, sd(x)) tab &lt;- tabular(SEX ~ Heading()*ARM* Heading()*AGE* Heading()*(mean + sd_in_parens), data = adsl) rowLabels(tab)[1,1] &lt;- paste(rowLabels(tab)[1,1], &quot;&lt;sup&gt;a&lt;/sup&gt;&quot;) tab[2,2] &lt;- sprintf(&quot;%s%s&quot;, tab[2,2], &quot;&lt;sup&gt;b&lt;/sup&gt;&quot;) tab[2,3] &lt;- sprintf(&quot;%.2f%s&quot;, tab[2,3], &quot;&lt;sup&gt;b&lt;/sup&gt;&quot;) footnotes &lt;- HTMLfootnotes(tab, a = &quot;This is a label footnote.&quot;, b = &quot;These are cell footnotes.&quot;) toHTML(tab, options = list(HTMLfooter = footnotes, doFooter = TRUE)) .Rtable thead, .Rtable .even { background-color: inherit; } .left { text-align:left; } .center { text-align:center; } .right { text-align:right; } .Rtable, .Rtable thead { border-collapse: collapse; border-style: solid; border-width: medium 0; border-color: inherit; } .Rtable th, .Rtable td { padding-left: 0.5em; padding-right: 0.5em; border-width: 0; } SEX A: Drug X B: Placebo C: Combination aThis is a label footnote. bThese are cell footnotes. F a 32.76 (6.1) 34.24 (7.0) 35.20 (7.4) M 35.22 (7.0)b 37.31b (8.9) 35.69 (8.2) 3.2 Captions A caption is a single paragraph of text describing the table it is associated to. Captions are often used because they allow you to cross-reference tables or list them in a ‘list of tables’ with the corresponding page numbers. 3.2.1 flextable The set_caption() function in ‘flextable’ is the recommanded way to add captions. Code resetSession() library(flextable) flextable(head(cars)) |&gt; set_caption( caption = &quot;a caption&quot;, autonum = officer::run_autonum(seq_id = &quot;tab&quot;, bkm = &quot;flextable-label&quot;)) .cl-e0248572{}.cl-e017a938{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e01c8fac{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-e01cc008{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e01cc01c{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e01cc08a{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;} Table 3.1: a caption speeddist4241074722816910 In bookdown, use the syntax \\@ref(tab:flextable-label) to create a linked reference to the table. See an example of a reference: 3.1. With ‘Quarto’, the R chunk code should be transformed as: Code #| label: tbl-flextable-label #| tbl-cap: a caption flextable(head(cars)) 3.2.2 tables As with titles, captions would be added as part of the surrounding document rather than part of the table object. 3.3 Pagination Historically tables have been printed to paper for submissions. Hence large tables that would not fit onto a single printed page (e.g. letter &amp; portrait) would have to be split into multiple tables that can be printed to the preferred page size. This process of splitting the table is called pagination of tables. Pagination is a complex task as it requires to repeat information so that the tables on each page are correct tables with all relevant information for context. 3.3.1 rtables In rtables pagination can be done with the paginate_table function which has a number of arguments to split the table, see the example documentation. 3.3.2 flextable In ‘flextable’, there is no concept of pagination. The recommended method is to create a flextable for each modality of a group and to separate them with a page break; from R, this implies looping over a set of modalities with a for statement or a call to the lapply() function. Note this concept of page break is only valid for paginated documents, i.e. Word, PDF, eventually HTML with paged.js formats. In an ‘R Markdown’ document, the markdown code to insert a page break is \\newpage; with the package ‘officer’, you have to use body_add_break() (for Word documents only). 3.3.3 tables Tables that span multiple pages are supported in PDF output using the LaTeX longtable package, specified when converting to LaTeX. 3.4 Rendering Tables The choice of file format is often dictated by your company’s processes to include the tables in a report. 3.4.1 ASCII 3.4.2 PDF 3.4.3 HTML 3.4.4 WORD 3.4.5 RTF "],["commontables.html", "Chapter 4 Commonly Used Tables 4.1 Demographic Tables 4.2 Adverse Event Tables 4.3 Laboratory Tables 4.4 Time to Event Analysis Tables 4.5 Concomitant Medications 4.6 Disposition", " Chapter 4 Commonly Used Tables 4.1 Demographic Tables 4.1.1 rtables Using rtables only: Code resetSession() library(rtables) a_demo_num &lt;- function(x) { in_rows(n = length(x), &quot;Mean (SD)&quot; = rcell(c(mean(x, na.rm = TRUE), sd(x, na.rm=TRUE)), format = &quot;xx.x (xx.x)&quot;), &quot;Median&quot; = median(x,na.rm = TRUE), &quot;Min - Max&quot; = rcell(range(x, na.rm = TRUE), format = &quot;xx.x - xx.x&quot;)) } a_demo_fac &lt;- function(x) { in_rows(.list = c(c(n = length(x)), table(x))) } lyt &lt;- basic_table(title = &quot;x.x: Study Subject Data&quot;, subtitles= c(&quot;x.x.x: Demographic Characteristics&quot;, &quot;Table x.x.x.x: Demographic Characteristics - Full Analysis Set&quot;), prov_footer = &quot;Source: ADSL DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY&quot;) |&gt; split_cols_by(&quot;ARM&quot;) |&gt; analyze(c(&quot;AGE&quot;, &quot;SEX&quot;, &quot;COUNTRY&quot;), afun = list(AGE = a_demo_num, SEX = a_demo_fac, COUNTRY = a_demo_fac)) build_table(lyt, ex_adsl) x.x: Study Subject Data x.x.x: Demographic Characteristics Table x.x.x.x: Demographic Characteristics - Full Analysis Set ——————————————————————————————————————————————————————————————— A: Drug X B: Placebo C: Combination ——————————————————————————————————————————————————————————————— AGE n 134 134 132 Mean (SD) 33.8 (6.6) 35.4 (7.9) 35.4 (7.7) Median 33 35 35 Min - Max 21.0 - 50.0 21.0 - 62.0 20.0 - 69.0 SEX n 134 134 132 F 79 77 66 M 51 55 60 U 3 2 4 UNDIFFERENTIATED 1 0 2 COUNTRY n 134 134 132 CHN 74 81 64 USA 10 13 17 BRA 13 7 10 PAK 12 9 10 NGA 8 7 11 RUS 5 8 6 JPN 5 4 9 GBR 4 3 2 CAN 3 2 3 CHE 0 0 0 ——————————————————————————————————————————————————————————————— Source: ADSL DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY Using rtables and tern Code library(tern) lyt &lt;- basic_table(title = &quot;x.x: Study Subject Data&quot;, subtitles= c(&quot;x.x.x: Demographic Characteristics&quot;, &quot;Table x.x.x.x: Demographic Characteristics - Full Analysis Set&quot;), prov_footer = &quot;Source: ADSL DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY&quot;) |&gt; split_cols_by(&quot;ARM&quot;) |&gt; summarize_vars(c(&quot;AGE&quot;, &quot;SEX&quot;, &quot;COUNTRY&quot;)) build_table(lyt, ex_adsl) x.x: Study Subject Data x.x.x: Demographic Characteristics Table x.x.x.x: Demographic Characteristics - Full Analysis Set ——————————————————————————————————————————————————————————————— A: Drug X B: Placebo C: Combination ——————————————————————————————————————————————————————————————— AGE n 134 134 132 Mean (SD) 33.8 (6.6) 35.4 (7.9) 35.4 (7.7) Median 33.0 35.0 35.0 Min - Max 21.0 - 50.0 21.0 - 62.0 20.0 - 69.0 SEX n 134 134 132 F 79 (59%) 77 (57.5%) 66 (50%) M 51 (38.1%) 55 (41%) 60 (45.5%) U 3 (2.2%) 2 (1.5%) 4 (3%) UNDIFFERENTIATED 1 (0.7%) 0 2 (1.5%) COUNTRY n 134 134 132 CHN 74 (55.2%) 81 (60.4%) 64 (48.5%) USA 10 (7.5%) 13 (9.7%) 17 (12.9%) BRA 13 (9.7%) 7 (5.2%) 10 (7.6%) PAK 12 (9%) 9 (6.7%) 10 (7.6%) NGA 8 (6%) 7 (5.2%) 11 (8.3%) RUS 5 (3.7%) 8 (6%) 6 (4.5%) JPN 5 (3.7%) 4 (3%) 9 (6.8%) GBR 4 (3%) 3 (2.2%) 2 (1.5%) CAN 3 (2.2%) 2 (1.5%) 3 (2.3%) CHE 0 0 0 ——————————————————————————————————————————————————————————————— Source: ADSL DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY 4.1.2 gt Code resetSession() library(gt) library(tidyverse) # We will use ex_adsl but will assign a unit to the Age column ex_adsl &lt;- formatters::ex_adsl gt_adsl &lt;- ex_adsl attr(gt_adsl$AGE, &quot;units&quot;) &lt;- &quot;Years&quot; # This is a customized summary function # It creates numeric and categorical summaries for specified variables, following the rtables exmaple custom_summary &lt;- function(df, group_var, sum_var){ group_var &lt;- rlang::ensym(group_var) sum_var &lt;- rlang::ensym(sum_var) is_categorical &lt;- is.character(eval(expr(`$`(df, !!sum_var)))) | is.factor(eval(expr(`$`(df, !!sum_var)))) if (is_categorical){ df &lt;- df |&gt; dplyr::group_by(!!group_var) |&gt; dplyr::mutate(N = n()) |&gt; dplyr::ungroup() |&gt; dplyr::group_by(!!group_var, !!sum_var) |&gt; dplyr::summarize( val = n(), sd = 100*n()/mean(N), .groups = &quot;drop&quot; ) |&gt; tidyr::pivot_wider(id_cols = !!sum_var, names_from = !!group_var, values_from = c(val, sd)) |&gt; dplyr::rename(label = !!sum_var) |&gt; dplyr::mutate(isnum = FALSE, across(where(is.numeric), ~ifelse(is.na(.), 0, .))) sum_unit &lt;- &quot;, n (%)&quot; } else { sum_unit &lt;- sprintf(&quot; (%s)&quot;, attr(eval(expr(`$`(df, !!sum_var))), &quot;units&quot;)) df &lt;- df |&gt; dplyr::group_by(!!group_var) |&gt; dplyr::summarize( n = sum(!is.na(!!sum_var)), mean = mean(!!sum_var, na.rm = TRUE), sd = sd(!!sum_var, na.rm = TRUE), median = median(!!sum_var, na.rm = TRUE), min = min(!!sum_var, na.rm = TRUE), max = max(!!sum_var, na.rm = TRUE), min_max = NA, .groups = &quot;drop&quot; ) |&gt; tidyr::pivot_longer(cols = c(n, mean, median, min_max), names_to = &quot;label&quot;, values_to = &quot;val&quot;) |&gt; dplyr::mutate(sd = ifelse(label == &quot;mean&quot;, sd, NA), max = ifelse(label == &quot;min_max&quot;, max, NA), min = ifelse(label == &quot;min_max&quot;, min, NA), label = dplyr::recode(label, &quot;mean&quot; = &quot;Mean (SD)&quot;, &quot;min_max&quot; = &quot;Min - Max&quot;, &quot;median&quot; = &quot;Median&quot;)) |&gt; tidyr::pivot_wider(id_cols = label, names_from = !!group_var, values_from = c(val, sd, min, max)) |&gt; dplyr::mutate(isnum = TRUE) } df |&gt; dplyr::mutate(category = paste0(stringr::str_to_title(deparse(substitute(!!sum_var))), sum_unit)) } # Perform aggregation for variables Age, Sex and Country adsl_summary &lt;- purrr::map_df(.x = vars(AGE, SEX, COUNTRY), .f = ~custom_summary(df = gt_adsl, group_var = ARM, sum_var = !!.x)) # Count number of patients per Arm total_n_arm &lt;- ex_adsl |&gt; dplyr::group_by(ARM) |&gt; dplyr::summarise(N = n(), .groups = &quot;drop&quot;) # gt gt(adsl_summary, rowname_col = &quot;label&quot;, groupname_col = &quot;category&quot;) |&gt; tab_header( title = &quot;x.x: Study Subject Data&quot;, subtitle = md(&quot;x.x.x: Demographic Characteristics \\n Table x.x.x.x: Demographic Characteristics - Full Analysis Set&quot;), preheader = c(&quot;Protocol: XXXXX&quot;, &quot;Cutoff date: DDMMYYYY&quot;) ) |&gt; tab_source_note(&quot;Source: ADSL DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY&quot;) |&gt; opt_align_table_header(align = &quot;left&quot;) |&gt; fmt_integer(columns = starts_with(c(&quot;val&quot;, &quot;min&quot;, &quot;max&quot;)), rows = label != &quot;Mean (SD)&quot;) |&gt; fmt_number(columns = starts_with(c(&quot;val&quot;, &quot;sd&quot;)), rows = label == &quot;Mean (SD)&quot;, decimals = 1) |&gt; fmt_number(columns = starts_with(&quot;sd&quot;), rows = isnum == FALSE, decimals = 1) |&gt; sub_missing(missing_text = &quot;&quot;) |&gt; summary_rows( groups = c(&quot;Sex, n (%)&quot;, &quot;Country, n (%)&quot;), columns = starts_with(&quot;val&quot;), fns = list(n = ~sum(.)), missing_text = &quot;&quot;, formatter = fmt_integer #, # side = &quot;top&quot; ) |&gt; cols_merge_n_pct(col_n = &quot;val_A: Drug X&quot;, col_pct = &quot;sd_A: Drug X&quot;) |&gt; cols_merge_n_pct(col_n = &quot;val_B: Placebo&quot;, col_pct = &quot;sd_B: Placebo&quot;) |&gt; cols_merge_n_pct(col_n = &quot;val_C: Combination&quot;, col_pct = &quot;sd_C: Combination&quot;) |&gt; cols_merge_range(col_begin = &quot;min_A: Drug X&quot;, col_end = &quot;max_A: Drug X&quot;, sep = &quot; - &quot;) |&gt; cols_merge_range(col_begin = &quot;min_B: Placebo&quot;, col_end = &quot;max_B: Placebo&quot;, sep = &quot; - &quot;) |&gt; cols_merge_range(col_begin = &quot;min_C: Combination&quot;, col_end = &quot;max_C: Combination&quot;, sep = &quot; - &quot;) |&gt; cols_merge(columns = c(&quot;val_A: Drug X&quot;, &quot;min_A: Drug X&quot;), pattern = &quot;{1}{2}&quot;) |&gt; cols_merge(columns = c(&quot;val_B: Placebo&quot;, &quot;min_B: Placebo&quot;), pattern = &quot;{1}{2}&quot;) |&gt; cols_merge(columns = c(&quot;val_C: Combination&quot;, &quot;min_C: Combination&quot;), pattern = &quot;{1}{2}&quot;) |&gt; cols_hide(columns = isnum) |&gt; cols_align(align = c(&quot;center&quot;), columns = c(&quot;val_A: Drug X&quot;, &quot;val_B: Placebo&quot;, &quot;val_C: Combination&quot;)) |&gt; cols_align(align = &quot;center&quot;, columns = 1) |&gt; cols_label(&quot;val_A: Drug X&quot; = md(sprintf(&quot;A: Drug X \\n N=%i (100%%)&quot;, total_n_arm$N[1])), &quot;val_B: Placebo&quot; = md(sprintf(&quot;B: Placebo \\n N=%i (100%%)&quot;, total_n_arm$N[2])), &quot;val_C: Combination&quot; = md(sprintf(&quot;C: Combination \\n N=%i (100%%)&quot;, total_n_arm$N[3]))) |&gt; tab_options( table.font.size = 9, page.orientation = &quot;landscape&quot;, page.numbering = TRUE, page.header.use_tbl_headings = TRUE, page.footer.use_tbl_notes = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #cuisyllkbt .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 9px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #cuisyllkbt .gt_heading { background-color: #FFFFFF; text-align: left; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #cuisyllkbt .gt_caption { padding-top: 4px; padding-bottom: 4px; } #cuisyllkbt .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #cuisyllkbt .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #cuisyllkbt .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #cuisyllkbt .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #cuisyllkbt .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #cuisyllkbt .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #cuisyllkbt .gt_column_spanner_outer:first-child { padding-left: 0; } #cuisyllkbt .gt_column_spanner_outer:last-child { padding-right: 0; } #cuisyllkbt .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #cuisyllkbt .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #cuisyllkbt .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #cuisyllkbt .gt_from_md > :first-child { margin-top: 0; } #cuisyllkbt .gt_from_md > :last-child { margin-bottom: 0; } #cuisyllkbt .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #cuisyllkbt .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; } #cuisyllkbt .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; } #cuisyllkbt .gt_row_group_first td { border-top-width: 2px; } #cuisyllkbt .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #cuisyllkbt .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #cuisyllkbt .gt_first_summary_row.thick { border-top-width: 2px; } #cuisyllkbt .gt_last_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #cuisyllkbt .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #cuisyllkbt .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #cuisyllkbt .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #cuisyllkbt .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #cuisyllkbt .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #cuisyllkbt .gt_footnote { margin: 0px; font-size: 90%; padding-left: 4px; padding-right: 4px; padding-left: 5px; padding-right: 5px; } #cuisyllkbt .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #cuisyllkbt .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #cuisyllkbt .gt_left { text-align: left; } #cuisyllkbt .gt_center { text-align: center; } #cuisyllkbt .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #cuisyllkbt .gt_font_normal { font-weight: normal; } #cuisyllkbt .gt_font_bold { font-weight: bold; } #cuisyllkbt .gt_font_italic { font-style: italic; } #cuisyllkbt .gt_super { font-size: 65%; } #cuisyllkbt .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 75%; vertical-align: 0.4em; } #cuisyllkbt .gt_asterisk { font-size: 100%; vertical-align: 0; } #cuisyllkbt .gt_indent_1 { text-indent: 5px; } #cuisyllkbt .gt_indent_2 { text-indent: 10px; } #cuisyllkbt .gt_indent_3 { text-indent: 15px; } #cuisyllkbt .gt_indent_4 { text-indent: 20px; } #cuisyllkbt .gt_indent_5 { text-indent: 25px; } x.x: Study Subject Data x.x.x: Demographic Characteristics Table x.x.x.x: Demographic Characteristics - Full Analysis Set A: Drug X N=134 (100%) B: Placebo N=134 (100%) C: Combination N=132 (100%) Age (Years) n 134 134 132 Mean (SD) 33.8 (6.6) 35.4 (7.9) 35.4 (7.7) Median 33 35 35 Min - Max 21 - 50 21 - 62 20 - 69 Sex, n (%) F 79 (59.0) 77 (57.5) 66 (50.0) M 51 (38.1) 55 (41.0) 60 (45.5) U 3 (2.2) 2 (1.5) 4 (3.0) UNDIFFERENTIATED 1 (0.7) 0 2 (1.5) n 134 134 132 Country, n (%) CHN 74 (55.2) 81 (60.4) 64 (48.5) USA 10 (7.5) 13 (9.7) 17 (12.9) BRA 13 (9.7) 7 (5.2) 10 (7.6) PAK 12 (9.0) 9 (6.7) 10 (7.6) NGA 8 (6.0) 7 (5.2) 11 (8.3) RUS 5 (3.7) 8 (6.0) 6 (4.5) JPN 5 (3.7) 4 (3.0) 9 (6.8) GBR 4 (3.0) 3 (2.2) 2 (1.5) CAN 3 (2.2) 2 (1.5) 3 (2.3) n 134 134 132 Source: ADSL DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY 4.1.3 flextable Code # The two steps in creating &#39;Demographic Tables&#39; are: # # - summarize the information with the `flextable::summarizor()` function. # It computes a set of statistics for each variable by groups. It returns # a data.frame ready to be used by `flextable::as_flextable()`. # - Create the flextable with the `as_flextable()` function. resetSession() ex_adsl &lt;- formatters::ex_adsl library(flextable) library(tidyverse) library(officer) set_flextable_defaults( border.color = &quot;#AAAAAA&quot;, font.family = &quot;Open Sans&quot;, font.size = 10, padding = 3, line_spacing = 1.4 ) # data adsl &lt;- select(ex_adsl, AGE, SEX, COUNTRY, ARM) # In the illustration, we use labels from the column attributes. col_labels &lt;- map_chr(adsl, function(x) attr(x, &quot;label&quot;)) # Now let&#39;s use the labels and customize the ‘flextable’ output. ft &lt;- summarizor(adsl, by = &quot;ARM&quot;) |&gt; as_flextable(sep_w = 0, separate_with = &quot;variable&quot;, spread_first_col = TRUE) |&gt; align(i = ~ !is.na(variable), align = &quot;left&quot;) |&gt; prepend_chunks(i = ~ is.na(variable), j =&quot;stat&quot;, as_chunk(&quot;\\t&quot;) ) |&gt; labelizor(j = c(&quot;stat&quot;), labels = col_labels, part = &quot;all&quot;) |&gt; autofit() |&gt; add_header_lines( c(&quot;x.x: Study Subject Data&quot;, &quot;x.x.x: Demographic Characteristics&quot;, &quot;Table x.x.x.x: Demographic Characteristics - Full Analysis Set&quot;)) |&gt; add_footer_lines(&quot;Source: ADSL DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY&quot;) ft .cl-e383dd62{}.cl-e3786e3c{font-family:'Open Sans';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e37d43da{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-e37d43e4{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-e37d43ee{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-e37d43ef{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-e37d43f0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-e37d6b30{width:2.016in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6b44{width:0.957in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6b4e{width:1.206in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6b4f{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6b58{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6b62{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6b63{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6b6c{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6b6d{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6b76{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6b77{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6b80{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6b81{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6b8a{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6b8b{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6b94{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 0.75pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6b9e{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0.75pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6b9f{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0.75pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6ba0{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6ba8{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6ba9{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6bb2{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6bbc{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6bbd{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6bbe{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6bc6{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6bc7{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6bd0{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6bda{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6bdb{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6be4{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6be5{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6bee{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6bf8{width:2.016in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6bf9{width:0.957in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e37d6c02{width:1.206in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}x.x: Study Subject Datax.x.x: Demographic CharacteristicsTable x.x.x.x: Demographic Characteristics - Full Analysis SetA: Drug X(N=134)B: Placebo(N=134)C: Combination(N=132)Age&emsp;Mean (SD)33.8 (6.6)35.4 (7.9)35.4 (7.7)&emsp;Median (IQR)33.0 (11.0)35.0 (10.0)35.0 (10.0)&emsp;Range21.0 - 50.021.0 - 62.020.0 - 69.0&emsp;Missing0 (0.00%)0 (0.00%)0 (0.00%)Sex&emsp;F79 (58.96%)77 (57.46%)66 (50.00%)&emsp;M51 (38.06%)55 (41.04%)60 (45.45%)&emsp;U3 (2.24%)2 (1.49%)4 (3.03%)&emsp;UNDIFFERENTIATED1 (0.75%)0 (0.00%)2 (1.52%)&emsp;Missing0 (0.00%)0 (0.00%)0 (0.00%)Country&emsp;CHN74 (55.22%)81 (60.45%)64 (48.48%)&emsp;USA10 (7.46%)13 (9.70%)17 (12.88%)&emsp;BRA13 (9.70%)7 (5.22%)10 (7.58%)&emsp;PAK12 (8.96%)9 (6.72%)10 (7.58%)&emsp;NGA8 (5.97%)7 (5.22%)11 (8.33%)&emsp;RUS5 (3.73%)8 (5.97%)6 (4.55%)&emsp;JPN5 (3.73%)4 (2.99%)9 (6.82%)&emsp;GBR4 (2.99%)3 (2.24%)2 (1.52%)&emsp;CAN3 (2.24%)2 (1.49%)3 (2.27%)&emsp;CHE0 (0.00%)0 (0.00%)0 (0.00%)&emsp;Missing0 (0.00%)0 (0.00%)0 (0.00%)Source: ADSL DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY 4.1.4 tables The tables package uses a different style than the other packages for tables such as this, where there are separate sections for age, sex and country breakdowns of the data. Rather than putting the section heading on a separate line, it normally puts the heading in a separate column to the left of the other columns. Code resetSession() ex_adsl &lt;- formatters::ex_adsl library(tables) table_options(doCSS = TRUE) meansd &lt;- function(x) sprintf(&quot;%.1f (%.1f)&quot;, mean(x), sd(x)) iqr &lt;- function(x) quantile(x, 0.75) - quantile(x, 0.25) medianiqr &lt;- function(x) sprintf(&quot;%.1f (%.1f)&quot;, median(x), iqr(x)) minmax &lt;- function(x) sprintf(&quot;%.1f - %.1f&quot;, min(x), max(x)) countpercent &lt;- function(num, denom) sprintf(&quot;%d (%.1f%%)&quot;, length(num), 100*length(num)/length(denom)) count &lt;- function(x) sprintf(&quot;(N=%d)&quot;, length(x)) tab &lt;- tabular( Heading()*1*Heading()*count + Heading(&quot;Age (Years)&quot;)* AGE * (Heading(&quot;Mean (SD)&quot;)*meansd + Heading(&quot;Median (IQR)&quot;)*medianiqr + Heading(&quot;Min - Max&quot;)*minmax) + (Heading(&quot;Sex, n, (%)&quot;)*SEX + Heading(&quot;Country, n, (%)&quot;)*COUNTRY)* Heading()*Percent(denom = Equal(ARM), fn = countpercent) ~ Heading()*ARM, data = ex_adsl ) Warning in cbind(padNA, leftjustification): number of rows of result is not a multiple of vector length (arg 1) Code useGroupLabels(tab, indent = &quot;&amp;emsp;&quot;) #table3ebb7d5a9f43 .Rtable thead, .Rtable .even { background-color: inherit; } #table3ebb7d5a9f43 .left { text-align:left; } #table3ebb7d5a9f43 .center { text-align:center; } #table3ebb7d5a9f43 .right { text-align:right; } #table3ebb7d5a9f43 .Rtable, #table3ebb7d5a9f43 .Rtable thead { border-collapse: collapse; border-style: solid; border-width: medium 0; border-color: inherit; } #table3ebb7d5a9f43 .Rtable th, #table3ebb7d5a9f43 .Rtable td { padding-left: 0.5em; padding-right: 0.5em; border-width: 0; } A: Drug X B: Placebo C: Combination   (N=134) (N=134) (N=132) Age (Years)        Mean (SD) 33.8 (6.6) 35.4 (7.9) 35.4 (7.7)  Median (IQR) 33.0 (11.0) 35.0 (10.0) 35.0 (10.0)  Min - Max 21.0 - 50.0 21.0 - 62.0 20.0 - 69.0 Sex, n, (%)        F 79 (59.0%) 77 (57.5%) 66 (50.0%)  M 51 (38.1%) 55 (41.0%) 60 (45.5%)  U 3 (2.2%) 2 (1.5%) 4 (3.0%)  UNDIFFERENTIATED 1 (0.7%) 0 (0.0%) 2 (1.5%) Country, n, (%)        CHN 74 (55.2%) 81 (60.4%) 64 (48.5%)  USA 10 (7.5%) 13 (9.7%) 17 (12.9%)  BRA 13 (9.7%) 7 (5.2%) 10 (7.6%)  PAK 12 (9.0%) 9 (6.7%) 10 (7.6%)  NGA 8 (6.0%) 7 (5.2%) 11 (8.3%)  RUS 5 (3.7%) 8 (6.0%) 6 (4.5%)  JPN 5 (3.7%) 4 (3.0%) 9 (6.8%)  GBR 4 (3.0%) 3 (2.2%) 2 (1.5%)  CAN 3 (2.2%) 2 (1.5%) 3 (2.3%)  CHE 0 (0.0%) 0 (0.0%) 0 (0.0%) 4.1.5 tidytlg Code resetSession() library(dplyr) library(tidytlg) adsl &lt;- formatters::ex_adsl # create univariate stats for age tbl1 &lt;- univar(adsl, rowvar = &quot;AGE&quot;, colvar = &quot;ARM&quot;, statlist = statlist(c(&quot;N&quot;,&quot;MEANSD&quot;,&quot;MEDIAN&quot;,&quot;RANGE&quot;)), row_header = &quot;Age (years)&quot;, decimal = 0) # create counts (percentages) for gender categories tbl2 &lt;- freq(adsl, rowvar = &quot;SEX&quot;, colvar = &quot;ARM&quot;, statlist = statlist(c(&quot;N&quot;, &quot;n (x.x%)&quot;)), row_header = &quot;Gender, n(%)&quot;) # create counts (percentages) for country tbl3 &lt;- freq(adsl, rowvar = &quot;COUNTRY&quot;, colvar = &quot;ARM&quot;, statlist = statlist(c(&quot;N&quot;, &quot;n (x.x%)&quot;)), row_header = &quot;Country, n(%)&quot;, descending_by = &quot;C: Combination&quot;) # combine analysis results together tbl &lt;- bind_table(tbl1, tbl2, tbl3) # output the analysis results gentlg(huxme = tbl, format = &quot;HTML&quot;, print.hux = FALSE, file = &quot;Table x.x.x.x&quot;, orientation = &quot;portrait&quot;, title = &quot;Demographic Characteristics - Full Analysis Set&quot;, footers = &quot;Source: ADSL DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY&quot;, colheader = c(&quot;&quot;,&quot;A: Drug X&quot;,&quot;B: Placebo&quot;,&quot;C: Combination&quot;)) Table 4.1: Table x.x.x.x: &emsp; Demographic Characteristics - Full Analysis Set A: Drug X B: Placebo C: Combination Age (years) N134134132 Mean (SD)33.8 (6.55)35.4 (7.90)35.4 (7.72) Median33.035.035.0 Range(21; 50)(21; 62)(20; 69) Gender, n(%) N134134132 F79 (59.0%)77 (57.5%)66 (50.0%) M51 (38.1%)55 (41.0%)60 (45.5%) U3 (2.2%)2 (1.5%)4 (3.0%) UNDIFFERENTIATED1 (0.7%)02 (1.5%) Country, n(%) N134134132 CHN74 (55.2%)81 (60.4%)64 (48.5%) USA10 (7.5%)13 (9.7%)17 (12.9%) NGA8 (6.0%)7 (5.2%)11 (8.3%) BRA13 (9.7%)7 (5.2%)10 (7.6%) PAK12 (9.0%)9 (6.7%)10 (7.6%) JPN5 (3.7%)4 (3.0%)9 (6.8%) RUS5 (3.7%)8 (6.0%)6 (4.5%) CAN3 (2.2%)2 (1.5%)3 (2.3%) GBR4 (3.0%)3 (2.2%)2 (1.5%) CHE000 Source: ADSL DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY [table x.x.x.x.html][/home/runner/work/_temp/b12862b4-488c-4339-87f9-9fc499992f88] 21MAR2023, 12:57 4.2 Adverse Event Tables We will use the ex_adae data included within the formatters package. Code head(formatters::ex_adae) # A tibble: 6 × 48 STUDYID USUBJID SUBJID SITEID AGE SEX RACE COUNTRY INVID ARM ARMCD &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;chr&gt; &lt;fct&gt; &lt;fct&gt; 1 AB12345 AB12345-BRA… id-134 BRA-1 47 M WHITE BRA BRA-1 A: D… ARM A 2 AB12345 AB12345-BRA… id-134 BRA-1 47 M WHITE BRA BRA-1 A: D… ARM A 3 AB12345 AB12345-BRA… id-134 BRA-1 47 M WHITE BRA BRA-1 A: D… ARM A 4 AB12345 AB12345-BRA… id-134 BRA-1 47 M WHITE BRA BRA-1 A: D… ARM A 5 AB12345 AB12345-BRA… id-141 BRA-1 35 F WHITE BRA BRA-1 C: C… ARM C 6 AB12345 AB12345-BRA… id-141 BRA-1 35 F WHITE BRA BRA-1 C: C… ARM C # … with 37 more variables: ACTARM &lt;fct&gt;, ACTARMCD &lt;fct&gt;, STRATA1 &lt;fct&gt;, # STRATA2 &lt;fct&gt;, BMRKR1 &lt;dbl&gt;, BMRKR2 &lt;fct&gt;, ITTFL &lt;fct&gt;, SAFFL &lt;fct&gt;, # BMEASIFL &lt;fct&gt;, BEP01FL &lt;fct&gt;, RANDDT &lt;date&gt;, TRTSDTM &lt;dttm&gt;, # TRTEDTM &lt;dttm&gt;, EOSSTT &lt;fct&gt;, EOSDT &lt;date&gt;, EOSDY &lt;int&gt;, DCSREAS &lt;fct&gt;, # DTHDT &lt;date&gt;, LSTALVDT &lt;date&gt;, study_duration_secs &lt;dbl&gt;, ASEQ &lt;int&gt;, # AESEQ &lt;int&gt;, AETERM &lt;fct&gt;, AELLT &lt;fct&gt;, AEDECOD &lt;fct&gt;, AEHLT &lt;fct&gt;, # AEHLGT &lt;fct&gt;, AEBODSYS &lt;fct&gt;, AESOC &lt;fct&gt;, AESEV &lt;fct&gt;, AESER &lt;fct&gt;, … 4.2.1 rtables Only Adverse Events by ID Code resetSession() library(rtables) s_events_patients &lt;- function(x, labelstr, .N_col) { in_rows( &quot;Patients with at least one event&quot; = rcell(length(unique(x)) * c(1, 1 / .N_col), format = &quot;xx (xx.xx%)&quot;), &quot;Total number of events&quot; = rcell(length(x), format = &quot;xx&quot;) ) } table_count_per_id &lt;- function(df, .N_col, termvar = &quot;AEDECOD&quot;, idvar = &quot;USUBJID&quot;) { x &lt;- df[[termvar]] id &lt;- df[[idvar]] counts &lt;- table(x[!duplicated(paste0(id, x))]) in_rows( .list = lapply(counts, function(xi) rcell(c(xi, xi/.N_col), &quot;xx (xx.xx%)&quot;)), .labels = names(counts) ) } lyt &lt;- basic_table(show_colcounts = TRUE) %&gt;% split_cols_by(&quot;ARM&quot;) %&gt;% analyze(&quot;USUBJID&quot;, afun = s_events_patients) %&gt;% split_rows_by(&quot;AEBODSYS&quot;, child_labels = &quot;visible&quot;, split_fun = trim_levels_in_group(&quot;AEDECOD&quot;), section_div = &quot; &quot;) %&gt;% summarize_row_groups(&quot;USUBJID&quot;, cfun = s_events_patients) %&gt;% analyze(&quot;AEDECOD&quot;, table_count_per_id, show_labels = &quot;hidden&quot;, indent_mod = -1) build_table(lyt, ex_adae, alt_counts_df = ex_adsl) A: Drug X B: Placebo C: Combination (N=134) (N=134) (N=132) ————————————————————————————————————————————————————————————————————————————————— Patients with at least one event 122 (91.04%) 123 (91.79%) 120 (90.91%) Total number of events 609 622 703 cl A.1 Patients with at least one event 78 (58.21%) 75 (55.97%) 89 (67.42%) Total number of events 132 130 160 dcd A.1.1.1.1 50 (37.31%) 45 (33.58%) 63 (47.73%) dcd A.1.1.1.2 48 (35.82%) 48 (35.82%) 50 (37.88%) cl B.1 Patients with at least one event 47 (35.07%) 49 (36.57%) 43 (32.58%) Total number of events 56 60 62 dcd B.1.1.1.1 47 (35.07%) 49 (36.57%) 43 (32.58%) cl B.2 Patients with at least one event 79 (58.96%) 74 (55.22%) 85 (64.39%) Total number of events 129 138 143 dcd B.2.1.2.1 49 (36.57%) 44 (32.84%) 52 (39.39%) dcd B.2.2.3.1 48 (35.82%) 54 (40.30%) 51 (38.64%) cl C.1 Patients with at least one event 43 (32.09%) 46 (34.33%) 43 (32.58%) Total number of events 55 63 64 dcd C.1.1.1.3 43 (32.09%) 46 (34.33%) 43 (32.58%) cl C.2 Patients with at least one event 35 (26.12%) 48 (35.82%) 55 (41.67%) Total number of events 48 53 65 dcd C.2.1.2.1 35 (26.12%) 48 (35.82%) 55 (41.67%) cl D.1 Patients with at least one event 79 (58.96%) 67 (50.00%) 80 (60.61%) Total number of events 127 106 135 dcd D.1.1.1.1 50 (37.31%) 42 (31.34%) 51 (38.64%) dcd D.1.1.4.2 48 (35.82%) 42 (31.34%) 50 (37.88%) cl D.2 Patients with at least one event 47 (35.07%) 58 (43.28%) 57 (43.18%) Total number of events 62 72 74 dcd D.2.1.5.3 47 (35.07%) 58 (43.28%) 57 (43.18%) 4.2.2 gt Code resetSession() library(tidyverse) library(gt) ex_adsl &lt;- formatters::ex_adsl ex_adae &lt;- formatters::ex_adae header_n &lt;- ex_adsl |&gt; dplyr::group_by(ARM) |&gt; dplyr::summarize( N = dplyr::n_distinct(USUBJID) ) col_lbls &lt;- header_n |&gt; dplyr::transmute( ARMN = sprintf(&quot;%s \\n (N=%i)&quot;, ARM, N) ) |&gt; dplyr::group_split(ARMN) summary_ex &lt;- merge(ex_adae, header_n, by = &quot;ARM&quot;) |&gt; dplyr::group_by(ARM) |&gt; dplyr::summarize( n = dplyr::n_distinct(USUBJID), n_indiv = dplyr::n(), pct_tot = n/mean(N), .groups = &quot;drop&quot; ) |&gt; dplyr::mutate(AEDECOD = &quot;Patients with at least one event&quot;) indivsummary_ex &lt;- merge(ex_adae, header_n, by = &quot;ARM&quot;) |&gt; dplyr::group_by(ARM, AEBODSYS) |&gt; dplyr::summarize( n = dplyr::n_distinct(USUBJID), pct_tot = n/mean(N), n_indiv = dplyr::n(), .groups = &quot;drop&quot; ) |&gt; dplyr::mutate(AEDECOD = &quot;Patients with at least one event&quot;) bodsys_summary &lt;- merge(ex_adae, header_n, by = &quot;ARM&quot;) |&gt; dplyr::group_by(ARM, AEBODSYS, AEDECOD) |&gt; dplyr::summarize( n = dplyr::n_distinct(USUBJID), pct_tot = n/mean(N), n_indiv = dplyr::n(), .groups = &quot;drop&quot; ) ex_tbl &lt;- dplyr::bind_rows(summary_ex, indivsummary_ex, bodsys_summary) |&gt; tidyr::pivot_wider( id_cols = c(AEBODSYS, AEDECOD), names_from = ARM, values_from = c(n, pct_tot, n_indiv) ) |&gt; dplyr::mutate( across(where(is.numeric), ~ifelse(is.na(.), 0, .)), AEBODSYS = forcats::fct_na_value_to_level(AEBODSYS, level = &quot; &quot;) ) ex_tbl |&gt; gt( rowname_col = &quot;AEDECOD&quot;, groupname_col = &quot;AEBODSYS&quot; ) |&gt; fmt_percent( columns = starts_with(&quot;pct&quot;), decimals = 1 ) |&gt; cols_merge_n_pct( col_n = &quot;n_A: Drug X&quot;, col_pct = &quot;pct_tot_A: Drug X&quot; ) |&gt; cols_merge_n_pct( col_n = &quot;n_B: Placebo&quot;, col_pct = &quot;pct_tot_B: Placebo&quot; ) |&gt; cols_merge_n_pct( col_n = &quot;n_C: Combination&quot;, col_pct = &quot;pct_tot_C: Combination&quot; ) |&gt; tab_spanner( label = md(col_lbls[[1]]), columns = c(&quot;n_A: Drug X&quot;, &quot;n_indiv_A: Drug X&quot;) ) |&gt; tab_spanner( label = md(col_lbls[[2]]), columns = c(&quot;n_B: Placebo&quot;, &quot;n_indiv_B: Placebo&quot;) ) |&gt; tab_spanner( label = md(col_lbls[[3]]), columns = c(&quot;n_C: Combination&quot;, &quot;n_indiv_C: Combination&quot;) ) |&gt; cols_label( .list = list( &quot;n_A: Drug X&quot; = md(&quot;n \\n (% of subjects)&quot;), &quot;n_indiv_A: Drug X&quot; = md(&quot;Total number \\n of events&quot;), &quot;n_B: Placebo&quot; = md(&quot;n \\n (% of subjects)&quot;), &quot;n_indiv_B: Placebo&quot; = md(&quot;Total number \\n of events&quot;), &quot;n_C: Combination&quot; = md(&quot;n \\n (% of subjects)&quot;), &quot;n_indiv_C: Combination&quot; = md(&quot;Total number \\n of events&quot;) ) ) |&gt; cols_align( columns = 3:11, align = &quot;center&quot; ) |&gt; cols_width( .list = list( 1:2 ~ px(250), 3:11 ~ px(100) ) ) |&gt; tab_stub_indent( rows = 2:18, indent = 2 ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #wmhmfnnbac .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #wmhmfnnbac .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #wmhmfnnbac .gt_caption { padding-top: 4px; padding-bottom: 4px; } #wmhmfnnbac .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #wmhmfnnbac .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #wmhmfnnbac .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #wmhmfnnbac .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #wmhmfnnbac .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #wmhmfnnbac .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #wmhmfnnbac .gt_column_spanner_outer:first-child { padding-left: 0; } #wmhmfnnbac .gt_column_spanner_outer:last-child { padding-right: 0; } #wmhmfnnbac .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #wmhmfnnbac .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #wmhmfnnbac .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #wmhmfnnbac .gt_from_md > :first-child { margin-top: 0; } #wmhmfnnbac .gt_from_md > :last-child { margin-bottom: 0; } #wmhmfnnbac .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #wmhmfnnbac .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; } #wmhmfnnbac .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; } #wmhmfnnbac .gt_row_group_first td { border-top-width: 2px; } #wmhmfnnbac .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #wmhmfnnbac .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #wmhmfnnbac .gt_first_summary_row.thick { border-top-width: 2px; } #wmhmfnnbac .gt_last_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #wmhmfnnbac .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #wmhmfnnbac .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #wmhmfnnbac .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #wmhmfnnbac .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #wmhmfnnbac .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #wmhmfnnbac .gt_footnote { margin: 0px; font-size: 90%; padding-left: 4px; padding-right: 4px; padding-left: 5px; padding-right: 5px; } #wmhmfnnbac .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #wmhmfnnbac .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #wmhmfnnbac .gt_left { text-align: left; } #wmhmfnnbac .gt_center { text-align: center; } #wmhmfnnbac .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #wmhmfnnbac .gt_font_normal { font-weight: normal; } #wmhmfnnbac .gt_font_bold { font-weight: bold; } #wmhmfnnbac .gt_font_italic { font-style: italic; } #wmhmfnnbac .gt_super { font-size: 65%; } #wmhmfnnbac .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 75%; vertical-align: 0.4em; } #wmhmfnnbac .gt_asterisk { font-size: 100%; vertical-align: 0; } #wmhmfnnbac .gt_indent_1 { text-indent: 5px; } #wmhmfnnbac .gt_indent_2 { text-indent: 10px; } #wmhmfnnbac .gt_indent_3 { text-indent: 15px; } #wmhmfnnbac .gt_indent_4 { text-indent: 20px; } #wmhmfnnbac .gt_indent_5 { text-indent: 25px; } A: Drug X (N=134) B: Placebo (N=134) C: Combination (N=132) n (% of subjects) Total number of events n (% of subjects) Total number of events n (% of subjects) Total number of events Patients with at least one event 122 (91.0%) 609 123 (91.8%) 622 120 (90.9%) 703 cl A.1 Patients with at least one event 78 (58.2%) 132 75 (56.0%) 130 89 (67.4%) 160 dcd A.1.1.1.1 50 (37.3%) 64 45 (33.6%) 62 63 (47.7%) 88 dcd A.1.1.1.2 48 (35.8%) 68 48 (35.8%) 68 50 (37.9%) 72 cl B.1 Patients with at least one event 47 (35.1%) 56 49 (36.6%) 60 43 (32.6%) 62 dcd B.1.1.1.1 47 (35.1%) 56 49 (36.6%) 60 43 (32.6%) 62 cl B.2 Patients with at least one event 79 (59.0%) 129 74 (55.2%) 138 85 (64.4%) 143 dcd B.2.1.2.1 49 (36.6%) 65 44 (32.8%) 62 52 (39.4%) 66 dcd B.2.2.3.1 48 (35.8%) 64 54 (40.3%) 76 51 (38.6%) 77 cl C.1 Patients with at least one event 43 (32.1%) 55 46 (34.3%) 63 43 (32.6%) 64 dcd C.1.1.1.3 43 (32.1%) 55 46 (34.3%) 63 43 (32.6%) 64 cl C.2 Patients with at least one event 35 (26.1%) 48 48 (35.8%) 53 55 (41.7%) 65 dcd C.2.1.2.1 35 (26.1%) 48 48 (35.8%) 53 55 (41.7%) 65 cl D.1 Patients with at least one event 79 (59.0%) 127 67 (50.0%) 106 80 (60.6%) 135 dcd D.1.1.1.1 50 (37.3%) 61 42 (31.3%) 51 51 (38.6%) 71 dcd D.1.1.4.2 48 (35.8%) 66 42 (31.3%) 55 50 (37.9%) 64 cl D.2 Patients with at least one event 47 (35.1%) 62 58 (43.3%) 72 57 (43.2%) 74 dcd D.2.1.5.3 47 (35.1%) 62 58 (43.3%) 72 57 (43.2%) 74 4.2.3 flextable Code resetSession() ex_adsl &lt;- formatters::ex_adsl ex_adae &lt;- formatters::ex_adae library(flextable) library(tidyr) library(dplyr) library(forcats) ae_tabulator &lt;- function(ADSL, ADAE){ subject_cts &lt;- group_by(ADSL, ARM) |&gt; summarise(n_subject = n()) all_event_total_cts &lt;- group_by(ADAE, ARM) |&gt; summarise(n_usub = n_distinct(USUBJID), n_events = n()) aebodsys_cts &lt;- group_by(ADAE, ARM, AEBODSYS) |&gt; summarise(n_usub = n_distinct(USUBJID), n_events = n(), .groups = &quot;drop&quot;) aedecod_cts &lt;- group_by(ADAE, ARM, AEBODSYS, AEDECOD) |&gt; summarise(n_usub = n_distinct(USUBJID), n_events = n(), .groups = &quot;drop&quot;) x &lt;- bind_rows(all_event_total_cts, aebodsys_cts, aedecod_cts) |&gt; mutate( AEBODSYS = fct_expand(AEBODSYS, &quot;ALL1&quot;) |&gt; fct_relevel(&quot;ALL1&quot;), AEDECOD = fct_expand(AEDECOD, &quot;ALL2&quot;) |&gt; fct_relevel(&quot;ALL2&quot;) ) |&gt; left_join(subject_cts, by = &quot;ARM&quot;) |&gt; replace_na(replace = list(AEBODSYS = &quot;ALL1&quot;, AEDECOD = &quot;ALL2&quot;)) |&gt; arrange(AEBODSYS, AEDECOD) |&gt; mutate(pct = n_usub / n_subject) attr(x, &quot;ARM_COUNTS&quot;) &lt;- setNames(subject_cts$n_subject, subject_cts$ARM) x } # Labels for `flextable::labelizor()`: AEDECOD_LABELS &lt;- c( ALL1 = &quot;Patients with at least one event&quot;, ALL2 = &quot;Patients with at least one event&quot;) HEADER_LABELS &lt;- c( AEDECOD = &quot;dictionary-derived term\\n\\tbody system or organ class&quot;, nevents = &quot;Total number\\nof events&quot;, n = &quot;n\\n(% of subjects)&quot;, &quot;ARM A&quot; = &quot;Treatment A&quot;, &quot;ARM B&quot; = &quot;Treatment B&quot; ) # `tabulator()` call: dat &lt;- ae_tabulator(ADSL = ex_adsl, ADAE = ex_adae) ARM_COUNTS &lt;- attr(dat, &quot;ARM_COUNTS&quot;) tab &lt;- tabulator( dat, rows = c(&quot;AEBODSYS&quot;, &quot;AEDECOD&quot;), columns = &quot;ARM&quot;, `n` = as_paragraph(fmt_n_percent(n_usub, pct)), `nevents` = as_paragraph(n_events) ) .ARM_COUNTS &lt;- ARM_COUNTS # flextable creation: ft &lt;- as_flextable(tab, spread_first_col = TRUE) |&gt; fontsize(size = 9, part = &quot;all&quot;) |&gt; prepend_chunks( i = ~ is.na(AEBODSYS), j = 1, as_chunk(&quot;\\t&quot;) ) for(ARM_COD in names(ARM_COUNTS)){ ft &lt;- append_chunks( x = ft, part = &quot;header&quot;, i = 1, j = tabulator_colnames(tab, columns = &quot;n&quot;, ARM %in% !!ARM_COD), as_chunk(ARM_COUNTS[ARM_COD], formatter = fmt_header_n) ) } ft &lt;- labelizor( ft, j = &quot;AEDECOD&quot;, part = &quot;body&quot;, labels = AEDECOD_LABELS) |&gt; labelizor(part = &quot;header&quot;, labels = HEADER_LABELS) |&gt; align(j = 1, align = &quot;left&quot;) |&gt; autofit() ft .cl-e762ae4a{}.cl-e755a894{font-family:'Open Sans';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e755a89e{font-family:'Open Sans';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-e75aecf0{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-e75aed04{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-e75aed0e{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-e75aed0f{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-e75aed18{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-e75aed19{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-e75aed22{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-e75aed2c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-e75b10d6{width:2.493in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b10e0{width:0.1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b10ea{width:1.049in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b10f4{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b10fe{width:2.493in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b10ff{width:0.1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b1108{width:1.049in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b1109{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b1112{width:2.493in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b111c{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b1126{width:1.049in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b1130{width:1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b1131{width:2.493in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b113a{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b1144{width:1.049in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b114e{width:1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b1158{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b1159{width:2.493in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b1162{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b116c{width:1.049in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b116d{width:1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b1176{width:2.493in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b1177{width:1.049in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-e75b1180{width:1in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}dictionary-derived term&emsp;body system or organ classA: Drug X(N=134)B: Placebo(N=134)C: Combination(N=132)n(% of subjects)Total numberof eventsn(% of subjects)Total numberof eventsn(% of subjects)Total numberof eventsPatients with at least one event122 (91.0%)609123 (91.8%)622120 (90.9%)703cl A.1&emsp;Patients with at least one event78 (58.2%)13275 (56.0%)13089 (67.4%)160&emsp;dcd A.1.1.1.150 (37.3%)6445 (33.6%)6263 (47.7%)88&emsp;dcd A.1.1.1.248 (35.8%)6848 (35.8%)6850 (37.9%)72cl B.1&emsp;Patients with at least one event47 (35.1%)5649 (36.6%)6043 (32.6%)62&emsp;dcd B.1.1.1.147 (35.1%)5649 (36.6%)6043 (32.6%)62cl B.2&emsp;Patients with at least one event79 (59.0%)12974 (55.2%)13885 (64.4%)143&emsp;dcd B.2.1.2.149 (36.6%)6544 (32.8%)6252 (39.4%)66&emsp;dcd B.2.2.3.148 (35.8%)6454 (40.3%)7651 (38.6%)77cl C.1&emsp;Patients with at least one event43 (32.1%)5546 (34.3%)6343 (32.6%)64&emsp;dcd C.1.1.1.343 (32.1%)5546 (34.3%)6343 (32.6%)64cl C.2&emsp;Patients with at least one event35 (26.1%)4848 (35.8%)5355 (41.7%)65&emsp;dcd C.2.1.2.135 (26.1%)4848 (35.8%)5355 (41.7%)65cl D.1&emsp;Patients with at least one event79 (59.0%)12767 (50.0%)10680 (60.6%)135&emsp;dcd D.1.1.1.150 (37.3%)6142 (31.3%)5151 (38.6%)71&emsp;dcd D.1.1.4.248 (35.8%)6642 (31.3%)5550 (37.9%)64cl D.2&emsp;Patients with at least one event47 (35.1%)6258 (43.3%)7257 (43.2%)74&emsp;dcd D.2.1.5.347 (35.1%)6258 (43.3%)7257 (43.2%)74 4.2.4 tables The tables package normally generates tables from single datasets, while this kind of table requires information from two: adsl and ex_adae. One way to handle this would be to add the adsl patient count information to a copy of the ex_adae table. In this code we use a different approach: we generate one table of patient counts to produce the heading lines, and a second table with the adverse event data, then use rbind to combine the two tables. Code resetSession() library(tables) table_options(doCSS = TRUE) ex_adae &lt;- formatters::ex_adae subject_counts &lt;- table(adsl$ARM) countpercentid &lt;- function(num, ARM) { n &lt;- length(unique(num)) sprintf(&quot;%d (%.2f%%)&quot;, length(unique(num)), 100*n/subject_counts[ARM[1]]) } count &lt;- function(x) sprintf(&quot;(N=%d)&quot;, length(x)) heading &lt;- tabular(Heading(&quot;&quot;)*1* Heading(&quot;&quot;)*count ~ Heading()*ARM, data = adsl) body &lt;- tabular( Heading(&quot;Patients with at least one event&quot;)*1* Heading(&quot;&quot;)*countpercentid*Arguments(ARM = ARM)* Heading()*USUBJID + Heading(&quot;Total number of events&quot;)*1*Heading(&quot;&quot;)*1 + Heading()*AEBODSYS* (Heading(&quot;Patients with at least one event&quot;)* Percent(denom = ARM, fn = countpercentid)* Heading()*USUBJID + Heading(&quot;Total number of events&quot;)*1 + Heading()*AEDECOD*DropEmpty()* Heading()*Percent(denom = ARM, fn = countpercentid)* Heading()*USUBJID) ~ Heading()*ARM, data = ex_adae ) tab &lt;- rbind(heading, body) useGroupLabels(tab, indent = &quot;&amp;emsp;&quot;, extraLines = 1) #table3ebb7c51d5ef .Rtable thead, .Rtable .even { background-color: inherit; } #table3ebb7c51d5ef .left { text-align:left; } #table3ebb7c51d5ef .center { text-align:center; } #table3ebb7c51d5ef .right { text-align:right; } #table3ebb7c51d5ef .Rtable, #table3ebb7c51d5ef .Rtable thead { border-collapse: collapse; border-style: solid; border-width: medium 0; border-color: inherit; } #table3ebb7c51d5ef .Rtable th, #table3ebb7c51d5ef .Rtable td { padding-left: 0.5em; padding-right: 0.5em; border-width: 0; } A: Drug X B: Placebo C: Combination   (N=134) (N=134) (N=132) Patients with at least one event 122 (91.04%) 123 (91.79%) 120 (90.91%)       Total number of events 609 622 703       cl A.1        Patients with at least one event 78 (58.21%) 75 (55.97%) 89 (66.42%)  Total number of events 132 130 160  dcd A.1.1.1.1 50 (37.31%) 45 (33.58%) 63 (47.01%)  dcd A.1.1.1.2 48 (35.82%) 48 (35.82%) 50 (37.31%)       cl B.1        Patients with at least one event 47 (35.07%) 49 (36.57%) 43 (32.09%)  Total number of events 56 60 62  dcd B.1.1.1.1 47 (35.07%) 49 (36.57%) 43 (32.09%)       cl B.2        Patients with at least one event 79 (58.96%) 74 (55.22%) 85 (63.43%)  Total number of events 129 138 143  dcd B.2.1.2.1 49 (36.57%) 44 (32.84%) 52 (38.81%)  dcd B.2.2.3.1 48 (35.82%) 54 (40.30%) 51 (38.06%)       cl C.1        Patients with at least one event 43 (32.09%) 46 (34.33%) 43 (32.09%)  Total number of events 55 63 64  dcd C.1.1.1.3 43 (32.09%) 46 (34.33%) 43 (32.09%)       cl C.2        Patients with at least one event 35 (26.12%) 48 (35.82%) 55 (41.04%)  Total number of events 48 53 65  dcd C.2.1.2.1 35 (26.12%) 48 (35.82%) 55 (41.04%)       cl D.1        Patients with at least one event 79 (58.96%) 67 (50.00%) 80 (59.70%)  Total number of events 127 106 135  dcd D.1.1.1.1 50 (37.31%) 42 (31.34%) 51 (38.06%)  dcd D.1.1.4.2 48 (35.82%) 42 (31.34%) 50 (37.31%)       cl D.2        Patients with at least one event 47 (35.07%) 58 (43.28%) 57 (42.54%)  Total number of events 62 72 74  dcd D.2.1.5.3 47 (35.07%) 58 (43.28%) 57 (42.54%) 4.2.5 tidytlg Code resetSession() library(dplyr) library(tidytlg) adsl &lt;- formatters::ex_adsl adae &lt;- formatters::ex_adae %&gt;% mutate(TRTEMFL = &quot;Y&quot;) # Create analysis population counts tbl1 &lt;- freq(adsl, rowvar = &quot;SAFFL&quot;, colvar = &quot;ARM&quot;, statlist = statlist(&quot;n&quot;), rowtext = &quot;Analysis Set: Safety Population&quot;, subset = SAFFL == &quot;Y&quot;) # Create counts (percentages) for patients with at least one event tbl2 &lt;- freq(adae, denom_df = adsl, rowvar = &quot;TRTEMFL&quot;, colvar = &quot;ARM&quot;, statlist = statlist(&quot;n (x.x%)&quot;), rowtext = &quot;Patients with at least one event&quot;, subset = TRTEMFL == &quot;Y&quot;) # Create counts (percentages) of AE by AEBODSYS and AEDECOD tbl3a &lt;- nested_freq(adae, denom_df = adsl, rowvar = &quot;AEBODSYS*AEDECOD&quot;, colvar = &quot;ARM&quot;, statlist = statlist(&quot;n (x.x%)&quot;)) # Create total event counts by AEBODSYS tbl3b &lt;- freq(adae, rowvar = &quot;AEBODSYS&quot;, colvar = &quot;ARM&quot;, statlist = statlist(&quot;n&quot;, distinct = FALSE)) %&gt;% rename(AEBODSYS = label) %&gt;% mutate(label = &quot;Total number of events&quot;, nested_level = 0) # interleave tbl3a and tbl3b by AEBODSYS tbl3 &lt;- bind_rows(tbl3a, tbl3b) %&gt;% arrange(AEBODSYS, nested_level) # combine analysis results together tbl &lt;- bind_table(tbl1, tbl2, tbl3) %&gt;% select(-AEBODSYS) # output the analysis results gentlg(huxme = tbl, format = &quot;HTML&quot;, print.hux = FALSE, file = &quot;Table x.x.x.x&quot;, orientation = &quot;portrait&quot;, title = &quot;Adverse Events Summary - Safety Analysis Set&quot;, colheader = c(&quot;&quot;,&quot;A: Drug X&quot;,&quot;B: Placebo&quot;,&quot;C: Combination&quot;)) Table 4.2: Table x.x.x.x: &emsp; Adverse Events Summary - Safety Analysis Set A: Drug X B: Placebo C: Combination Analysis Set: Safety Population134134132 Patients with at least one event122 (91.0%)123 (91.8%)120 (90.9%) cl A.178 (58.2%)75 (56.0%)89 (67.4%) Total number of events132130160 dcd A.1.1.1.150 (37.3%)45 (33.6%)63 (47.7%) dcd A.1.1.1.248 (35.8%)48 (35.8%)50 (37.9%) cl B.147 (35.1%)49 (36.6%)43 (32.6%) Total number of events566062 dcd B.1.1.1.147 (35.1%)49 (36.6%)43 (32.6%) cl B.279 (59.0%)74 (55.2%)85 (64.4%) Total number of events129138143 dcd B.2.1.2.149 (36.6%)44 (32.8%)52 (39.4%) dcd B.2.2.3.148 (35.8%)54 (40.3%)51 (38.6%) cl C.143 (32.1%)46 (34.3%)43 (32.6%) Total number of events556364 dcd C.1.1.1.343 (32.1%)46 (34.3%)43 (32.6%) cl C.235 (26.1%)48 (35.8%)55 (41.7%) Total number of events485365 dcd C.2.1.2.135 (26.1%)48 (35.8%)55 (41.7%) cl D.179 (59.0%)67 (50.0%)80 (60.6%) Total number of events127106135 dcd D.1.1.1.150 (37.3%)42 (31.3%)51 (38.6%) dcd D.1.1.4.248 (35.8%)42 (31.3%)50 (37.9%) cl D.247 (35.1%)58 (43.3%)57 (43.2%) Total number of events627274 dcd D.2.1.5.347 (35.1%)58 (43.3%)57 (43.2%) [table x.x.x.x.html][/home/runner/work/_temp/b12862b4-488c-4339-87f9-9fc499992f88] 21MAR2023, 12:57 4.2.6 tfrmt Rather than starting with an ADaM, {tfrmt} assumes users will start with an ARD (Analysis Results Dataset), because of this, making this table will be split into two parts, first to make the ARD and second to format the table. Code resetSession() library(tidyverse) library(tfrmt) # Make ARD ex_adsl &lt;- formatters::ex_adsl ex_adae &lt;- formatters::ex_adae big_n &lt;- ex_adsl |&gt; dplyr::group_by(ARM) |&gt; dplyr::summarize( N = dplyr::n_distinct(USUBJID) ) adae_with_n &lt;- ex_adae |&gt; dplyr::left_join(big_n, by = &quot;ARM&quot;) calc_tot_and_any &lt;- function(.data){ .data |&gt; dplyr::reframe( n_subj = n_distinct(USUBJID), pct_subj = n_subj/N, n_evnts = n() ) |&gt; dplyr::distinct() |&gt; tidyr::pivot_longer(c(&quot;n_subj&quot;, &quot;pct_subj&quot;, &quot;n_evnts&quot;)) |&gt; dplyr::mutate(label = dplyr::case_when( name %in% c(&quot;n_subj&quot;, &quot;pct_subj&quot;) ~ &quot;Patients with at least one event&quot;, name == &quot;n_evnts&quot; ~ &quot;Total number of events&quot; )) } overall &lt;- adae_with_n |&gt; dplyr::group_by(ARM) |&gt; calc_tot_and_any() |&gt; dplyr:: mutate(AEBODSYS = label) bdysys_overall &lt;- adae_with_n |&gt; dplyr::group_by(ARM, AEBODSYS) |&gt; calc_tot_and_any() aeterm_sum &lt;- adae_with_n |&gt; dplyr::group_by(ARM, AEBODSYS, AETERM) |&gt; dplyr::reframe( n_subj = n_distinct(USUBJID), pct_subj = n_subj/N) |&gt; dplyr::distinct() |&gt; tidyr::pivot_longer(ends_with(&quot;subj&quot;)) |&gt; dplyr::rename(label = AETERM) header_n &lt;- big_n |&gt; dplyr::rename(value = N) |&gt; dplyr::mutate(name = &quot;header_n&quot;) ae_ard &lt;- dplyr::bind_rows( overall, bdysys_overall, aeterm_sum, header_n ) ## Format Table tfrmt( column = ARM, group = c(&quot;AEBODSYS&quot;), param = name, value = value, label = label, ) |&gt; # Then we cam combine it with an n percent template tfrmt_n_pct(n = &quot;n_subj&quot;, pct = &quot;pct_subj&quot;, pct_frmt_when = frmt_when(&quot;==1&quot; ~ &quot;&quot;, &quot;&gt;.99&quot; ~ &quot;(&gt;99%)&quot;, &quot;==0&quot; ~ &quot;&quot;, &quot;&lt;.01&quot; ~ &quot;(&lt;1%)&quot;, &quot;TRUE&quot; ~ frmt(&quot;(xx.x%)&quot;, transform = ~.*100)) ) |&gt; #Finally we are going to add some additional formatting tfrmt( body_plan = body_plan( frmt_structure(&quot;n_evnts&quot; = frmt(&quot;XXX&quot;)) ), big_n = big_n_structure(&quot;header_n&quot;), # Aligning on decimal places and spaces col_style_plan = col_style_plan( col_style_structure(col = matches(&quot;[A-Z]:.*&quot;), align = c(&quot;.&quot;, &quot; &quot;)) ) ) |&gt; print_to_gt(ae_ard) html { font-family: Courier, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #tfnfziqwrx .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 14px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #tfnfziqwrx .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #tfnfziqwrx .gt_caption { padding-top: 4px; padding-bottom: 4px; } #tfnfziqwrx .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #tfnfziqwrx .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #tfnfziqwrx .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #tfnfziqwrx .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #tfnfziqwrx .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #tfnfziqwrx .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #tfnfziqwrx .gt_column_spanner_outer:first-child { padding-left: 0; } #tfnfziqwrx .gt_column_spanner_outer:last-child { padding-right: 0; } #tfnfziqwrx .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #tfnfziqwrx .gt_group_heading { padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: rgba(255, 255, 255, 0); border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: rgba(255, 255, 255, 0); border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #tfnfziqwrx .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: rgba(255, 255, 255, 0); border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: rgba(255, 255, 255, 0); vertical-align: middle; } #tfnfziqwrx .gt_from_md > :first-child { margin-top: 0; } #tfnfziqwrx .gt_from_md > :last-child { margin-bottom: 0; } #tfnfziqwrx .gt_row { padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #tfnfziqwrx .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: rgba(255, 255, 255, 0); padding-left: 5px; padding-right: 5px; } #tfnfziqwrx .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: rgba(255, 255, 255, 0); padding-left: 5px; padding-right: 5px; vertical-align: top; } #tfnfziqwrx .gt_row_group_first td { border-top-width: 2px; } #tfnfziqwrx .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; } #tfnfziqwrx .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #tfnfziqwrx .gt_first_summary_row.thick { border-top-width: 2px; } #tfnfziqwrx .gt_last_summary_row { padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #tfnfziqwrx .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; } #tfnfziqwrx .gt_first_grand_summary_row { padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #tfnfziqwrx .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #tfnfziqwrx .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #tfnfziqwrx .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #tfnfziqwrx .gt_footnote { margin: 0px; font-size: 90%; padding-left: 1px; padding-right: 1px; padding-left: 5px; padding-right: 5px; } #tfnfziqwrx .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #tfnfziqwrx .gt_sourcenote { font-size: 90%; padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; } #tfnfziqwrx .gt_left { text-align: left; } #tfnfziqwrx .gt_center { text-align: center; } #tfnfziqwrx .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #tfnfziqwrx .gt_font_normal { font-weight: normal; } #tfnfziqwrx .gt_font_bold { font-weight: bold; } #tfnfziqwrx .gt_font_italic { font-style: italic; } #tfnfziqwrx .gt_super { font-size: 65%; } #tfnfziqwrx .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 75%; vertical-align: 0.4em; } #tfnfziqwrx .gt_asterisk { font-size: 100%; vertical-align: 0; } #tfnfziqwrx .gt_indent_1 { text-indent: 5px; } #tfnfziqwrx .gt_indent_2 { text-indent: 10px; } #tfnfziqwrx .gt_indent_3 { text-indent: 15px; } #tfnfziqwrx .gt_indent_4 { text-indent: 20px; } #tfnfziqwrx .gt_indent_5 { text-indent: 25px; } A: Drug X N = 134 B: Placebo N = 134 C: Combination N = 132 Patients with at least one event 122 (91.0%) 123 (91.8%) 120 (90.9%) Total number of events 609 622 703 cl A.1 Patients with at least one event 78 (58.2%) 75 (56.0%) 89 (67.4%) Total number of events 132 130 160 trm A.1.1.1.1 50 (37.3%) 45 (33.6%) 63 (47.7%) trm A.1.1.1.2 48 (35.8%) 48 (35.8%) 50 (37.9%) cl B.1 Patients with at least one event 47 (35.1%) 49 (36.6%) 43 (32.6%) Total number of events 56 60 62 trm B.1.1.1.1 47 (35.1%) 49 (36.6%) 43 (32.6%) cl B.2 Patients with at least one event 79 (59.0%) 74 (55.2%) 85 (64.4%) Total number of events 129 138 143 trm B.2.1.2.1 49 (36.6%) 44 (32.8%) 52 (39.4%) trm B.2.2.3.1 48 (35.8%) 54 (40.3%) 51 (38.6%) cl C.1 Patients with at least one event 43 (32.1%) 46 (34.3%) 43 (32.6%) Total number of events 55 63 64 trm C.1.1.1.3 43 (32.1%) 46 (34.3%) 43 (32.6%) cl C.2 Patients with at least one event 35 (26.1%) 48 (35.8%) 55 (41.7%) Total number of events 48 53 65 trm C.2.1.2.1 35 (26.1%) 48 (35.8%) 55 (41.7%) cl D.1 Patients with at least one event 79 (59.0%) 67 (50.0%) 80 (60.6%) Total number of events 127 106 135 trm D.1.1.1.1 50 (37.3%) 42 (31.3%) 51 (38.6%) trm D.1.1.4.2 48 (35.8%) 42 (31.3%) 50 (37.9%) cl D.2 Patients with at least one event 47 (35.1%) 58 (43.3%) 57 (43.2%) Total number of events 62 72 74 trm D.2.1.5.3 47 (35.1%) 58 (43.3%) 57 (43.2%) 4.3 Laboratory Tables 4.4 Time to Event Analysis Tables 4.4.1 Data and models used throughout Code resetSession() library(dplyr) library(tidyr) library(stringr) library(purrr) library(survival) data(&quot;cadaette&quot;, package = &quot;random.cdisc.data&quot;) head(cadaette) # A tibble: 6 × 66 STUDYID USUBJID SUBJID SITEID AGE AGEU SEX RACE ETHNIC COUNTRY DTHFL &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; 1 AB12345 AB12345-BR… id-105 BRA-1 38 YEARS M BLAC… HISPA… BRA N 2 AB12345 AB12345-BR… id-105 BRA-1 38 YEARS M BLAC… HISPA… BRA N 3 AB12345 AB12345-BR… id-105 BRA-1 38 YEARS M BLAC… HISPA… BRA N 4 AB12345 AB12345-BR… id-105 BRA-1 38 YEARS M BLAC… HISPA… BRA N 5 AB12345 AB12345-BR… id-105 BRA-1 38 YEARS M BLAC… HISPA… BRA N 6 AB12345 AB12345-BR… id-105 BRA-1 38 YEARS M BLAC… HISPA… BRA N # … with 55 more variables: INVID &lt;chr&gt;, INVNAM &lt;chr&gt;, ARM &lt;fct&gt;, ARMCD &lt;fct&gt;, # ACTARM &lt;fct&gt;, ACTARMCD &lt;fct&gt;, TRT01P &lt;fct&gt;, TRT01A &lt;fct&gt;, TRT02P &lt;fct&gt;, # TRT02A &lt;fct&gt;, REGION1 &lt;fct&gt;, STRATA1 &lt;fct&gt;, STRATA2 &lt;fct&gt;, BMRKR1 &lt;dbl&gt;, # BMRKR2 &lt;fct&gt;, ITTFL &lt;fct&gt;, SAFFL &lt;fct&gt;, BMEASIFL &lt;fct&gt;, BEP01FL &lt;fct&gt;, # AEWITHFL &lt;fct&gt;, RANDDT &lt;date&gt;, TRTSDTM &lt;dttm&gt;, TRTEDTM &lt;dttm&gt;, # TRT01SDTM &lt;dttm&gt;, TRT01EDTM &lt;dttm&gt;, TRT02SDTM &lt;dttm&gt;, TRT02EDTM &lt;dttm&gt;, # AP01SDTM &lt;dttm&gt;, AP01EDTM &lt;dttm&gt;, AP02SDTM &lt;dttm&gt;, AP02EDTM &lt;dttm&gt;, … Code adtte &lt;- cadaette %&gt;% dplyr::filter(PARAMCD == &quot;AETTE2&quot;, SAFFL == &quot;Y&quot;) Cox Proportional Hazard fit: Code cph &lt;- coxph(Surv(AVAL, CNSR==0) ~ TRT01A + STRATA1, ties = &quot;exact&quot;, data = adtte) Kaplan-Meier Model Code surv_tbl &lt;- as.data.frame(summary(survfit(Surv(AVAL, CNSR==0) ~ TRT01A, data = adtte, conf.type = &quot;log-log&quot;))$table) %&gt;% dplyr::mutate(TRT01A = factor(str_remove(row.names(.), &quot;TRT01A=&quot;), levels = levels(adtte$TRT01A)), ind = FALSE) .kmState &lt;- currentState() 4.4.2 rtables Code resetSession(.kmState) library(rtables) cnsr_counter &lt;- function(df, .var, .N_col) { x &lt;- df[!duplicated(df$USUBJID), .var] x &lt;- x[x != &quot;__none__&quot;] lapply(table(x), function(xi) rcell(xi*c(1, 1/.N_col), format = &quot;xx (xx.xx%)&quot;)) } a_count_subjs &lt;- function(x, .N_col) { in_rows(&quot;Subjects with Adverse Events n (%)&quot; = rcell(length(unique(x)) * c(1, 1 / .N_col), format = &quot;xx (xx.xx%)&quot;)) } a_cph &lt;- function(df, .var, .in_ref_col, .ref_full, full_cox_fit) { if(.in_ref_col) { ret &lt;- replicate(3, list(rcell(NULL))) } else { curtrt &lt;- df[[.var]][1] coefs &lt;- coef(full_cox_fit) sel_pos &lt;- grep(curtrt, names(coefs), fixed = TRUE) hrval &lt;- exp(coefs[sel_pos]) hrvalret &lt;- rcell(hrval, format = &quot;xx.x&quot;) sdf &lt;- survdiff(Surv(AVAL, CNSR==0) ~ TRT01A + STRATA1, data = rbind(df, .ref_full)) pval &lt;- (1-pchisq(sdf$chisq, length(sdf$n)-1))/2 ci_val &lt;- exp(unlist(confint(full_cox_fit)[sel_pos,])) ret &lt;- list(rcell(hrval, format = &quot;xx.x&quot;), rcell(ci_val, format = &quot;(xx.x, xx.x)&quot;), rcell(pval, format = &quot;x.xxxx | (&lt;0.0001)&quot;)) } in_rows(.list = ret, .names = c(&quot;Hazard ratio&quot;, &quot;95% confidence interval&quot;, &quot;p-value (one-sided stratified log rank)&quot;)) } a_tte &lt;- function(df, .var, kp_table) { ind &lt;- grep(df[[.var]][1], row.names(kp_table), fixed = TRUE) minmax &lt;- range(df[[&quot;AVAL&quot;]]) mm_val_str &lt;- format_value(minmax, format = &quot;xx.x, xx.x&quot;) rowfn &lt;- list() if(all(df$CNSR[df$AVAL == minmax[2]])) { mm_val_str &lt;- paste0(mm_val_str, &quot;*&quot;) rowfn &lt;- &quot;* indicates censoring&quot; } in_rows(Median = kp_table[ind, &quot;median&quot;, drop = TRUE], &quot;95% confidence interval&quot; = unlist(kp_table[ind, c(&quot;0.95LCL&quot;, &quot;0.95UCL&quot;)]), &quot;Min Max&quot; = mm_val_str, .formats = c(&quot;xx.xx&quot;, &quot;xx.xx - xx.xx&quot;, &quot;xx&quot;), .row_footnotes = list(NULL, NULL, rowfn)) } adtte2 &lt;- adtte %&gt;% mutate(CNSDTDSC = ifelse(CNSDTDSC == &quot;&quot;, &quot;__none__&quot;, CNSDTDSC)) lyt &lt;- basic_table(show_colcounts = TRUE, title = &quot;x.x: Safety Data&quot;, subtitles = c(&quot;x.x.x: Time to First Serious Adverse Event&quot;, &quot;Table x.x.x.x: Safety Endpoint - Safety Analysis Set&quot;), main_footer = c(&quot;Serious adverse events are defines as (...). All p-values are exploratory.&quot;, &quot;Hazard ratios are from a stratified Cox model of serious adverse event hazard rate,&quot;, &quot;with terms for treatment groups and strata1. Ties were handled using the exact&quot;, &quot;method. Hazard ratios of Placebo Combination over Drug X are presented, an&quot;, &quot;HR &lt; 1 denotes improvement compared to Drug X.&quot;), prov_footer = &quot;Source: ADTTE DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY&quot;) %&gt;% ## column faceting split_cols_by(&quot;ARM&quot;, ref_group = &quot;A: Drug X&quot;) %&gt;% ## overall count analyze(&quot;USUBJID&quot;, a_count_subjs, show_labels = &quot;hidden&quot;) %&gt;% ## Censored Subjects Summary analyze(&quot;CNSDTDSC&quot;, cnsr_counter, var_labels = &quot;Censored Subjects&quot;, show_labels = &quot;visible&quot;) %&gt;% ## CPH analysis analyze(&quot;ARM&quot;, a_cph, extra_args = list(full_cox_fit = cph), show_labels = &quot;hidden&quot;) %&gt;% ## Time-to-event analysis analyze(&quot;ARM&quot;, a_tte, var_labels = &quot;Time to first adverse event&quot;, show_labels = &quot;visible&quot;, extra_args = list(kp_table = surv_tbl), table_names = &quot;kapmeier&quot;) tbl_tte &lt;- build_table(lyt, adtte2) fnotes_at_path(tbl_tte, c(&quot;ma_USUBJID_CNSDTDSC_ARM_kapmeier&quot;, &quot;kapmeier&quot;)) &lt;- &quot;Product-limit (Kaplan-Meier) estimates.&quot; tbl_tte x.x: Safety Data x.x.x: Time to First Serious Adverse Event Table x.x.x.x: Safety Endpoint - Safety Analysis Set ———————————————————————————————————————————————————————————————————————————————————————— A: Drug X B: Placebo C: Combination (N=134) (N=134) (N=132) ———————————————————————————————————————————————————————————————————————————————————————— Subjects with Adverse Events n (%) 134 (100.00%) 134 (100.00%) 132 (100.00%) Censored Subjects Clinical Cut Off 10 (7.46%) 4 (2.99%) 14 (10.61%) Completion or Discontinuation 13 (9.70%) 3 (2.24%) 16 (12.12%) End of AE Reporting Period 22 (16.42%) 4 (2.99%) 14 (10.61%) Hazard ratio 1.5 1.1 95% confidence interval (1.1, 1.9) (0.8, 1.5) p-value (one-sided stratified log rank) 0.0208 0.4619 Time to first adverse event {1} Median 0.39 0.37 0.26 95% confidence interval 0.23 - 0.60 0.25 - 0.46 0.18 - 0.34 Min Max {2} 0.0, 3.0* 0.0, 3.0* 0.0, 3.0* ———————————————————————————————————————————————————————————————————————————————————————— {1} - Product-limit (Kaplan-Meier) estimates. {2} - * indicates censoring ———————————————————————————————————————————————————————————————————————————————————————— Serious adverse events are defines as (...). All p-values are exploratory. Hazard ratios are from a stratified Cox model of serious adverse event hazard rate, with terms for treatment groups and strata1. Ties were handled using the exact method. Hazard ratios of Placebo Combination over Drug X are presented, an HR &lt; 1 denotes improvement compared to Drug X. Source: ADTTE DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY 4.4.3 Cell Value Derivation for gt of Time to Event Analysis Our standard TTE table consists of (a derivation of) four main parts: Descriptive stats including the number of subjects with an event, number of subjects censored and censoring reasons Hazard ratio with corresponding 95% CI from a (stratified) Cox model and a p-value from a stratified log rank test Median time to event Kaplan-Meier analysis Number of patients at risk at specified visits from Kaplan-Meier analysis (omitted here). Code resetSession(.kmState) library(gt) ### Subject Count with events ## surv_tbl calculated above subj_count &lt;- surv_tbl |&gt; dplyr::mutate(pct = sprintf(&quot;%i (%5.1f)&quot;, events, 100*events/records), label = &quot;Number of subjects with serious adverse event, n (%)&quot;) |&gt; dplyr::select(label, TRT01A, pct) |&gt; tidyr::pivot_wider(id_cols = label, names_from = TRT01A, values_from = pct) |&gt; dplyr::mutate(ind = FALSE) # Number of censored subjects cnsrd_subj_full &lt;- surv_tbl |&gt; dplyr::mutate(pct = sprintf(&quot;%i (%4.1f)&quot;, records-events, 100*(records-events)/records), CNSDTDSC = &quot;Number of censored subjects, n (%)&quot;) |&gt; dplyr::select(CNSDTDSC, TRT01A, pct) cnsrd_subj &lt;- adtte |&gt; dplyr::group_by(TRT01A) |&gt; dplyr::mutate(CNSR = CNSR/n()) |&gt; dplyr::ungroup() |&gt; dplyr::filter(CNSR != 0) |&gt; dplyr::group_by(TRT01A, CNSDTDSC) |&gt; dplyr::summarise(pct = sprintf(&quot;%i (%4.1f)&quot;, sum(CNSR != 0), 100*sum(CNSR)), .groups = &quot;drop&quot;) |&gt; dplyr::bind_rows(cnsrd_subj_full) |&gt; tidyr::pivot_wider(id_cols = CNSDTDSC, names_from = TRT01A, values_from = pct) |&gt; dplyr::rename(label = CNSDTDSC) |&gt; dplyr::mutate(ind = label != &quot;Number of censored subjects, n (%)&quot;) |&gt; dplyr::arrange(ind) Code ## cph calculated above hr &lt;- exp(coef(cph)) ci_hr &lt;- exp(confint(cph)) # Hazard ratio and 95% CI df_hr &lt;- cbind(ci_hr, hr) |&gt; as.data.frame() |&gt; (\\(data) dplyr::filter(data, grepl(&quot;TRT01A&quot;, row.names(data))))() |&gt; (\\(data) dplyr::mutate( data, TRT01A = factor(stringr::str_remove(row.names(data), &quot;TRT01A&quot;)), ci = sprintf(&quot;[%4.1f, %4.1f]&quot;, round(!!sym(&quot;2.5 %&quot;), 1), round(!!sym(&quot;97.5 %&quot;), 1)) ))() |&gt; dplyr::select(TRT01A, hr, ci) # Log rank p-value log_rank_test &lt;- purrr::map_df(.x = list(c(&quot;A: Drug X&quot;, &quot;B: Placebo&quot;), c(&quot;A: Drug X&quot;, &quot;C: Combination&quot;)), .f = ~{sdf &lt;- survdiff(Surv(AVAL, CNSR==0) ~ TRT01A + STRATA1, data = adtte |&gt; dplyr::filter(TRT01A %in% .x)); data.frame(TRT01A = .x[2], pval = (1-pchisq(sdf$chisq, length(sdf$n)-1))/2)}) df_hr_comp &lt;- merge(df_hr, log_rank_test, by = &quot;TRT01A&quot;) |&gt; dplyr::mutate(hr = sprintf(&quot;%4.1f&quot;, round(hr, 1)), pval = ifelse(pval &lt; 0.0001, &quot;&lt;0.0001&quot;, sprintf(&quot;%6.4f&quot;, round(pval, 4)))) |&gt; tidyr::pivot_longer(cols = c(hr, ci, pval), names_to = &quot;label&quot;, values_to = &quot;val&quot;) |&gt; tidyr::pivot_wider(names_from = TRT01A, values_from = &quot;val&quot;) |&gt; dplyr::mutate(label = dplyr::recode(label, &quot;hr&quot; = &quot;Hazard ratio&quot;, &quot;ci&quot; = &quot;95% confidence interval&quot;, &quot;pval&quot; = &quot;p-value (one-sided stratified log rank)&quot;), ind = FALSE) Code median_survtime &lt;- surv_tbl |&gt; dplyr::mutate(ci = sprintf(&quot;[%4.2f, %4.2f]&quot;, !!sym(&quot;0.95LCL&quot;), !!sym(&quot;0.95UCL&quot;)), median = sprintf(&quot;%4.2f&quot;, median), id = &quot;&quot;) |&gt; dplyr::select(TRT01A, id, median, ci) |&gt; tidyr::pivot_longer(cols = c(id, median, ci), names_to = &quot;label&quot;, values_to = &quot;val&quot;) |&gt; tidyr::pivot_wider(names_from = TRT01A, values_from = val) |&gt; dplyr::mutate(ind = label != &quot;id&quot;, label = dplyr::recode(label, &quot;median&quot; = &quot;Median (years)&quot;, &quot;ci&quot; = &quot;95% confidence interval&quot;, &quot;id&quot; = &quot;Time to first serious adverse event (a)&quot;)) min_max &lt;- adtte |&gt; dplyr::filter(!(AVAL == 0 &amp; CNSR == 1)) |&gt; dplyr::group_by(TRT01A) |&gt; dplyr::mutate(max_cnsr = !is.na(AVAL) &amp; AVAL == max(AVAL, na.rm = TRUE) &amp; CNSR == 1) |&gt; dplyr::summarize( min_max = sprintf(&quot;%4.2f, %4.2f%s&quot;, min(AVAL, na.rm = TRUE), max(AVAL, na.rm = TRUE), ifelse(sum(max_cnsr) &gt; 0, &quot;*&quot;, &quot;&quot;)), .groups = &quot;drop&quot; ) |&gt; tidyr::pivot_wider(names_from = TRT01A, values_from = min_max) |&gt; dplyr::mutate(label = &quot;Min, Max (b)&quot;, ind = TRUE) model_sum &lt;- dplyr::bind_rows(subj_count, cnsrd_subj, df_hr_comp, median_survtime, min_max) 4.4.4 gt Code header_n &lt;- adtte |&gt; dplyr::group_by(TRT01A) |&gt; dplyr::summarise(N = dplyr::n(), .groups = &quot;drop&quot;) |&gt; dplyr::transmute(TRT = sprintf(&quot;%s \\n N=%i (100%%)&quot;, TRT01A, N)) |&gt; dplyr::group_split(TRT) ### Begin table creation gt(model_sum) |&gt; cols_hide(ind) |&gt; tab_header( title = &quot;x.x: Safety Data&quot;, subtitle = md(&quot;x.x.x: Time to First Serious Adverse Event \\n Table x.x.x.x: Safety Endpoint - Safety Analysis Set&quot;), preheader = c(&quot;Protocol: XXXXX&quot;, &quot;Cutoff date: DDMMYYYY&quot;) ) |&gt; tab_source_note(&quot;Source: ADTTE DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY&quot;) |&gt; opt_align_table_header(align = &quot;left&quot;) |&gt; cols_align(align = c(&quot;center&quot;), columns = c(&quot;A: Drug X&quot;, &quot;B: Placebo&quot;, &quot;C: Combination&quot;)) |&gt; cols_align(align = &quot;left&quot;, columns = &quot;label&quot;) |&gt; tab_style(style = cell_text(indent = pct(5)), locations = cells_body(columns = 1, rows = ind == TRUE)) |&gt; sub_missing(columns = everything(), missing_text = &quot;&quot;) |&gt; cols_label(&quot;label&quot; = &quot;&quot;, &quot;A: Drug X&quot; = md(header_n[[1]]), &quot;B: Placebo&quot; = md(header_n[[2]]), &quot;C: Combination&quot; = md(header_n[[3]])) |&gt; tab_footnote(footnote = md(&quot;Serious adverse events are defines as (...). All p-values are exploratory. \\n (a) Product-limit (Kaplan-Meier) estimates. \\n (b) Minimum and maximum of event times. * Denotes censoring. \\n Hazard ratios are from a stratified Cox model of serious adverse event hazard rate, with terms for treatment groups and strata1. Ties were handled using the exact method. Hazard ratios of Placebo/ Combination over Drug X are presented, a HR &lt; 1 denotes improvement compared to Drug X.&quot;)) |&gt; tab_options( table.font.names = &quot;Courier new&quot;, table.font.size = 9, page.orientation = &quot;landscape&quot;, page.numbering = TRUE, page.header.use_tbl_headings = TRUE, page.footer.use_tbl_notes = TRUE) html { font-family: 'Courier new'; } #ycrgupqdoz .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 9px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #ycrgupqdoz .gt_heading { background-color: #FFFFFF; text-align: left; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #ycrgupqdoz .gt_caption { padding-top: 4px; padding-bottom: 4px; } #ycrgupqdoz .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #ycrgupqdoz .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #ycrgupqdoz .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #ycrgupqdoz .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #ycrgupqdoz .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #ycrgupqdoz .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #ycrgupqdoz .gt_column_spanner_outer:first-child { padding-left: 0; } #ycrgupqdoz .gt_column_spanner_outer:last-child { padding-right: 0; } #ycrgupqdoz .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #ycrgupqdoz .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #ycrgupqdoz .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #ycrgupqdoz .gt_from_md > :first-child { margin-top: 0; } #ycrgupqdoz .gt_from_md > :last-child { margin-bottom: 0; } #ycrgupqdoz .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #ycrgupqdoz .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; } #ycrgupqdoz .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; } #ycrgupqdoz .gt_row_group_first td { border-top-width: 2px; } #ycrgupqdoz .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #ycrgupqdoz .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #ycrgupqdoz .gt_first_summary_row.thick { border-top-width: 2px; } #ycrgupqdoz .gt_last_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #ycrgupqdoz .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #ycrgupqdoz .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #ycrgupqdoz .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #ycrgupqdoz .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #ycrgupqdoz .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #ycrgupqdoz .gt_footnote { margin: 0px; font-size: 90%; padding-left: 4px; padding-right: 4px; padding-left: 5px; padding-right: 5px; } #ycrgupqdoz .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #ycrgupqdoz .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #ycrgupqdoz .gt_left { text-align: left; } #ycrgupqdoz .gt_center { text-align: center; } #ycrgupqdoz .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #ycrgupqdoz .gt_font_normal { font-weight: normal; } #ycrgupqdoz .gt_font_bold { font-weight: bold; } #ycrgupqdoz .gt_font_italic { font-style: italic; } #ycrgupqdoz .gt_super { font-size: 65%; } #ycrgupqdoz .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 75%; vertical-align: 0.4em; } #ycrgupqdoz .gt_asterisk { font-size: 100%; vertical-align: 0; } #ycrgupqdoz .gt_indent_1 { text-indent: 5px; } #ycrgupqdoz .gt_indent_2 { text-indent: 10px; } #ycrgupqdoz .gt_indent_3 { text-indent: 15px; } #ycrgupqdoz .gt_indent_4 { text-indent: 20px; } #ycrgupqdoz .gt_indent_5 { text-indent: 25px; } x.x: Safety Data x.x.x: Time to First Serious Adverse Event Table x.x.x.x: Safety Endpoint - Safety Analysis Set A: Drug X N=134 (100%) B: Placebo N=134 (100%) C: Combination N=132 (100%) Number of subjects with serious adverse event, n (%) 89 ( 66.4) 123 ( 91.8) 88 ( 66.7) Number of censored subjects, n (%) 45 (33.6) 11 ( 8.2) 44 (33.3) Clinical Cut Off 10 ( 7.5) 4 ( 3.0) 14 (10.6) Completion or Discontinuation 13 ( 9.7) 3 ( 2.2) 16 (12.1) End of AE Reporting Period 22 (16.4) 4 ( 3.0) 14 (10.6) Hazard ratio 1.5 1.1 95% confidence interval [ 1.1, 1.9] [ 0.8, 1.5] p-value (one-sided stratified log rank) 0.0208 0.4619 Time to first serious adverse event (a) Median (years) 0.39 0.37 0.26 95% confidence interval [0.23, 0.60] [0.25, 0.46] [0.18, 0.34] Min, Max (b) 0.00, 3.00* 0.01, 3.00* 0.00, 3.00* Source: ADTTE DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY Serious adverse events are defines as (...). All p-values are exploratory. (a) Product-limit (Kaplan-Meier) estimates. (b) Minimum and maximum of event times. * Denotes censoring. Hazard ratios are from a stratified Cox model of serious adverse event hazard rate, with terms for treatment groups and strata1. Ties were handled using the exact method. Hazard ratios of Placebo/ Combination over Drug X are presented, a HR &lt; 1 denotes improvement compared to Drug X. 4.4.5 flextable Code resetSession(.kmState) ARM_COUNTS &lt;- .ARM_COUNTS # Restore from previous section library(flextable) library(tidyverse) # labels and notes ---- # named vectors that will be used later as # labels for the table. description_labels &lt;- c(SAE = &quot;Number of subjects with serious adverse event&quot;, CENSOR_EVENTS = &quot;Number of censored subjects&quot;, HAZARD_RATIO = &quot;Hazard ratio&quot;, TTF_SAE = &quot;Time to first adverse event&quot;) subdescription_labels &lt;- c(subdescription = &quot;&quot;, ALL = &quot;Censored Subjects&quot;, EST = &quot;Estimate&quot;, CONFINT = &quot;95% confidence interval&quot;, PVALUE = &quot;one-sided stratified log rank p-value&quot;, MEDIAN = &quot;Median&quot;, RANGE = &quot;Min Max&quot;) labels &lt;- c(description_labels, subdescription_labels) additional_notes &lt;- c( &quot;Serious adverse events are defines as (...). All p-values are exploratory.&quot;, paste(&quot;Hazard ratios are from a stratified Cox model&quot;, &quot;of serious adverse event hazard rate, with terms for treatment groups and strata1.&quot;, &quot;Ties were handled using the exact method. Hazard ratios of Placebo/ Combination over&quot;, &quot;Drug X are presented, a HR &lt; 1 denotes improvement compared to Drug X.&quot;)) titles &lt;- c( &quot;x.x: Safety Data&quot;, &quot;x.x.x: Time to First Serious Adverse Event&quot;, &quot;Table x.x.x.x: Safety Endpoint - Safety Analysis Set&quot;) # Data need to be prepared in a single data.frame, # a function is written to make the code simplier to organize. #&#39; @noRd #&#39; @description create a data.frame made of #&#39; several sub data.frame, each for a specific #&#39; calculation. Final result has two specific columns #&#39; &#39;description&#39; and &#39;subdescription&#39; that will #&#39; contain various labels or group labels. prepare_tte_df &lt;- function(adtte, cph, surv_tbl) { ## Number of subjects with serious adverse event ---- subj_count &lt;- surv_tbl |&gt; select(TRT01A, n = events, records) |&gt; mutate(pct = n / records, description = &quot;SAE&quot;, subdescription = &quot;ALL&quot;) ## Number of censored subjects ---- subj_censored &lt;- subj_count |&gt; mutate( n = records - n, pct = 1 - pct, description = &quot;CENSOR_EVENTS&quot;, subdescription = &quot;ALL&quot; ) ## Number of censored subjects - detail per CNSDTDSC ---- subj_censored_detail &lt;- adtte |&gt; filter(CNSR &gt; 0) |&gt; count(TRT01A, CNSDTDSC) |&gt; left_join(subj_count |&gt; select(TRT01A, records), by = &quot;TRT01A&quot;) |&gt; mutate(pct = n / records, description = &quot;CENSOR_EVENTS&quot;) |&gt; rename(subdescription = &quot;CNSDTDSC&quot;) ## Hazard ratio and 95% CI ---- coefs_hr &lt;- cbind(exp(confint(cph)), y = exp(coef(cph))) |&gt; as.data.frame() |&gt; rownames_to_column(var = &quot;TRT01A&quot;) |&gt; filter(grepl(&quot;TRT01A&quot;, TRT01A)) |&gt; mutate(TRT01A = str_replace(TRT01A, &quot;TRT01A&quot;, &quot;&quot;)) hr_dat &lt;- bind_rows( select(coefs_hr, TRT01A, LCL = `2.5 %`, UCL = `97.5 %`) |&gt; mutate(description = &quot;HAZARD_RATIO&quot;, subdescription = &quot;CONFINT&quot;), select(coefs_hr, TRT01A, y) |&gt; mutate(description = &quot;HAZARD_RATIO&quot;, subdescription = &quot;EST&quot;) ) ## p-value (one-sided stratified log rank) ---- pval_dat &lt;- purrr::map_df( .x = list(c(&quot;A: Drug X&quot;, &quot;B: Placebo&quot;), c(&quot;A: Drug X&quot;, &quot;C: Combination&quot;)), .f = ~ { sdf &lt;- survdiff(Surv(AVAL, CNSR == 0) ~ TRT01A + STRATA1, data = adtte |&gt; dplyr::filter(TRT01A %in% .x)) data.frame(TRT01A = .x[2], description = &quot;HAZARD_RATIO&quot;, subdescription = &quot;PVALUE&quot;, y = (1 - pchisq(sdf$chisq, length(sdf$n) - 1)) / 2) } ) ## Time to first serious adverse event ---- tfe_dat &lt;- bind_rows( surv_tbl |&gt; select(TRT01A, LCL = `0.95LCL`, UCL = `0.95UCL`) |&gt; mutate(description = &quot;TTF_SAE&quot;, subdescription = &quot;CONFINT&quot;), surv_tbl |&gt; select(TRT01A, y = median) |&gt; mutate(description = &quot;TTF_SAE&quot;, subdescription = &quot;MEDIAN&quot;), adtte |&gt; filter(!(AVAL == 0 &amp; CNSR == 1)) |&gt; group_by(TRT01A) |&gt; mutate(max_cnsr = !is.na(AVAL) &amp; AVAL == max(AVAL, na.rm = TRUE) &amp; CNSR == 1) |&gt; summarise( min = min(AVAL, na.rm = TRUE), max = max(AVAL, na.rm = TRUE), is_censored = sum(max_cnsr) &gt; 0, description = &quot;TTF_SAE&quot;, subdescription = &quot;RANGE&quot; ) ) cnsdtdsc_levels &lt;- unique(adtte$CNSDTDSC) |&gt; sort() |&gt; setdiff(&quot;&quot;) dat &lt;- bind_rows(subj_count, subj_censored, subj_censored_detail, hr_dat, pval_dat, tfe_dat) |&gt; as_tibble() |&gt; ## factor for easy ordering ---- mutate( description = factor(description, levels = c(&quot;SAE&quot;, &quot;CENSOR_EVENTS&quot;, &quot;HAZARD_RATIO&quot;, &quot;TTF_SAE&quot;)), subdescription = factor(subdescription, levels = c(&quot;ALL&quot;, cnsdtdsc_levels, &quot;NUSUBJID&quot;, &quot;MEDIAN&quot;, &quot;EST&quot;, &quot;CONFINT&quot;, &quot;PVALUE&quot;, &quot;RANGE&quot;))) dat } dat &lt;- prepare_tte_df(adtte, cph, surv_tbl) # Now data.frame is ready to be formatted with `fmt_time_to_event()`. # The function handle each special cases to be covered so that # the four main parts are formatted as expected. library(glue) library(dplyr) # format fun ---- fmt_time_to_event &lt;- function(description, subdescription, y, cts, pcts, LCL, UCL, min, max, is_censored) { case_when( !is.na(cts) &amp; !is.na(pcts) ~ glue(&#39;{sprintf(&quot;%.0f&quot;, cts)} ({sprintf(&quot;%.02f&quot;, pcts*100)}%)&#39;), !is.na(y) &amp; !subdescription %in% &quot;PVALUE&quot; ~ glue(&#39;{sprintf(&quot;%.02f&quot;, y)}&#39;), !is.na(y) &amp; subdescription %in% &quot;PVALUE&quot; ~ glue(&quot;{scales::label_pvalue()(y)}&quot;), !is.na(LCL) &amp; !is.na(UCL) ~ glue(&#39;[{sprintf(&quot;%.02f&quot;, LCL)}, {sprintf(&quot;%.02f&quot;, UCL)}]&#39;), !is.na(LCL) &amp; !is.na(UCL) ~ glue(&#39;[{sprintf(&quot;%.02f&quot;, LCL)}, {sprintf(&quot;%.02f&quot;, UCL)}]&#39;), !is.na(min) &amp; !is.na(max) &amp; is_censored ~ glue(&#39;{sprintf(&quot;%.02f&quot;, min)}, {sprintf(&quot;%.02f&quot;, max)}*&#39;), !is.na(min) &amp; !is.na(max) &amp; !is_censored ~ glue(&#39;{sprintf(&quot;%.02f&quot;, min)}, {sprintf(&quot;%.02f&quot;, max)}&#39;), TRUE ~ &quot;&quot; ) } # use `tabulator()` and `as_flextable()` together to create the table. tab &lt;- tabulator(dat, rows = c(&quot;description&quot;, &quot;subdescription&quot;), columns = &quot;TRT01A&quot;, content_cell = as_paragraph( fmt_time_to_event( description = description, subdescription = subdescription, y = y, cts = n, pcts = pct, LCL = LCL, UCL = UCL, min = min, max = max, is_censored = is_censored)) ) ft &lt;- as_flextable(x = tab, spread_first_col = TRUE, separate_with = &quot;description&quot;, sep_w = 0) |&gt; # footnotes footnote( j = 1, i = ~ description %in% c(&quot;CENSOR_EVENTS&quot;, &quot;SAE&quot;), ref_symbols = &quot; (1)&quot;, value = as_paragraph(&quot; Number of subjects (% of subjects)&quot;) ) |&gt; footnote( j = 1, i = ~ description %in% &quot;TTF_SAE&quot; &amp; is.na(subdescription), ref_symbols = &quot; (2)&quot;, value = as_paragraph(&quot; Product-limit (Kaplan-Meier) estimates.&quot;) ) |&gt; footnote( j = 1, i = ~ subdescription %in% &quot;RANGE&quot;, ref_symbols = &quot; (3)&quot;, value = as_paragraph(&quot; * indicates censoring&quot;) ) |&gt; add_footer_lines(values = additional_notes) |&gt; # labels labelizor(j = &quot;subdescription&quot;, labels = labels, part = &quot;all&quot;) |&gt; # indentation prepend_chunks(i = ~ is.na(description), j = &quot;subdescription&quot;, as_chunk(&quot;\\t&quot;)) |&gt; align(i = ~ !is.na(description), align = &quot;left&quot;) |&gt; autofit() |&gt; add_header_lines(values = titles) |&gt; hline_top(part = &quot;header&quot;, border = fp_border_default(width = 0)) |&gt; hline(part = &quot;header&quot;, i = 1:2, border = fp_border_default(width = 0)) for (ARM_COD in names(ARM_COUNTS)) { ft &lt;- append_chunks(x = ft, part = &quot;header&quot;, i = 4, j = tabulator_colnames(tab, columns = &quot;content_cell&quot;, TRT01A %in% !!ARM_COD), as_chunk(ARM_COUNTS[ARM_COD], formatter = fmt_header_n)) } ft .cl-ed6748a0{}.cl-ed5c6822{font-family:'Open Sans';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-ed5c6836{font-family:'Open Sans';font-size:6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3pt;}.cl-ed60f68a{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-ed60f694{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-ed60f69e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-ed60f6a8{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-ed60f6b2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-ed6114ee{width:3.345in;background-color:transparent;vertical-align: bottom;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed6114f8{width:0.957in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611502{width:1.036in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611503{width:1.206in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed61150c{width:3.345in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611516{width:0.957in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611517{width:1.036in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611520{width:1.206in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611521{width:3.345in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed61152a{width:0.957in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611534{width:1.036in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611535{width:1.206in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed61153e{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed61153f{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611540{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611552{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611553{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed61155c{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed61155d{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611566{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611567{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611568{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611570{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611571{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed61157a{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed61157b{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611584{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611585{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed61158e{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 0.75pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed61158f{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0.75pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611598{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 0.75pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed6115a2{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0.75pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed6115a3{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed6115ac{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed6115ad{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed6115b6{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed6115c0{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed6115ca{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed6115cb{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed6115d4{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed6115d5{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed6115de{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed6115e8{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed6115e9{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed6115f2{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed6115fc{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed6115fd{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611606{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611607{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611608{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611610{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed61161a{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed61161b{width:3.345in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611624{width:0.957in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed611625{width:1.036in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-ed61162e{width:1.206in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}x.x: Safety Datax.x.x: Time to First Serious Adverse EventTable x.x.x.x: Safety Endpoint - Safety Analysis SetA: Drug X(N=134)B: Placebo(N=134)C: Combination(N=132)Number of subjects with serious adverse event (1)89 (66.42%)123 (91.79%)88 (66.67%)Number of censored subjects (1)&emsp;Censored Subjects45 (33.58%)11 (8.21%)44 (33.33%)&emsp;Clinical Cut Off10 (7.46%)4 (2.99%)14 (10.61%)&emsp;Completion or Discontinuation13 (9.70%)3 (2.24%)16 (12.12%)&emsp;End of AE Reporting Period22 (16.42%)4 (2.99%)14 (10.61%)Hazard ratio&emsp;Estimate1.461.09&emsp;95% confidence interval[1.11, 1.92][0.81, 1.47]&emsp;one-sided stratified log rank p-value0.0210.462Time to first adverse event (2)&emsp;Median0.390.370.26&emsp;95% confidence interval[0.23, 0.60][0.25, 0.46][0.18, 0.34]&emsp;Min Max (3)0.00, 3.00*0.01, 3.00*0.00, 3.00* (1) Number of subjects (% of subjects) (2) Product-limit (Kaplan-Meier) estimates. (3) * indicates censoringSerious adverse events are defines as (...). All p-values are exploratory.Hazard ratios are from a stratified Cox model of serious adverse event hazard rate, with terms for treatment groups and strata1. Ties were handled using the exact method. Hazard ratios of Placebo/ Combination over Drug X are presented, a HR &lt; 1 denotes improvement compared to Drug X. 4.4.6 tables Code resetSession(.kmState) library(tables) table_options(doCSS = TRUE) ex_adae &lt;- formatters::ex_adae subject_counts &lt;- table(adsl$ARM) countpercentid &lt;- function(num, ARM) { n &lt;- length(unique(num)) sprintf(&quot;%d (%.2f%%)&quot;, length(unique(num)), 100*n/subject_counts[ARM[1]]) } valuepercent &lt;- function(x, ARM) { sprintf(&quot;%d (%.2f%%)&quot;, x, 100*x/subject_counts[ARM] ) } blanks &lt;- function(x) &quot;&quot; count &lt;- function(x) sprintf(&quot;(N=%d)&quot;, length(x)) hazardratio &lt;- function(ARM) { entry &lt;- paste0(&quot;TRT01A&quot;, ARM) coef &lt;- coef(cph) if (entry %in% names(coef)) sprintf(&quot;%.1f&quot;, exp(coef[entry])) else &quot;&quot; } hazardratioconfint &lt;- function(ARM) { entry &lt;- paste0(&quot;TRT01A&quot;, ARM) confint &lt;- confint(cph) if (entry %in% rownames(confint)) { confint &lt;- as.numeric(confint[entry,]) sprintf(&quot;(%.1f, %.1f)&quot;, exp(confint[1]), exp(confint[2])) } else &quot;&quot; } hazardpvalue &lt;- function(ARM) { if (ARM == &quot;A: Drug X&quot;) &quot;&quot; else { twogroups &lt;- c(&quot;A: Drug X&quot;, ARM) sdf &lt;- survdiff(Surv(AVAL, CNSR==0) ~ TRT01A + STRATA1, data = adtte, subset = TRT01A %in% twogroups) pval &lt;- (1-pchisq(sdf$chisq, length(sdf$n)-1))/2 sprintf(&quot;%.4f&quot;, pval) } } Median &lt;- function(ARM) { vals &lt;- subset(surv_tbl, TRT01A == ARM) sprintf(&quot;%.2f&quot;, vals$median) } minmaxevent &lt;- function(ARM) { vals &lt;- subset(adtte, TRT01A == ARM) sprintf(&quot;%.2f, %.2f&quot;, min(vals$AVAL), max(vals$AVAL)) } eventCI &lt;- function(ARM) { vals &lt;- subset(surv_tbl, TRT01A == ARM) sprintf(&quot;[%.2f, %.2f]&quot;, vals$`0.95LCL`, vals$`0.95UCL`) } heading &lt;- tabular(Heading(&quot;&quot;)*1*Heading(&quot;&quot;)*count ~ Heading()*ARM, data = adsl) part1 &lt;- tabular( Heading(&quot;Subjects with serious adverse events&quot;)*1*Heading(&quot;&quot;)* events*Heading()* valuepercent*Arguments(ARM = TRT01A) ~ Heading()*TRT01A, data = surv_tbl ) part2 &lt;- tabular( Heading(&quot;Number of censored subjects&quot;)*1*Factor(CNSDTDSC, &quot;&quot;)* Heading()*countpercentid*Arguments(ARM = TRT01A)* Heading()*USUBJID ~ Heading()*TRT01A, data = subset(adtte, nchar(CNSDTDSC) &gt; 0)) part3 &lt;- tabular( ( Heading(&quot;Hazard ratio&quot;)*1*Heading(&quot;&quot;)*hazardratio + Heading(&quot;95% confidence interval&quot;)*1*Heading(&quot;&quot;)*hazardratioconfint + Heading(&quot;p-value (one-sided stratified log rank)&quot;)*1*Heading(&quot;&quot;)*hazardpvalue + Heading(&quot;Time to first serious adverse event&quot;)*1*( Heading(&quot;Median (years)&quot;)*Median + Heading(&quot;95% confidence interval&quot;)*eventCI + Heading(&quot;Min, Max&quot;)*minmaxevent))* Heading()*as.character(TRT01A) ~ Heading()*TRT01A, data = surv_tbl) useGroupLabels(rbind(heading, part1, part2, part3), indent = &quot;&amp;emsp;&quot;) #table3ebb1fe9b721 .Rtable thead, .Rtable .even { background-color: inherit; } #table3ebb1fe9b721 .left { text-align:left; } #table3ebb1fe9b721 .center { text-align:center; } #table3ebb1fe9b721 .right { text-align:right; } #table3ebb1fe9b721 .Rtable, #table3ebb1fe9b721 .Rtable thead { border-collapse: collapse; border-style: solid; border-width: medium 0; border-color: inherit; } #table3ebb1fe9b721 .Rtable th, #table3ebb1fe9b721 .Rtable td { padding-left: 0.5em; padding-right: 0.5em; border-width: 0; } A: Drug X B: Placebo C: Combination   (N=134) (N=134) (N=132) Subjects with serious adverse events 89 (66.42%) 123 (91.79%) 88 (66.67%) Number of censored subjects        Clinical Cut Off 10 (7.46%) 4 (2.99%) 14 (10.61%)  Completion or Discontinuation 13 (9.70%) 3 (2.24%) 16 (12.12%)  End of AE Reporting Period 22 (16.42%) 4 (2.99%) 14 (10.61%) Hazard ratio   1.5 1.1 95% confidence interval   (1.1, 1.9) (0.8, 1.5) p-value (one-sided stratified log rank)   0.0208 0.4619 Time to first serious adverse event        Median (years) 0.39 0.37 0.26  95% confidence interval [0.23, 0.60] [0.25, 0.46] [0.18, 0.34]  Min, Max 0.00, 3.00 0.00, 3.00 0.00, 3.00 4.4.7 tidytlg Code resetSession(.kmState) library(dplyr) library(tidytlg) library(broom) library(stringr) # Create analysis population counts tbl1 &lt;- freq(adtte, rowvar = &quot;SAFFL&quot;, colvar = &quot;TRT01A&quot;, statlist = statlist(&quot;n&quot;), rowtext = &quot;Analysis Set: Safety Population&quot;, subset = SAFFL == &quot;Y&quot;) # Create counts (percentages) for subjects with SAE tbl2 &lt;- freq(adtte, rowvar = &quot;CNSR&quot;, colvar = &quot;TRT01A&quot;, statlist = statlist(&quot;n (x.x%)&quot;), rowtext = &quot;Number of subjects with serious adverse events, n(%)&quot;, subset = CNSR == 0) # Create counts (percentages) for subjects with SAE tbl3a &lt;- freq(adtte, rowvar = &quot;CNSR&quot;, colvar = &quot;TRT01A&quot;, statlist = statlist(&quot;n (x.x%)&quot;), rowtext = &quot;Number of censored subjects, n(%)&quot;, subset = CNSR == 1) tbl3b &lt;- freq(adtte, rowvar = &quot;CNSDTDSC&quot;, colvar = &quot;TRT01A&quot;, statlist = statlist(&quot;n (x.x%)&quot;), subset = CNSR == 1) tbl3 &lt;- bind_rows(tbl3a, tbl3b) # CoxPH model coxmod &lt;- tidy(cph, exponentiate = TRUE, conf.int = TRUE, conf.level = 0.95) %&gt;% filter(str_detect(term, &quot;TRT01A&quot;)) %&gt;% mutate(term = str_remove(term, &quot;TRT01A&quot;)) tbl4a &lt;- coxmod %&gt;% mutate(hr = roundSAS(estimate, digits = 2, as_char = TRUE)) %&gt;% select(term, hr) %&gt;% pivot_wider(names_from = &quot;term&quot;, values_from = &quot;hr&quot;) %&gt;% mutate(label = &quot;Hazard ratio&quot;, row_type = &quot;HEADER&quot;) tbl4b &lt;- coxmod %&gt;% mutate(across(c(conf.low, conf.high), ~roundSAS(.x, digits = 2)), ci = paste0(&quot;(&quot;, conf.low, &quot;, &quot;, conf.high, &quot;)&quot;)) %&gt;% select(term, ci) %&gt;% pivot_wider(names_from = &quot;term&quot;, values_from = &quot;ci&quot;) %&gt;% mutate(label = &quot;95% Confidence Interval&quot;, row_type = &quot;VALUE&quot;) tbl4 &lt;- bind_rows(tbl4a, tbl4b) %&gt;% mutate(group_level = 0) # Logrank test log_rank_test &lt;- purrr::map_df(.x = list(c(&quot;A: Drug X&quot;, &quot;B: Placebo&quot;), c(&quot;A: Drug X&quot;, &quot;C: Combination&quot;)), .f = ~{sdf &lt;- survdiff(Surv(AVAL, CNSR==0) ~ TRT01A + STRATA1, data = adtte %&gt;% dplyr::filter(TRT01A %in% .x)); data.frame(TRT01A = .x[2], pval = (1-pchisq(sdf$chisq, length(sdf$n)-1))/2)}) tbl5 &lt;- log_rank_test %&gt;% mutate(pval = roundSAS(pval, digits = 3, as_char = TRUE)) %&gt;% pivot_wider(names_from = &quot;TRT01A&quot;, values_from = &quot;pval&quot;) %&gt;% mutate(label = &quot;p-value (one-sided stratified log rank)&quot;, row_type = &quot;HEADER&quot;, group_level = 0) # surv time stats tbl6a &lt;- surv_tbl %&gt;% mutate(median = roundSAS(median, digits = 2, as_char = TRUE)) %&gt;% select(TRT01A, median) %&gt;% pivot_wider(names_from = &quot;TRT01A&quot;, values_from = &quot;median&quot;) %&gt;% mutate(label = &quot;Median (years)&quot;, row_type = &quot;VALUE&quot;) %&gt;% add_row(label = &quot;Time to first serious adverse event (1)&quot;, row_type = &quot;HEADER&quot;, .before = 1) tbl6b &lt;- surv_tbl %&gt;% mutate(across(c(`0.95LCL`, `0.95UCL`), ~roundSAS(.x, digits = 2, as_char = TRUE)), ci = paste0(&quot;(&quot;, `0.95LCL`, &quot;, &quot;, `0.95UCL`, &quot;)&quot;)) %&gt;% select(TRT01A, ci) %&gt;% pivot_wider(names_from = &quot;TRT01A&quot;, values_from = &quot;ci&quot;) %&gt;% mutate(label = &quot;95% Confidence Interval&quot;, row_type = &quot;VALUE&quot;) tbl6c &lt;- adtte %&gt;% filter(!(AVAL == 0 &amp; CNSR == 1)) %&gt;% group_by(TRT01A) %&gt;% mutate(max_cnsr = !is.na(AVAL) &amp; AVAL == max(AVAL, na.rm = TRUE) &amp; CNSR == 1) %&gt;% summarise( min = min(AVAL, na.rm = TRUE), max = max(AVAL, na.rm = TRUE), is_censored = sum(max_cnsr) &gt; 0) %&gt;% mutate(across(c(min, max), ~roundSAS(.x, digits = 2, as_char = TRUE)), min_max = ifelse(is_censored, paste0(&quot;(&quot;, min, &quot;, &quot;, max, &quot;*)&quot;), paste0(&quot;(&quot;, min, &quot;, &quot;, max, &quot;)&quot;))) %&gt;% select(TRT01A, min_max) %&gt;% pivot_wider(names_from = &quot;TRT01A&quot;, values_from = &quot;min_max&quot;) %&gt;% mutate(label = &quot;Min - Max (2)&quot;, row_type = &quot;VALUE&quot;) tbl6 &lt;- bind_rows(tbl6a, tbl6b, tbl6c) %&gt;% mutate(group_level = 0) # combine analysis results together tbl &lt;- bind_table(tbl1, tbl2, tbl3, tbl4, tbl5, tbl6) # output the analysis results gentlg(huxme = tbl, format = &quot;HTML&quot;, print.hux = FALSE, file = &quot;Table x.x.x.x&quot;, orientation = &quot;portrait&quot;, title = &quot;Time to First Serious Adverse Event&quot;, footers = c(&quot;(1) Product-limit (Kaplan-Meier) estimates.&quot;, &quot;(2) * indicates censoring&quot;, &quot;Serious adverse events are defines as (...). All p-values are exploratory.&quot;, &quot;Hazard ratios are from a stratified Cox model of serious adverse event hazard rate, with terms for treatment groups and strata1. Ties were handled using the exact method. Hazard ratios of Placebo Combination over Drug X are presented, an HR &lt; 1 denotes improvement compared to Drug X.&quot;, &quot;Source: ADTTE DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY&quot;), colheader = c(&quot;&quot;,&quot;A: Drug X&quot;,&quot;B: Placebo&quot;,&quot;C: Combination&quot;)) Table 4.3: Table x.x.x.x: &emsp; Time to First Serious Adverse Event A: Drug X B: Placebo C: Combination Analysis Set: Safety Population134134132 Number of subjects with serious adverse events, n(%)89 (66.4%)123 (91.8%)88 (66.7%) Number of censored subjects, n(%)45 (33.6%)11 (8.2%)44 (33.3%) Clinical Cut Off10 (7.5%)4 (3.0%)14 (10.6%) Completion or Discontinuation13 (9.7%)3 (2.2%)16 (12.1%) End of AE Reporting Period22 (16.4%)4 (3.0%)14 (10.6%) Hazard ratio1.461.09 95% Confidence Interval(1.11, 1.92)(0.81, 1.47) p-value (one-sided stratified log rank)0.0210.462 Time to first serious adverse event (1) Median (years)0.390.370.26 95% Confidence Interval(0.23, 0.60)(0.25, 0.46)(0.18, 0.34) Min - Max (2)(0.00, 3.00*)(0.01, 3.00*)(0.00, 3.00*) (1) Product-limit (Kaplan-Meier) estimates. (2) * indicates censoring Serious adverse events are defines as (...). All p-values are exploratory. Hazard ratios are from a stratified Cox model of serious adverse event hazard rate, with terms for treatment groups and strata1. Ties were handled using the exact method. Hazard ratios of Placebo Combination over Drug X are presented, an HR Source: ADTTE DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY [table x.x.x.x.html][/home/runner/work/_temp/b12862b4-488c-4339-87f9-9fc499992f88] 21MAR2023, 12:57 4.4.8 tfrmt This first chuck is clean up the data from the models to prepare it for going into a table. Code library(tidyverse) library(broom) big_n &lt;- surv_tbl |&gt; dplyr::select(N = n.max, TRT01A) # Number of subjects with a serious AE sae_n &lt;- surv_tbl |&gt; # Calculated above dplyr::mutate(pct = events/n.max, group = &quot;Number of subjects with serious adverse event, n (%)&quot;, label = &quot;Number of subjects with serious adverse event, n (%)&quot;, ord1 = 1 ) |&gt; dplyr::select(TRT01A, n = events, pct, group, label, ord1) |&gt; tidyr::pivot_longer(c(&quot;n&quot;, &quot;pct&quot;)) # Count the number of censored subjects adtte_with_N &lt;- adtte |&gt; dplyr::left_join(big_n, by = &quot;TRT01A&quot;) cnsr_subjs &lt;- adtte_with_N |&gt; dplyr::filter(CNSR == &quot;1&quot;) tot_cnsr_subj &lt;- cnsr_subjs |&gt; dplyr::group_by(TRT01A) |&gt; dplyr::reframe( n = n_distinct(USUBJID), pct = n/N ) |&gt; dplyr::distinct() |&gt; tidyr::pivot_longer(c(&quot;n&quot;, &quot;pct&quot;)) |&gt; dplyr::mutate( group = &quot;Number of censored subjects, n (%)&quot;, label = &quot;Number of censored subjects, n (%)&quot;, ord1 = 2 ) sub_cnsr_subj &lt;- cnsr_subjs |&gt; dplyr::group_by(TRT01A, CNSDTDSC) |&gt; dplyr::reframe( n = n_distinct(USUBJID), pct = n/N ) |&gt; dplyr::distinct() |&gt; tidyr::pivot_longer(c(&quot;n&quot;, &quot;pct&quot;)) |&gt; dplyr::mutate( group = &quot;Number of censored subjects, n (%)&quot;, ord1 = 2 ) |&gt; dplyr::rename(label = CNSDTDSC) # Information from the CPH model hzr &lt;- broom::tidy(cph, conf.int = TRUE) |&gt; mutate(across(c(&quot;estimate&quot;, &quot;conf.low&quot;, &quot;conf.high&quot;), exp)) |&gt; dplyr::filter(stringr::str_detect(term, &quot;TRT01A&quot;)) |&gt; dplyr::select(term, estimate, conf.low, conf.high) |&gt; tidyr::pivot_longer(c(&quot;estimate&quot;, &quot;conf.low&quot;, &quot;conf.high&quot;)) |&gt; dplyr::mutate(group = &quot;Hazard ratio&quot;, label = case_when( name == &quot;estimate&quot; ~ &quot;Hazard ratio&quot;, TRUE ~ &quot;95% confidence interval&quot; ), TRT01A = case_when( stringr::str_detect(term, &quot;Placebo&quot;) ~ &quot;B: Placebo&quot;, stringr::str_detect(term, &quot;Combination&quot;) ~ &quot;C: Combination&quot; ), ord1 = 3) |&gt; dplyr::select(-term) # Get one-sided p-value from survival model p_vals &lt;- list(c(&quot;A: Drug X&quot;, &quot;B: Placebo&quot;), c(&quot;A: Drug X&quot;, &quot;C: Combination&quot;)) |&gt; map_dfr(function(comparison){ survdiff(Surv(AVAL, CNSR == 0) ~ TRT01A + STRATA1, data = adtte |&gt; dplyr::filter(TRT01A %in% comparison)) |&gt; broom::glance() |&gt; dplyr::mutate(TRT01A = comparison[2]) }) |&gt; dplyr::select(value = p.value, TRT01A) |&gt; dplyr::mutate( name = &quot;p.value&quot;, group = &quot;p-value (one-sided stratified log rank)&quot;, label = &quot;p-value (one-sided stratified log rank)&quot;, ord1 = 5 ) # Time to event from model time_to_event &lt;- surv_tbl |&gt; dplyr::select(TRT01A, median, LCL = `0.95LCL`, UCL=`0.95UCL`) |&gt; tidyr::pivot_longer(c(&quot;median&quot;, &quot;LCL&quot;, &quot;UCL&quot;)) |&gt; dplyr::mutate( group = &quot;Time to first serious adverse event&quot;, label = case_when( name == &quot;median&quot; ~ &quot;Median (years)&quot;, TRUE ~ &quot;95% confidence interval&quot; ), ord1 = 6 ) range &lt;- adtte |&gt; dplyr::group_by(TRT01A) |&gt; dplyr::summarise( min = min(AVAL), max = max(AVAL) ) |&gt; dplyr::mutate(group = &quot;Time to first serious adverse event&quot;, label = &quot;Min, Max&quot;, ord1 = 6)|&gt; tidyr::pivot_longer(c(&quot;min&quot;, &quot;max&quot;)) model_ard &lt;- bind_rows( sae_n, tot_cnsr_subj, sub_cnsr_subj, hzr, p_vals, time_to_event, range ) Now time to format this information into a table Code library(tfrmt) tfrmt( column = TRT01A, group = &quot;group&quot;, label = &quot;label&quot;, param = &quot;name&quot;, value = &quot;value&quot;, sorting_cols = &quot;ord1&quot;, body_plan = body_plan( frmt_structure(group_val = &quot;.default&quot;, label_val = &quot;.default&quot;, frmt_combine(&quot;{n} ({pct})&quot;, n = frmt(&quot;xx&quot;), pct = frmt(&quot;xx%&quot;, transform = ~.*100)) ), frmt_structure(group_val = &quot;Hazard ratio&quot;, label_val = &quot;.default&quot;, frmt_combine(&quot;[{conf.low}, {conf.high}]&quot;, frmt(&quot;x.x&quot;))), frmt_structure(group_val = &quot;.default&quot;, label_val = &quot;Hazard ratio&quot;, frmt(&quot;x.x&quot;)), frmt_structure(group_val = &quot;.default&quot;, label_val = &quot;p-value (one-sided stratified log rank)&quot;, frmt(&quot;x.xxxx&quot;)), frmt_structure(group_val = &quot;.default&quot;, label_val = &quot;Median (years)&quot;, frmt(&quot;x.xx&quot;)), frmt_structure(group_val = &quot;Time to first serious adverse event&quot;, label_val = &quot;95% confidence interval&quot;, frmt_combine(&quot;[{LCL}, {UCL}]&quot;, frmt(&quot;x.xx&quot;))), frmt_structure(group_val = &quot;.default&quot;, label_val = &quot;Min, Max&quot;, frmt_combine(&quot;[{min}, {max}*]&quot;, frmt(&quot;x.xx&quot;))) ), col_plan = col_plan(-ord1), footnote_plan = footnote_plan( footnote_structure(&quot;Serious adverse events are defines as (...). All p-values are exploratory. Hazard ratios are from a stratified Cox model of serious adverse event hazard rate, with terms for treatment groups and strata1. Ties were handled using the exact method. Hazard ratios of Placebo/ Combination over Drug X are presented, a HR &lt; 1 denotes improvement compared to Drug X.&quot;), footnote_structure(group_val = &quot;Time to first serious adverse event&quot;, &quot;Product-limit (Kaplan-Meier) estimates&quot;), footnote_structure(group_val = &quot;Time to first serious adverse event&quot;, label_val = &quot;Min, Max&quot;, &quot;Minimum and maximum of event times. * Denotes censoring&quot;) ) ) |&gt; print_to_gt(model_ard) html { font-family: Courier, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #jvlronoygg .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 14px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #jvlronoygg .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #jvlronoygg .gt_caption { padding-top: 4px; padding-bottom: 4px; } #jvlronoygg .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #jvlronoygg .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #jvlronoygg .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #jvlronoygg .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #jvlronoygg .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #jvlronoygg .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #jvlronoygg .gt_column_spanner_outer:first-child { padding-left: 0; } #jvlronoygg .gt_column_spanner_outer:last-child { padding-right: 0; } #jvlronoygg .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #jvlronoygg .gt_group_heading { padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: rgba(255, 255, 255, 0); border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: rgba(255, 255, 255, 0); border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #jvlronoygg .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: rgba(255, 255, 255, 0); border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: rgba(255, 255, 255, 0); vertical-align: middle; } #jvlronoygg .gt_from_md > :first-child { margin-top: 0; } #jvlronoygg .gt_from_md > :last-child { margin-bottom: 0; } #jvlronoygg .gt_row { padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #jvlronoygg .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: rgba(255, 255, 255, 0); padding-left: 5px; padding-right: 5px; } #jvlronoygg .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: rgba(255, 255, 255, 0); padding-left: 5px; padding-right: 5px; vertical-align: top; } #jvlronoygg .gt_row_group_first td { border-top-width: 2px; } #jvlronoygg .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; } #jvlronoygg .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #jvlronoygg .gt_first_summary_row.thick { border-top-width: 2px; } #jvlronoygg .gt_last_summary_row { padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #jvlronoygg .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; } #jvlronoygg .gt_first_grand_summary_row { padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #jvlronoygg .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #jvlronoygg .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #jvlronoygg .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #jvlronoygg .gt_footnote { margin: 0px; font-size: 90%; padding-left: 1px; padding-right: 1px; padding-left: 5px; padding-right: 5px; } #jvlronoygg .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #jvlronoygg .gt_sourcenote { font-size: 90%; padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; } #jvlronoygg .gt_left { text-align: left; } #jvlronoygg .gt_center { text-align: center; } #jvlronoygg .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #jvlronoygg .gt_font_normal { font-weight: normal; } #jvlronoygg .gt_font_bold { font-weight: bold; } #jvlronoygg .gt_font_italic { font-style: italic; } #jvlronoygg .gt_super { font-size: 65%; } #jvlronoygg .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 75%; vertical-align: 0.4em; } #jvlronoygg .gt_asterisk { font-size: 100%; vertical-align: 0; } #jvlronoygg .gt_indent_1 { text-indent: 5px; } #jvlronoygg .gt_indent_2 { text-indent: 10px; } #jvlronoygg .gt_indent_3 { text-indent: 15px; } #jvlronoygg .gt_indent_4 { text-indent: 20px; } #jvlronoygg .gt_indent_5 { text-indent: 25px; } A: Drug X B: Placebo C: Combination Number of subjects with serious adverse event, n (%) 89 (66%) 123 (92%) 88 (67%) Number of censored subjects, n (%) 45 (34%) 11 ( 8%) 44 (33%) Clinical Cut Off 10 ( 7%) 4 ( 3%) 14 (11%) Completion or Discontinuation 13 (10%) 3 ( 2%) 16 (12%) End of AE Reporting Period 22 (16%) 4 ( 3%) 14 (11%) Hazard ratio 1.5 1.1 95% confidence interval [1.1, 1.9] [0.8, 1.5] p-value (one-sided stratified log rank) 0.0416 0.9239 Time to first serious adverse event1 Median (years) 0.39 0.37 0.26 95% confidence interval [0.23, 0.60] [0.25, 0.46] [0.18, 0.34] Min, Max2 [0.00, 3.00*] [0.01, 3.00*] [0.00, 3.00*] Serious adverse events are defines as (...). All p-values are exploratory. Hazard ratios are from a stratified Cox model of serious adverse event hazard rate, with terms for treatment groups and strata1. Ties were handled using the exact method. Hazard ratios of Placebo/ Combination over Drug X are presented, a HR &lt; 1 denotes improvement compared to Drug X. 1 Product-limit (Kaplan-Meier) estimates 2 Minimum and maximum of event times. * Denotes censoring 4.5 Concomitant Medications 4.5.1 rtables Code resetSession() library(rtables) data(&quot;cadcm&quot;, package = &quot;random.cdisc.data&quot;) data(&quot;cadsl&quot;, package = &quot;random.cdisc.data&quot;) one_count_pct_gen &lt;- function(label = NULL) { function(x, .N_col) { ret &lt;- rcell(length(unique(x)) * c(1, 1/.N_col), format = &quot;xx (xx.x%)&quot;) if(!is.null(label)) obj_label(ret) &lt;- label ret } } lyt &lt;- basic_table(title = &quot;Conmed Example&quot;, subtitles = &quot;Uses the adcm dataset from random.cdisc.data&quot;, show_colcounts = TRUE) %&gt;% split_cols_by(&quot;ARM&quot;) %&gt;% analyze(&quot;USUBJID&quot;, afun = one_count_pct_gen(&quot;At Least One Concomittant Med&quot;)) %&gt;% split_rows_by(&quot;CMCLAS&quot;, split_fun = trim_levels_in_group(&quot;CMTRT&quot;)) %&gt;% analyze(&quot;CMTRT&quot;, afun = function(df, .N_col) { cmtrtvec &lt;- df$CMTRT spl_usubj &lt;- split(df$USUBJID, cmtrtvec) fn &lt;- one_count_pct_gen() cells &lt;- lapply(spl_usubj, fn, .N_col = .N_col) names(cells) &lt;- names(spl_usubj) in_rows(.list = cells) }) build_table(lyt, cadcm, alt_counts_df = cadsl) Conmed Example Uses the adcm dataset from random.cdisc.data —————————————————————————————————————————————————————————————————————————— A: Drug X B: Placebo C: Combination (N=134) (N=134) (N=132) —————————————————————————————————————————————————————————————————————————— At Least One Concomittant Med 122 (91.0%) 123 (91.8%) 120 (90.9%) medcl A A_1/3 54 (40.3%) 49 (36.6%) 69 (52.3%) A_2/3 53 (39.6%) 50 (37.3%) 56 (42.4%) A_3/3 45 (33.6%) 54 (40.3%) 48 (36.4%) medcl B B_1/4 52 (38.8%) 57 (42.5%) 59 (44.7%) B_2/4 52 (38.8%) 55 (41.0%) 56 (42.4%) B_3/4 47 (35.1%) 47 (35.1%) 52 (39.4%) B_4/4 50 (37.3%) 45 (33.6%) 55 (41.7%) medcl C C_1/2 51 (38.1%) 50 (37.3%) 56 (42.4%) C_2/2 52 (38.8%) 58 (43.3%) 60 (45.5%) 4.5.2 gt Code resetSession() library(dplyr) library(tidyr) library(gt) data(&quot;cadcm&quot;, package = &quot;random.cdisc.data&quot;) data(&quot;cadsl&quot;, package = &quot;random.cdisc.data&quot;) cmdecod_levels &lt;- c(&quot;Number of sujects with any concomitant medication&quot;, levels(cadcm$CMDECOD)) cmclas_levels &lt;- c(NA, levels(cadcm$CMCLAS)) adcm &lt;- cadcm |&gt; select(CMDECOD, CMCLAS, TRT01A) |&gt; mutate( CMDECOD = factor(CMDECOD, levels = cmdecod_levels), CMCLAS = factor(CMCLAS, levels = cmclas_levels) ) ct_cm &lt;- dplyr::group_by(cadcm, TRT01A) |&gt; dplyr::summarize(n = dplyr::n_distinct(USUBJID)) |&gt; dplyr::left_join(count(cadsl, TRT01A, name = &quot;nall&quot;), by = &quot;TRT01A&quot;) |&gt; dplyr::mutate(pct = n / nall, nall = NULL, CMDECOD = factor(&quot;Number of sujects with any concomitant medication&quot;, levels = cmdecod_levels)) ct_adcm &lt;- dplyr::group_by(cadcm, TRT01A, CMCLAS, CMDECOD) |&gt; dplyr::summarize(n = dplyr::n_distinct(USUBJID), .groups = &quot;drop&quot;) |&gt; dplyr::left_join(count(cadsl, TRT01A, name = &quot;nall&quot;), by = &quot;TRT01A&quot;) |&gt; dplyr::mutate(pct = n / nall, nall = NULL) gt_adcm &lt;- dplyr::bind_rows(ct_cm, ct_adcm) |&gt; tidyr::pivot_wider(id_cols = c(CMCLAS, CMDECOD), names_from = TRT01A, values_from = c(n, pct)) trt_n &lt;- cadsl |&gt; dplyr::filter(SAFFL == &quot;Y&quot;) |&gt; dplyr::group_by(TRT01A) |&gt; dplyr::summarize(n = sprintf(&quot;%s \\nN=%i (100%%)&quot;, unique(TRT01A), dplyr::n()), .groups = &quot;drop&quot;) tab_n &lt;- dplyr::pull(trt_n, n) |&gt; as.list() names(tab_n) &lt;- paste(&quot;n&quot;, dplyr::pull(trt_n, TRT01A), sep = &quot;_&quot;) gt_adcm |&gt; gt(rowname_col = &quot;CMDECOD&quot;) |&gt; tab_header( title = &quot;Conmed Example&quot;, subtitle = md(&quot;Uses the *adcm* dataset from **random.cdisc.data**&quot;) ) |&gt; opt_align_table_header(align = &quot;left&quot;) |&gt; fmt_percent(columns = dplyr::starts_with(&quot;pct_&quot;), decimals = 1) |&gt; cols_merge_n_pct(col_n = &quot;n_A: Drug X&quot;, col_pct = &quot;pct_A: Drug X&quot;) |&gt; cols_merge_n_pct(col_n = &quot;n_B: Placebo&quot;, col_pct = &quot;pct_B: Placebo&quot;) |&gt; cols_merge_n_pct(col_n = &quot;n_C: Combination&quot;, col_pct = &quot;pct_C: Combination&quot;) |&gt; tab_row_group( label = &quot;medcl A&quot;, rows = CMCLAS == &quot;medcl A&quot; ) |&gt; tab_row_group( label = &quot;medcl B&quot;, rows = CMCLAS == &quot;medcl B&quot; ) |&gt; tab_row_group( label = &quot;medcl C&quot;, rows = CMCLAS == &quot;medcl C&quot; ) |&gt; row_group_order( groups = c(NA, paste(&quot;medcl&quot;, LETTERS[1:2])) ) |&gt; cols_hide(CMCLAS) |&gt; cols_label( `n_A: Drug X` = md(tab_n[[1]]), `n_B: Placebo` = md(tab_n[[2]]), `n_C: Combination` = md(tab_n[[3]]) ) |&gt; cols_width( 1 ~ px(500), everything() ~ px(150) ) |&gt; cols_align( align = &quot;center&quot;, columns = everything() ) |&gt; cols_align( align = &quot;left&quot;, columns = 1 ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #biwztcecuw .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #biwztcecuw .gt_heading { background-color: #FFFFFF; text-align: left; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #biwztcecuw .gt_caption { padding-top: 4px; padding-bottom: 4px; } #biwztcecuw .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #biwztcecuw .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #biwztcecuw .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #biwztcecuw .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #biwztcecuw .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #biwztcecuw .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #biwztcecuw .gt_column_spanner_outer:first-child { padding-left: 0; } #biwztcecuw .gt_column_spanner_outer:last-child { padding-right: 0; } #biwztcecuw .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #biwztcecuw .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #biwztcecuw .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #biwztcecuw .gt_from_md > :first-child { margin-top: 0; } #biwztcecuw .gt_from_md > :last-child { margin-bottom: 0; } #biwztcecuw .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #biwztcecuw .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; } #biwztcecuw .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; } #biwztcecuw .gt_row_group_first td { border-top-width: 2px; } #biwztcecuw .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #biwztcecuw .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #biwztcecuw .gt_first_summary_row.thick { border-top-width: 2px; } #biwztcecuw .gt_last_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #biwztcecuw .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #biwztcecuw .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #biwztcecuw .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #biwztcecuw .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #biwztcecuw .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #biwztcecuw .gt_footnote { margin: 0px; font-size: 90%; padding-left: 4px; padding-right: 4px; padding-left: 5px; padding-right: 5px; } #biwztcecuw .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #biwztcecuw .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #biwztcecuw .gt_left { text-align: left; } #biwztcecuw .gt_center { text-align: center; } #biwztcecuw .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #biwztcecuw .gt_font_normal { font-weight: normal; } #biwztcecuw .gt_font_bold { font-weight: bold; } #biwztcecuw .gt_font_italic { font-style: italic; } #biwztcecuw .gt_super { font-size: 65%; } #biwztcecuw .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 75%; vertical-align: 0.4em; } #biwztcecuw .gt_asterisk { font-size: 100%; vertical-align: 0; } #biwztcecuw .gt_indent_1 { text-indent: 5px; } #biwztcecuw .gt_indent_2 { text-indent: 10px; } #biwztcecuw .gt_indent_3 { text-indent: 15px; } #biwztcecuw .gt_indent_4 { text-indent: 20px; } #biwztcecuw .gt_indent_5 { text-indent: 25px; } Conmed Example Uses the adcm dataset from random.cdisc.data A: Drug X N=134 (100%) B: Placebo N=134 (100%) C: Combination N=132 (100%) Number of sujects with any concomitant medication 122 (91.0%) 123 (91.8%) 120 (90.9%) medcl A medname A_1/3 54 (40.3%) 49 (36.6%) 69 (52.3%) medname A_2/3 53 (39.6%) 50 (37.3%) 56 (42.4%) medname A_3/3 45 (33.6%) 54 (40.3%) 48 (36.4%) medcl B medname B_1/4 52 (38.8%) 57 (42.5%) 59 (44.7%) medname B_2/4 52 (38.8%) 55 (41.0%) 56 (42.4%) medname B_3/4 47 (35.1%) 47 (35.1%) 52 (39.4%) medname B_4/4 50 (37.3%) 45 (33.6%) 55 (41.7%) medcl C medname C_1/2 51 (38.1%) 50 (37.3%) 56 (42.4%) medname C_2/2 52 (38.8%) 58 (43.3%) 60 (45.5%) 4.5.3 flextable Code resetSession() library(flextable) library(dplyr) library(forcats) data(&quot;cadcm&quot;, package = &quot;random.cdisc.data&quot;) data(&quot;cadsl&quot;, package = &quot;random.cdisc.data&quot;) cmdecod_levels &lt;- c(&quot;N_CM&quot;, levels(cadcm$CMDECOD)) cmclas_levels &lt;- c(&quot;N_CM&quot;, levels(cadcm$CMCLAS)) adcm &lt;- cadcm |&gt; select(CMDECOD, CMCLAS, TRT01A) |&gt; mutate( CMDECOD = factor(CMDECOD, levels = cmdecod_levels), CMCLAS = factor(CMCLAS, levels = cmclas_levels) ) trt_count &lt;- group_by(cadsl, TRT01A) |&gt; summarise(n = n()) trt_count &lt;- setNames(trt_count$n, trt_count$TRT01A) ct_cm &lt;- group_by(cadcm, TRT01A) |&gt; summarise(n = n_distinct(USUBJID)) |&gt; left_join(count(cadsl, TRT01A, name = &quot;nall&quot;), by = &quot;TRT01A&quot;) |&gt; mutate(pct = n / nall, nall = NULL, CMCLAS = factor(&quot;N_CM&quot;, levels = cmclas_levels), CMDECOD = factor(&quot;N_CM&quot;, levels = cmdecod_levels)) ct_adcm &lt;- group_by(cadcm, TRT01A, CMCLAS, CMDECOD) |&gt; summarize(n = n_distinct(USUBJID)) |&gt; ungroup() |&gt; left_join(count(cadsl, TRT01A, name = &quot;nall&quot;), by = &quot;TRT01A&quot;) |&gt; mutate(pct = n / nall, nall = NULL) dat &lt;- bind_rows(ct_cm, ct_adcm) tab &lt;- tabulator( dat, rows = c(&quot;CMCLAS&quot;, &quot;CMDECOD&quot;), columns = &quot;TRT01A&quot;, cts = as_paragraph(fmt_n_percent(n, pct))) ft &lt;- as_flextable(tab, spread_first_col = TRUE) |&gt; prepend_chunks( i = ~ is.na(CMCLAS) &amp; seq_along(CMCLAS) &gt; 1, j = 1, as_chunk(&quot;\\t&quot;) ) for(TRT01A_COD in names(trt_count)){ ft &lt;- append_chunks( x = ft, part = &quot;header&quot;, i = 1, j = tabulator_colnames(tab, columns = &quot;cts&quot;, TRT01A %in% !!TRT01A_COD), as_chunk(trt_count[TRT01A_COD], formatter = fmt_header_n) ) } ft &lt;- autofit(ft) |&gt; align(j = 1, align = &quot;left&quot;) |&gt; labelizor(part = &quot;all&quot;, j = &quot;CMDECOD&quot;, labels = c(CMDECOD=&quot;&quot;, N_CM = &quot;Number of sujects with any concomitant medication&quot;)) |&gt; hline_top(part = &quot;header&quot;, border = fp_border_default(width=2)) |&gt; set_caption(&quot;Conmed Example\\nUses the &#39;adcm&#39; dataset from &#39;random.cdisc.data&#39;&quot;) ft .cl-f2cc7f5e{}.cl-f2be6a54{font-family:'Open Sans';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f2be6a68{font-family:'Open Sans';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f2c5e6da{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-f2c5e6f8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-f2c5e702{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-f2c5e703{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-f2c5e70c{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-f2c5e716{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-f2c5e717{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-f2c60aca{width:1.782in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 2pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2c60ade{width:0.1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 2pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2c60adf{width:0.957in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 2pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2c60ae8{width:1.206in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 2pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2c60afc{width:1.782in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2c60b06{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2c60b10{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2c60b11{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2c60b1a{width:1.782in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2c60b24{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2c60b38{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2c60b39{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2c60b42{width:1.782in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2c60b43{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2c60b4c{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2c60b56{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2c60b60{width:1.782in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2c60b6a{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f2c60b74{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;} Table 4.4: Conmed Example Uses the ‘adcm’ dataset from ‘random.cdisc.data’ A: Drug X(N=134)B: Placebo(N=134)C: Combination(N=132)Number of sujects with any concomitant medication122 (91.0%)123 (91.8%)120 (90.9%)medcl A&emsp;medname A_1/354 (40.3%)49 (36.6%)69 (52.3%)&emsp;medname A_2/353 (39.6%)50 (37.3%)56 (42.4%)&emsp;medname A_3/345 (33.6%)54 (40.3%)48 (36.4%)medcl B&emsp;medname B_1/452 (38.8%)57 (42.5%)59 (44.7%)&emsp;medname B_2/452 (38.8%)55 (41.0%)56 (42.4%)&emsp;medname B_3/447 (35.1%)47 (35.1%)52 (39.4%)&emsp;medname B_4/450 (37.3%)45 (33.6%)55 (41.7%)medcl C&emsp;medname C_1/251 (38.1%)50 (37.3%)56 (42.4%)&emsp;medname C_2/252 (38.8%)58 (43.3%)60 (45.5%) 4.5.4 tables Code resetSession() data(&quot;cadcm&quot;, package = &quot;random.cdisc.data&quot;) library(tables) table_options(doCSS = TRUE) subject_counts &lt;- table(adsl$ARM) countpercentid &lt;- function(num, ARM) { n &lt;- length(unique(num)) sprintf(&quot;%d (%.2f%%)&quot;, length(unique(num)), 100*n/subject_counts[ARM[1]]) } count &lt;- function(x) sprintf(&quot;(N=%d)&quot;, length(x)) heading &lt;- tabular(Heading(&quot;&quot;)*1*Heading(&quot;&quot;)*count ~ Heading()*ARM, data = adsl) body &lt;- tabular( (Heading(&quot;Any concomitant medication&quot;)*1*Heading(&quot;&quot;)*1 + Heading()*CMCLAS* Heading()*CMDECOD*DropEmpty())* Heading()*countpercentid*Arguments(ARM = TRT01A)* Heading()*USUBJID ~ Heading()*TRT01A, data = cadcm) useGroupLabels(rbind(heading, body), indent = &quot;&amp;emsp;&quot;) #table3ebb6b381ecc .Rtable thead, .Rtable .even { background-color: inherit; } #table3ebb6b381ecc .left { text-align:left; } #table3ebb6b381ecc .center { text-align:center; } #table3ebb6b381ecc .right { text-align:right; } #table3ebb6b381ecc .Rtable, #table3ebb6b381ecc .Rtable thead { border-collapse: collapse; border-style: solid; border-width: medium 0; border-color: inherit; } #table3ebb6b381ecc .Rtable th, #table3ebb6b381ecc .Rtable td { padding-left: 0.5em; padding-right: 0.5em; border-width: 0; } A: Drug X B: Placebo C: Combination   (N=134) (N=134) (N=132) Any concomitant medication 122 (91.04%) 123 (91.79%) 120 (90.91%) medcl A        medname A_1/3 54 (40.30%) 49 (36.57%) 69 (52.27%)  medname A_2/3 53 (39.55%) 50 (37.31%) 56 (42.42%)  medname A_3/3 45 (33.58%) 54 (40.30%) 48 (36.36%) medcl B        medname B_1/4 52 (38.81%) 57 (42.54%) 59 (44.70%)  medname B_2/4 52 (38.81%) 55 (41.04%) 56 (42.42%)  medname B_3/4 47 (35.07%) 47 (35.07%) 52 (39.39%)  medname B_4/4 50 (37.31%) 45 (33.58%) 55 (41.67%) medcl C        medname C_1/2 51 (38.06%) 50 (37.31%) 56 (42.42%)  medname C_2/2 52 (38.81%) 58 (43.28%) 60 (45.45%) 4.5.5 tidytlg Code resetSession() library(dplyr) library(tidytlg) data(&quot;cadcm&quot;, package = &quot;random.cdisc.data&quot;) data(&quot;cadsl&quot;, package = &quot;random.cdisc.data&quot;) adsl &lt;- cadsl adcm &lt;- cadcm %&gt;% filter(SAFFL == &quot;Y&quot;) %&gt;% mutate(CMFL = &quot;Y&quot;) # Create analysis population counts tbl1 &lt;- freq(adsl, rowvar = &quot;SAFFL&quot;, colvar = &quot;ARM&quot;, statlist = statlist(&quot;n&quot;), rowtext = &quot;Analysis Set: Safety Population&quot;, subset = SAFFL == &quot;Y&quot;) # Create counts (percentages) for patients with any ConMed tbl2 &lt;- freq(adcm, denom_df = adsl, rowvar = &quot;CMFL&quot;, colvar = &quot;ARM&quot;, statlist = statlist(&quot;n (x.x%)&quot;), rowtext = &quot;Number of subjects with any concomitant medication&quot;, subset = CMFL == &quot;Y&quot;) # Create counts (percentages) by CMCLAS and CMDECOD tbl3 &lt;- nested_freq(adcm, denom_df = adsl, rowvar = &quot;CMCLAS*CMDECOD&quot;, colvar = &quot;ARM&quot;, statlist = statlist(&quot;n (x.x%)&quot;)) # combine analysis results together tbl &lt;- bind_table(tbl1, tbl2, tbl3) %&gt;% select(-CMCLAS) # output the analysis results gentlg(huxme = tbl, format = &quot;HTML&quot;, print.hux = FALSE, file = &quot;Table x.x.x.x&quot;, orientation = &quot;portrait&quot;, title = &quot;Conmed Example Uses the ‘adcm’ dataset from ‘random.cdisc.data’&quot;, colheader = c(&quot;&quot;,&quot;A: Drug X&quot;,&quot;B: Placebo&quot;,&quot;C: Combination&quot;)) Table 4.5: Table x.x.x.x: &emsp; Conmed Example Uses the ‘adcm’ dataset from ‘random.cdisc.data’ A: Drug X B: Placebo C: Combination Analysis Set: Safety Population134134132 Number of subjects with any concomitant medication122 (91.0%)123 (91.8%)120 (90.9%) medcl A97 (72.4%)98 (73.1%)102 (77.3%) medname A_1/354 (40.3%)49 (36.6%)69 (52.3%) medname A_2/353 (39.6%)50 (37.3%)56 (42.4%) medname A_3/345 (33.6%)54 (40.3%)48 (36.4%) medcl B102 (76.1%)101 (75.4%)108 (81.8%) medname B_1/452 (38.8%)57 (42.5%)59 (44.7%) medname B_2/452 (38.8%)55 (41.0%)56 (42.4%) medname B_3/447 (35.1%)47 (35.1%)52 (39.4%) medname B_4/450 (37.3%)45 (33.6%)55 (41.7%) medcl C82 (61.2%)84 (62.7%)89 (67.4%) medname C_1/251 (38.1%)50 (37.3%)56 (42.4%) medname C_2/252 (38.8%)58 (43.3%)60 (45.5%) [table x.x.x.x.html][/home/runner/work/_temp/b12862b4-488c-4339-87f9-9fc499992f88] 21MAR2023, 12:57 4.5.6 tfrmt Rather than starting with an ADaM, {tfrmt} assumes users will start with an ARD (Analysis Results Dataset), because of this, making this table will be split into two parts, first to make the ARD and second to format the table. Code resetSession() library(tidyverse) library(tfrmt) ## Create ARD data(&quot;cadcm&quot;, package = &quot;random.cdisc.data&quot;) data(&quot;cadsl&quot;, package = &quot;random.cdisc.data&quot;) big_n &lt;- cadsl |&gt; dplyr::group_by(ARM) |&gt; dplyr::summarize( N = dplyr::n_distinct(USUBJID) ) adcm_with_N &lt;- cadcm |&gt; left_join(big_n, by= &quot;ARM&quot;) overall &lt;- adcm_with_N |&gt; dplyr::group_by(ARM) |&gt; dplyr::reframe( n_subj = n_distinct(USUBJID), pct_subj = n_subj/N ) |&gt; dplyr::distinct() |&gt; dplyr::mutate(CMCLAS = &quot;At Least One Concomittant Med&quot;, CMDECOD = CMCLAS) med_lvl &lt;- adcm_with_N |&gt; dplyr::group_by(ARM,CMDECOD, CMCLAS) |&gt; dplyr::reframe( n_subj = dplyr::n_distinct(USUBJID), pct_subj = n_subj/N ) |&gt; distinct() label_N &lt;- big_n |&gt; dplyr::rename(value = N) |&gt; dplyr::mutate(name = &quot;header_n&quot;) cm_ard &lt;- bind_rows(overall, med_lvl) |&gt; pivot_longer(ends_with(&quot;subj&quot;)) |&gt; bind_rows(label_N) ## Format Table tfrmt( column = ARM, group = c(&quot;CMCLAS&quot;), param = name, value = value, label = CMDECOD, ) |&gt; # Then we cam combine it with an n percent template tfrmt_n_pct(n = &quot;n_subj&quot;, pct = &quot;pct_subj&quot;, pct_frmt_when = frmt_when(&quot;==1&quot; ~ &quot;&quot;, &quot;&gt;.99&quot; ~ &quot;(&gt;99%)&quot;, &quot;==0&quot; ~ &quot;&quot;, &quot;&lt;.01&quot; ~ &quot;(&lt;1%)&quot;, &quot;TRUE&quot; ~ frmt(&quot;(xx.x%)&quot;, transform = ~.*100)) ) |&gt; #Finally we are going to add some additional formatting tfrmt( big_n = big_n_structure(&quot;header_n&quot;), # Aligning on decimal places and spaces col_style_plan = col_style_plan( col_style_structure(col = matches(&quot;[A-Z]:.*&quot;), align = c(&quot;.&quot;, &quot; &quot;)) ) ) |&gt; print_to_gt(cm_ard) html { font-family: Courier, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #pxbuwrlnrn .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 14px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #pxbuwrlnrn .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #pxbuwrlnrn .gt_caption { padding-top: 4px; padding-bottom: 4px; } #pxbuwrlnrn .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #pxbuwrlnrn .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #pxbuwrlnrn .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #pxbuwrlnrn .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #pxbuwrlnrn .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #pxbuwrlnrn .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #pxbuwrlnrn .gt_column_spanner_outer:first-child { padding-left: 0; } #pxbuwrlnrn .gt_column_spanner_outer:last-child { padding-right: 0; } #pxbuwrlnrn .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #pxbuwrlnrn .gt_group_heading { padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: rgba(255, 255, 255, 0); border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: rgba(255, 255, 255, 0); border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #pxbuwrlnrn .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: rgba(255, 255, 255, 0); border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: rgba(255, 255, 255, 0); vertical-align: middle; } #pxbuwrlnrn .gt_from_md > :first-child { margin-top: 0; } #pxbuwrlnrn .gt_from_md > :last-child { margin-bottom: 0; } #pxbuwrlnrn .gt_row { padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #pxbuwrlnrn .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: rgba(255, 255, 255, 0); padding-left: 5px; padding-right: 5px; } #pxbuwrlnrn .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: rgba(255, 255, 255, 0); padding-left: 5px; padding-right: 5px; vertical-align: top; } #pxbuwrlnrn .gt_row_group_first td { border-top-width: 2px; } #pxbuwrlnrn .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; } #pxbuwrlnrn .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #pxbuwrlnrn .gt_first_summary_row.thick { border-top-width: 2px; } #pxbuwrlnrn .gt_last_summary_row { padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #pxbuwrlnrn .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; } #pxbuwrlnrn .gt_first_grand_summary_row { padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #pxbuwrlnrn .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #pxbuwrlnrn .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #pxbuwrlnrn .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #pxbuwrlnrn .gt_footnote { margin: 0px; font-size: 90%; padding-left: 1px; padding-right: 1px; padding-left: 5px; padding-right: 5px; } #pxbuwrlnrn .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #pxbuwrlnrn .gt_sourcenote { font-size: 90%; padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; } #pxbuwrlnrn .gt_left { text-align: left; } #pxbuwrlnrn .gt_center { text-align: center; } #pxbuwrlnrn .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #pxbuwrlnrn .gt_font_normal { font-weight: normal; } #pxbuwrlnrn .gt_font_bold { font-weight: bold; } #pxbuwrlnrn .gt_font_italic { font-style: italic; } #pxbuwrlnrn .gt_super { font-size: 65%; } #pxbuwrlnrn .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 75%; vertical-align: 0.4em; } #pxbuwrlnrn .gt_asterisk { font-size: 100%; vertical-align: 0; } #pxbuwrlnrn .gt_indent_1 { text-indent: 5px; } #pxbuwrlnrn .gt_indent_2 { text-indent: 10px; } #pxbuwrlnrn .gt_indent_3 { text-indent: 15px; } #pxbuwrlnrn .gt_indent_4 { text-indent: 20px; } #pxbuwrlnrn .gt_indent_5 { text-indent: 25px; } A: Drug X N = 134 B: Placebo N = 134 C: Combination N = 132 At Least One Concomittant Med 122 (91.0%) 123 (91.8%) 120 (90.9%) medcl A medname A_1/3 54 (40.3%) 49 (36.6%) 69 (52.3%) medname A_2/3 53 (39.6%) 50 (37.3%) 56 (42.4%) medname A_3/3 45 (33.6%) 54 (40.3%) 48 (36.4%) medcl B medname B_1/4 52 (38.8%) 57 (42.5%) 59 (44.7%) medname B_2/4 52 (38.8%) 55 (41.0%) 56 (42.4%) medname B_3/4 47 (35.1%) 47 (35.1%) 52 (39.4%) medname B_4/4 50 (37.3%) 45 (33.6%) 55 (41.7%) medcl C medname C_1/2 51 (38.1%) 50 (37.3%) 56 (42.4%) medname C_2/2 52 (38.8%) 58 (43.3%) 60 (45.5%) 4.6 Disposition 4.6.1 rtables Code resetSession() library(dplyr) library(magrittr) library(rtables) data(&quot;cadsl&quot;, package = &quot;random.cdisc.data&quot;) adsl &lt;- cadsl |&gt; select(USUBJID, TRT01A, EOSSTT, DCSREAS) lyt &lt;- basic_table() |&gt; split_cols_by(&quot;TRT01A&quot;) |&gt; add_colcounts() |&gt; split_rows_by(&quot;EOSSTT&quot;) |&gt; split_rows_by(&quot;DCSREAS&quot;) |&gt; summarize_row_groups() build_table(lyt, adsl) A: Drug X B: Placebo C: Combination (N=134) (N=134) (N=132) —————————————————————————————————————————————————————————————————————————— COMPLETED ADVERSE EVENT 0 (0.0%) 0 (0.0%) 0 (0.0%) DEATH 0 (0.0%) 0 (0.0%) 0 (0.0%) LACK OF EFFICACY 0 (0.0%) 0 (0.0%) 0 (0.0%) PHYSICIAN DECISION 0 (0.0%) 0 (0.0%) 0 (0.0%) PROTOCOL VIOLATION 0 (0.0%) 0 (0.0%) 0 (0.0%) WITHDRAWAL BY PARENT/GUARDIAN 0 (0.0%) 0 (0.0%) 0 (0.0%) WITHDRAWAL BY SUBJECT 0 (0.0%) 0 (0.0%) 0 (0.0%) DISCONTINUED ADVERSE EVENT 3 (2.2%) 6 (4.5%) 5 (3.8%) DEATH 25 (18.7%) 23 (17.2%) 22 (16.7%) LACK OF EFFICACY 2 (1.5%) 2 (1.5%) 3 (2.3%) PHYSICIAN DECISION 2 (1.5%) 3 (2.2%) 2 (1.5%) PROTOCOL VIOLATION 5 (3.7%) 3 (2.2%) 4 (3.0%) WITHDRAWAL BY PARENT/GUARDIAN 4 (3.0%) 2 (1.5%) 1 (0.8%) WITHDRAWAL BY SUBJECT 1 (0.7%) 1 (0.7%) 1 (0.8%) ONGOING ADVERSE EVENT 0 (0.0%) 0 (0.0%) 0 (0.0%) DEATH 0 (0.0%) 0 (0.0%) 0 (0.0%) LACK OF EFFICACY 0 (0.0%) 0 (0.0%) 0 (0.0%) PHYSICIAN DECISION 0 (0.0%) 0 (0.0%) 0 (0.0%) PROTOCOL VIOLATION 0 (0.0%) 0 (0.0%) 0 (0.0%) WITHDRAWAL BY PARENT/GUARDIAN 0 (0.0%) 0 (0.0%) 0 (0.0%) WITHDRAWAL BY SUBJECT 0 (0.0%) 0 (0.0%) 0 (0.0%) 4.6.2 gt Code resetSession() library(tidyverse) library(gt) gt_adsl &lt;- cadsl |&gt; dplyr::group_by(TRT01A) |&gt; dplyr::mutate(n_total = dplyr::n()) |&gt; dplyr::ungroup() header_n &lt;- gt_adsl |&gt; dplyr::group_by(TRT01A) |&gt; dplyr::summarize(trt = sprintf(&quot;%s \\nN=%i (100%%)&quot;, unique(TRT01A), dplyr::n()), .groups = &quot;drop&quot;) |&gt; pull(trt) |&gt; as.list() names(header_n) &lt;- paste0(&quot;n_&quot;, levels(gt_adsl$TRT01A)) gt_sum &lt;- gt_adsl |&gt; dplyr::mutate( DCSREAS = dplyr::case_when(EOSSTT %in% c(&quot;COMPLETED&quot;, &quot;ONGOING&quot;) ~ as.character(EOSSTT), is.na(DTHCAUS) &amp; EOSSTT == &quot;DISCONTINUED&quot; ~ as.character(DCSREAS), TRUE ~ paste(DCSREAS, DTHCAUS, sep = &quot;_&quot;))) |&gt; dplyr::group_by(TRT01A, EOSSTT, DCSREAS) |&gt; dplyr::summarize( n = dplyr::n(), pct = dplyr::n()/min(n_total), .groups = &quot;drop&quot; ) |&gt; tidyr::pivot_wider(id_cols = c(EOSSTT, DCSREAS), names_from = TRT01A, values_from = c(n, pct)) dth_lbl &lt;- gt_sum |&gt; dplyr::slice(1) |&gt; dplyr::mutate( across(where(is.numeric), ~NA_real_), EOSSTT = &quot;DISCONTINUED&quot;, DCSREAS = &quot;DEATH&quot; ) gt_disp &lt;- dplyr::bind_rows(gt_sum, dth_lbl) |&gt; dplyr::mutate( EOSSTT = factor(EOSSTT, levels = c(&quot;COMPLETED&quot;, &quot;ONGOING&quot;, &quot;DISCONTINUED&quot;), labels = c(&quot;Completed&quot;, &quot;Ongoing&quot;, &quot;Discontinued&quot;)), DCSREAS = factor(DCSREAS, levels = c(&quot;COMPLETED&quot;, &quot;ONGOING&quot;, &quot;ADVERSE EVENT&quot;, &quot;DEATH&quot; ,&quot;DEATH_ADVERSE EVENT&quot;, &quot;DEATH_DISEASE PROGRESSION&quot;, &quot;DEATH_LOST TO FOLLOW UP&quot;, &quot;DEATH_MISSING&quot;, &quot;DEATH_Post-study reporting of death&quot;, &quot;DEATH_SUICIDE&quot;, &quot;DEATH_UNKNOWN&quot;, &quot;LACK OF EFFICACY&quot;, &quot;PHYSICIAN DECISION&quot;, &quot;PROTOCOL VIOLATION&quot;, &quot;WITHDRAWAL BY PARENT/GUARDIAN&quot;, &quot;WITHDRAWAL BY SUBJECT&quot;), labels = c(&quot;Completed&quot;, &quot;Ongoing&quot;, &quot;Adverse Event&quot;, &quot;Death&quot;, &quot;Adverse Event &quot;, &quot;Disease Progression&quot;, &quot;Lost to Follow Up&quot;, &quot;Missing&quot;, &quot;Post-Study Reporting of Death&quot;, &quot;Suicide&quot;, &quot;Unknown&quot;, &quot;Lack of Efficacy&quot;, &quot;Physician Decision&quot;, &quot;Protocol Violation&quot;, &quot;Withdrawal by Parent/ Guardian&quot;, &quot;Withdrawal by Subject&quot;)) ) |&gt; dplyr::arrange(EOSSTT, DCSREAS) gt_disp |&gt; gt(rowname_col = &quot;DCSREAS&quot;) |&gt; tab_row_group( label = &quot;Discontinued&quot;, rows = EOSSTT == &quot;Discontinued&quot; ) |&gt; row_group_order( groups = c(NA, &quot;Discontinued&quot;) ) |&gt; cols_hide(EOSSTT) |&gt; fmt_integer( columns = starts_with(&quot;n_&quot;) ) |&gt; fmt_percent( columns = starts_with(&quot;pct_&quot;), decimals = 1 ) |&gt; sub_missing( rows = DCSREAS == &quot;Death&quot;, missing_text = &quot;&quot; ) |&gt; cols_merge_n_pct(col_n = &quot;n_A: Drug X&quot;, col_pct = &quot;pct_A: Drug X&quot;) |&gt; cols_merge_n_pct(col_n = &quot;n_B: Placebo&quot;, col_pct = &quot;pct_B: Placebo&quot;) |&gt; cols_merge_n_pct(col_n = &quot;n_C: Combination&quot;, col_pct = &quot;pct_C: Combination&quot;) |&gt; sub_missing( rows = DCSREAS != &quot;Death&quot;, missing_text = 0 ) |&gt; cols_align( align = &quot;center&quot;, columns = everything() ) |&gt; cols_align( align = &quot;left&quot;, columns = stub() ) |&gt; tab_stub_indent( rows = 3:16, indent = 2 ) |&gt; tab_stub_indent( rows = 5:11, indent = 5 ) |&gt; cols_label( `n_A: Drug X` = md(header_n[[1]]), `n_B: Placebo` = md(header_n[[2]]), `n_C: Combination` = md(header_n[[3]]) ) |&gt; cols_width( 1 ~ px(500) ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #tvipafuqxv .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #tvipafuqxv .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #tvipafuqxv .gt_caption { padding-top: 4px; padding-bottom: 4px; } #tvipafuqxv .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #tvipafuqxv .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #tvipafuqxv .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #tvipafuqxv .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #tvipafuqxv .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #tvipafuqxv .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #tvipafuqxv .gt_column_spanner_outer:first-child { padding-left: 0; } #tvipafuqxv .gt_column_spanner_outer:last-child { padding-right: 0; } #tvipafuqxv .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #tvipafuqxv .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #tvipafuqxv .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #tvipafuqxv .gt_from_md > :first-child { margin-top: 0; } #tvipafuqxv .gt_from_md > :last-child { margin-bottom: 0; } #tvipafuqxv .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #tvipafuqxv .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; } #tvipafuqxv .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; } #tvipafuqxv .gt_row_group_first td { border-top-width: 2px; } #tvipafuqxv .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #tvipafuqxv .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #tvipafuqxv .gt_first_summary_row.thick { border-top-width: 2px; } #tvipafuqxv .gt_last_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #tvipafuqxv .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #tvipafuqxv .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #tvipafuqxv .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #tvipafuqxv .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #tvipafuqxv .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #tvipafuqxv .gt_footnote { margin: 0px; font-size: 90%; padding-left: 4px; padding-right: 4px; padding-left: 5px; padding-right: 5px; } #tvipafuqxv .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #tvipafuqxv .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #tvipafuqxv .gt_left { text-align: left; } #tvipafuqxv .gt_center { text-align: center; } #tvipafuqxv .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #tvipafuqxv .gt_font_normal { font-weight: normal; } #tvipafuqxv .gt_font_bold { font-weight: bold; } #tvipafuqxv .gt_font_italic { font-style: italic; } #tvipafuqxv .gt_super { font-size: 65%; } #tvipafuqxv .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 75%; vertical-align: 0.4em; } #tvipafuqxv .gt_asterisk { font-size: 100%; vertical-align: 0; } #tvipafuqxv .gt_indent_1 { text-indent: 5px; } #tvipafuqxv .gt_indent_2 { text-indent: 10px; } #tvipafuqxv .gt_indent_3 { text-indent: 15px; } #tvipafuqxv .gt_indent_4 { text-indent: 20px; } #tvipafuqxv .gt_indent_5 { text-indent: 25px; } A: Drug X N=134 (100%) B: Placebo N=134 (100%) C: Combination N=132 (100%) Completed 68 (50.7%) 66 (49.3%) 73 (55.3%) Ongoing 24 (17.9%) 28 (20.9%) 21 (15.9%) Discontinued Adverse Event 3 (2.2%) 6 (4.5%) 5 (3.8%) Death Adverse Event 9 (6.7%) 7 (5.2%) 10 (7.6%) Disease Progression 8 (6.0%) 6 (4.5%) 6 (4.5%) Lost to Follow Up 2 (1.5%) 2 (1.5%) 2 (1.5%) Missing 2 (1.5%) 3 (2.2%) 2 (1.5%) Post-Study Reporting of Death 1 (0.7%) 2 (1.5%) 1 (0.8%) Suicide 2 (1.5%) 2 (1.5%) 1 (0.8%) Unknown 1 (0.7%) 1 (0.7%) 0 Lack of Efficacy 2 (1.5%) 2 (1.5%) 3 (2.3%) Physician Decision 2 (1.5%) 3 (2.2%) 2 (1.5%) Protocol Violation 5 (3.7%) 3 (2.2%) 4 (3.0%) Withdrawal by Parent/ Guardian 4 (3.0%) 2 (1.5%) 1 (0.8%) Withdrawal by Subject 1 (0.7%) 1 (0.7%) 1 (0.8%) 4.6.3 flextable Code resetSession() library(survival) library(tidyverse) library(flextable) library(glue) adsl &lt;- cadsl |&gt; select(USUBJID, TRT01A, EOSSTT, DCSREAS) labels &lt;- tools::toTitleCase(tolower(levels(adsl$DCSREAS))) names(labels) &lt;- levels(adsl$DCSREAS) # data parts calculations part_header &lt;- adsl |&gt; count(TRT01A, name = &quot;n_part&quot;) part_completed &lt;- adsl |&gt; filter(EOSSTT %in% &quot;COMPLETED&quot;) |&gt; mutate(DCSREAS = &quot;&quot;) |&gt; count(TRT01A, EOSSTT, DCSREAS) part_discontinued &lt;- adsl |&gt; filter(EOSSTT %in% &quot;DISCONTINUED&quot;) |&gt; count(TRT01A, EOSSTT, DCSREAS) part_death &lt;- cadsl |&gt; filter(EOSSTT %in% &quot;DISCONTINUED&quot;, DCSREAS %in% &quot;DEATH&quot;) |&gt; count(TRT01A, EOSSTT, DTHCAUS) |&gt; mutate(EOSSTT = forcats::fct_expand(EOSSTT, &quot;Death Cause&quot;), EOSSTT = &quot;Death Cause&quot;, DTHCAUS = tools::toTitleCase(tolower(DTHCAUS)) ) |&gt; rename(DCSREAS = DTHCAUS) dat &lt;- bind_rows( part_completed, part_discontinued, part_death) |&gt; inner_join(part_header, by = &quot;TRT01A&quot;) |&gt; mutate(percent = n / n_part, n_part = NULL) # Now the flextable creation with help of `tabulator()`. tab &lt;- tabulator( dat, rows = c(&quot;EOSSTT&quot;, &quot;DCSREAS&quot;), columns = &quot;TRT01A&quot;, `content_cell` = as_paragraph(fmt_n_percent(n, percent)) ) ft &lt;- as_flextable(tab, spread_first_col = TRUE, columns_alignment = &quot;right&quot; ) TRT_COUNTS &lt;- setNames(part_header$n_part, part_header$TRT01A) for (TRT_COD in names(TRT_COUNTS)) { ft &lt;- append_chunks(x = ft, part = &quot;header&quot;, i = 1, j = tabulator_colnames(tab, columns = &quot;content_cell&quot;, TRT01A %in% !!TRT_COD), as_chunk(TRT_COUNTS[TRT_COD], formatter = function(n) sprintf(&quot;\\n(N=%.0f)&quot;, n))) } ft &lt;- ft |&gt; labelizor( labels = c(labels, DCSREAS = &quot;&quot;, ANY = &quot;Number of patients&quot;, COMPLETED = &quot;Completed&quot;, DISCONTINUED = &quot;Discontinued&quot;), j = &quot;DCSREAS&quot;, part = &quot;all&quot;) |&gt; align(i = ~!is.na(EOSSTT) | seq_along(EOSSTT) == 1, j = 1, align = &quot;left&quot;) |&gt; prepend_chunks(i = ~is.na(EOSSTT), j = &quot;DCSREAS&quot;, as_chunk(&quot;\\t&quot;)) |&gt; autofit() ft .cl-f72ea040{}.cl-f723dda4{font-family:'Open Sans';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f723ddb8{font-family:'Open Sans';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-f72846b4{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-f72846c8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-f72846d2{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-f72846d3{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-f72846dc{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-f72846e6{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-f72846e7{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-f7286694{width:2.772in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f728669e{width:0.1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f72866a8{width:0.877in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f72866a9{width:0.882in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f72866b2{width:1.206in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f72866b3{width:2.772in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f72866bc{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f72866c6{width:0.877in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f72866c7{width:0.882in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f72866d0{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f72866da{width:2.772in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f72866db{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f72866e4{width:0.877in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f72866e5{width:0.882in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f72866ee{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f72866f8{width:2.772in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f72866f9{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f72866fa{width:0.877in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f7286702{width:0.882in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f7286703{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f728670c{width:2.772in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f7286716{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f7286717{width:0.877in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f7286720{width:0.882in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f7286721{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f7286722{width:2.772in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f728672a{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f728672b{width:0.877in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f7286734{width:0.882in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f7286735{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f728673e{width:2.772in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f728673f{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f7286748{width:0.877in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f7286749{width:0.882in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f728674a{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f7286752{width:2.772in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f7286753{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f728675c{width:0.877in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f7286766{width:0.882in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f7286770{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f7286771{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f728677a{width:2.772in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f7286784{width:0.877in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f728678e{width:0.882in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-f7286798{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}A: Drug X(N=134)B: Placebo(N=134)C: Combination(N=132)Completed68 (50.7%)66 (49.3%)73 (55.3%)Discontinued&emsp;Adverse Event3 (02.2%)6 (04.5%)5 (03.8%)&emsp;Death25 (18.7%)23 (17.2%)22 (16.7%)&emsp;Lack of Efficacy2 (01.5%)2 (01.5%)3 (02.3%)&emsp;Physician Decision2 (01.5%)3 (02.2%)2 (01.5%)&emsp;Protocol Violation5 (03.7%)3 (02.2%)4 (03.0%)&emsp;Withdrawal by Parent/Guardian4 (03.0%)2 (01.5%)1 (00.8%)&emsp;Withdrawal by Subject1 (00.7%)1 (00.7%)1 (00.8%)Death Cause&emsp;Adverse Event9 (06.7%)7 (05.2%)10 (07.6%)&emsp;Disease Progression8 (06.0%)6 (04.5%)6 (04.5%)&emsp;Lost to Follow Up2 (01.5%)2 (01.5%)2 (01.5%)&emsp;Missing2 (01.5%)3 (02.2%)2 (01.5%)&emsp;Post-Study Reporting of Death1 (00.7%)2 (01.5%)1 (00.8%)&emsp;Suicide2 (01.5%)2 (01.5%)1 (00.8%)&emsp;Unknown1 (00.7%)1 (00.7%) 4.6.4 tables Code resetSession() adsl &lt;- cadsl # Change the labels to title case levels(adsl$EOSSTT) &lt;- tools::toTitleCase(tolower(levels(adsl$EOSSTT))) levels(adsl$DCSREAS) &lt;- tools::toTitleCase(tolower(levels(adsl$DCSREAS))) levels(adsl$DTHCAUS) &lt;- tools::toTitleCase(tolower(levels(adsl$DTHCAUS))) library(tables) subject_counts &lt;- table(adsl$ARM) countpercentid &lt;- function(num, ARM) { n &lt;- length(unique(num)) sprintf(&quot;%d (%.2f%%)&quot;, length(unique(num)), 100*n/subject_counts[ARM[1]]) } count &lt;- function(x) sprintf(&quot;(N=%d)&quot;, length(x)) heading &lt;- tabular(Heading(&quot;&quot;)*1*Heading(&quot;&quot;)*count ~ Heading()*TRT01A, data = adsl) part1 &lt;- tabular( Heading(&quot;&quot;)*EOSSTT*DropEmpty()* Heading(&quot;&quot;)*1* Heading()*countpercentid*Arguments(ARM = TRT01A)* Heading()*USUBJID ~ Heading()*TRT01A, data = subset(adsl, EOSSTT != &quot;Discontinued&quot;)) part2 &lt;- tabular( Heading(&quot;&quot;)*EOSSTT* Heading(&quot;&quot;)*DCSREAS*DropEmpty()* Heading()*countpercentid*Arguments(ARM = TRT01A)* Heading()*USUBJID ~ Heading()*TRT01A, data = subset(adsl, EOSSTT == &quot;Discontinued&quot; &amp; DCSREAS != &quot;Death&quot;)) part3 &lt;- tabular( Heading(&quot;&quot;)*DCSREAS* Heading(&quot;&quot;)*DTHCAUS*DropEmpty()* Heading()*countpercentid*Arguments(ARM = TRT01A)* Heading()*USUBJID ~ Heading()*TRT01A, data = subset(adsl, EOSSTT == &quot;Discontinued&quot; &amp; DCSREAS == &quot;Death&quot;)) useGroupLabels(rbind(heading, part1, part2, part3), indent = &quot;&amp;emsp;&quot;) #table3ebb706459ad .Rtable thead, .Rtable .even { background-color: inherit; } #table3ebb706459ad .left { text-align:left; } #table3ebb706459ad .center { text-align:center; } #table3ebb706459ad .right { text-align:right; } #table3ebb706459ad .Rtable, #table3ebb706459ad .Rtable thead { border-collapse: collapse; border-style: solid; border-width: medium 0; border-color: inherit; } #table3ebb706459ad .Rtable th, #table3ebb706459ad .Rtable td { padding-left: 0.5em; padding-right: 0.5em; border-width: 0; } A: Drug X B: Placebo C: Combination   (N=134) (N=134) (N=132) Completed 68 (50.75%) 66 (49.25%) 73 (55.30%) Ongoing 24 (17.91%) 28 (20.90%) 21 (15.91%) Discontinued        Adverse Event 3 (2.24%) 6 (4.48%) 5 (3.79%)  Lack of Efficacy 2 (1.49%) 2 (1.49%) 3 (2.27%)  Physician Decision 2 (1.49%) 3 (2.24%) 2 (1.52%)  Protocol Violation 5 (3.73%) 3 (2.24%) 4 (3.03%)  Withdrawal by Parent/Guardian 4 (2.99%) 2 (1.49%) 1 (0.76%)  Withdrawal by Subject 1 (0.75%) 1 (0.75%) 1 (0.76%) Death        Adverse Event 9 (6.72%) 7 (5.22%) 10 (7.58%)  Disease Progression 8 (5.97%) 6 (4.48%) 6 (4.55%)  Lost to Follow Up 2 (1.49%) 2 (1.49%) 2 (1.52%)  Missing 2 (1.49%) 3 (2.24%) 2 (1.52%)  Post-Study Reporting of Death 1 (0.75%) 2 (1.49%) 1 (0.76%)  Suicide 2 (1.49%) 2 (1.49%) 1 (0.76%)  Unknown 1 (0.75%) 1 (0.75%)   4.6.5 tidytlg Code resetSession() library(dplyr) library(tidytlg) data(&quot;cadsl&quot;, package = &quot;random.cdisc.data&quot;) adsl &lt;- cadsl %&gt;% mutate(COMPFL = case_when(EOSSTT == &quot;COMPLETED&quot; ~ &quot;Y&quot;, TRUE ~ &quot;N&quot;)) disc &lt;- adsl %&gt;% filter(EOSSTT == &quot;DISCONTINUED&quot;) dth &lt;- adsl %&gt;% filter(DTHFL == &quot;Y&quot;) # Create analysis population counts tbl1 &lt;- freq(adsl, rowvar = &quot;SAFFL&quot;, colvar = &quot;ARM&quot;, statlist = statlist(&quot;n&quot;), rowtext = &quot;Analysis Set: Safety Population&quot;, subset = SAFFL == &quot;Y&quot;) # Create counts (percentages) for completed patients tbl2 &lt;- freq(adsl, rowvar = &quot;COMPFL&quot;, colvar = &quot;ARM&quot;, statlist = statlist(&quot;n (x.x%)&quot;), rowtext = &quot;Completed&quot;, subset = COMPFL == &quot;Y&quot;) # Create counts (percentages) for discontinued reasons tbl3 &lt;- freq(disc, denom_df = adsl, rowvar = &quot;DCSREAS&quot;, colvar = &quot;ARM&quot;, statlist = statlist(&quot;n (x.x%)&quot;), row_header = &quot;Discontinued&quot;) # Create counts (percentages) for death reasons tbl4 &lt;- freq(dth, denom_df = adsl, rowvar = &quot;DTHCAUS&quot;, colvar = &quot;ARM&quot;, statlist = statlist(&quot;n (x.x%)&quot;), row_header = &quot;Death Cause&quot;) # combine analysis results together tbl &lt;- bind_table(tbl1, tbl2, tbl3, tbl4) # output the analysis results gentlg(huxme = tbl, format = &quot;HTML&quot;, print.hux = FALSE, file = &quot;Table x.x.x.x&quot;, orientation = &quot;portrait&quot;, title = &quot;Study Disposition Summary&quot;, colheader = c(&quot;&quot;,&quot;A: Drug X&quot;,&quot;B: Placebo&quot;,&quot;C: Combination&quot;)) Table 4.6: Table x.x.x.x: &emsp; Study Disposition Summary A: Drug X B: Placebo C: Combination Analysis Set: Safety Population134134132 Completed68 (50.7%)66 (49.3%)73 (55.3%) Discontinued ADVERSE EVENT3 (2.2%)6 (4.5%)5 (3.8%) DEATH25 (18.7%)23 (17.2%)22 (16.7%) LACK OF EFFICACY2 (1.5%)2 (1.5%)3 (2.3%) PHYSICIAN DECISION2 (1.5%)3 (2.2%)2 (1.5%) PROTOCOL VIOLATION5 (3.7%)3 (2.2%)4 (3.0%) WITHDRAWAL BY PARENT/GUARDIAN4 (3.0%)2 (1.5%)1 (0.8%) WITHDRAWAL BY SUBJECT1 (0.7%)1 (0.7%)1 (0.8%) Death Cause ADVERSE EVENT9 (6.7%)7 (5.2%)10 (7.6%) DISEASE PROGRESSION8 (6.0%)6 (4.5%)6 (4.5%) LOST TO FOLLOW UP2 (1.5%)2 (1.5%)2 (1.5%) MISSING2 (1.5%)3 (2.2%)2 (1.5%) Post-study reporting of death1 (0.7%)2 (1.5%)1 (0.8%) SUICIDE2 (1.5%)2 (1.5%)1 (0.8%) UNKNOWN1 (0.7%)1 (0.7%)0 [table x.x.x.x.html][/home/runner/work/_temp/b12862b4-488c-4339-87f9-9fc499992f88] 21MAR2023, 12:57 4.6.6 tfrmt Rather than starting with an ADaM, {tfrmt} assumes users will start with an ARD (Analysis Results Dataset), because of this, making this table will be split into two parts, first to make the ARD and second to format the table. Code resetSession() library(tidyverse) library(tfrmt) data(&quot;cadsl&quot;, package = &quot;random.cdisc.data&quot;) big_n &lt;- cadsl |&gt; dplyr::group_by(ARM) |&gt; dplyr::summarize( N = dplyr::n_distinct(USUBJID) ) disp_summary &lt;- cadsl |&gt; dplyr::left_join(big_n, by = &quot;ARM&quot;) |&gt; dplyr::group_by(ARM, EOSSTT, DCSREAS, DTHCAUS) |&gt; dplyr::reframe( n_subj = n_distinct(USUBJID), pct_subj = n_subj/N ) |&gt; dplyr::distinct() |&gt; tidyr::pivot_longer(ends_with(&quot;subj&quot;)) |&gt; dplyr::mutate( DCSREAS = if_else(is.na(DCSREAS), EOSSTT, DCSREAS), DTHCAUS = if_else(is.na(DTHCAUS), DCSREAS, DTHCAUS), EOSSTT = forcats::fct_relevel(EOSSTT, &quot;ONGOING&quot;, &quot;COMPLETED&quot;, &quot;DISCONTINUED&quot;) ) %&gt;% dplyr::arrange(EOSSTT, DCSREAS, DTHCAUS) label_N &lt;- big_n |&gt; dplyr::rename(value = N) |&gt; dplyr::mutate(name = &quot;header_n&quot;) disp_ard &lt;- disp_summary |&gt; bind_rows(label_N) ## Format Table tfrmt( column = ARM, group = c(&quot;EOSSTT&quot;, &quot;DCSREAS&quot;), param = name, value = value, label = DTHCAUS ) |&gt; # Then we cam combine it with an n percent template tfrmt_n_pct(n = &quot;n_subj&quot;, pct = &quot;pct_subj&quot;, pct_frmt_when = frmt_when(&quot;==1&quot; ~ &quot;&quot;, &quot;&gt;.99&quot; ~ &quot;(&gt;99%)&quot;, &quot;==0&quot; ~ &quot;&quot;, &quot;&lt;.01&quot; ~ &quot;(&lt;1%)&quot;, &quot;TRUE&quot; ~ frmt(&quot;(xx.x%)&quot;, transform = ~.*100)) ) |&gt; #Finally we are going to add some additional formatting tfrmt( big_n = big_n_structure(&quot;header_n&quot;), # Aligning on decimal places and spaces col_style_plan = col_style_plan( col_style_structure(col = matches(&quot;[A-Z]:.*&quot;), align = c(&quot;.&quot;, &quot; &quot;)) ) )|&gt; print_to_gt(disp_ard) html { font-family: Courier, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #gxrxncxehg .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 14px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #gxrxncxehg .gt_heading { background-color: #FFFFFF; text-align: center; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #gxrxncxehg .gt_caption { padding-top: 4px; padding-bottom: 4px; } #gxrxncxehg .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #gxrxncxehg .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #gxrxncxehg .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #gxrxncxehg .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #gxrxncxehg .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #gxrxncxehg .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #gxrxncxehg .gt_column_spanner_outer:first-child { padding-left: 0; } #gxrxncxehg .gt_column_spanner_outer:last-child { padding-right: 0; } #gxrxncxehg .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #gxrxncxehg .gt_group_heading { padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: rgba(255, 255, 255, 0); border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: rgba(255, 255, 255, 0); border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #gxrxncxehg .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: rgba(255, 255, 255, 0); border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: rgba(255, 255, 255, 0); vertical-align: middle; } #gxrxncxehg .gt_from_md > :first-child { margin-top: 0; } #gxrxncxehg .gt_from_md > :last-child { margin-bottom: 0; } #gxrxncxehg .gt_row { padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #gxrxncxehg .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: rgba(255, 255, 255, 0); padding-left: 5px; padding-right: 5px; } #gxrxncxehg .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: rgba(255, 255, 255, 0); padding-left: 5px; padding-right: 5px; vertical-align: top; } #gxrxncxehg .gt_row_group_first td { border-top-width: 2px; } #gxrxncxehg .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; } #gxrxncxehg .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #gxrxncxehg .gt_first_summary_row.thick { border-top-width: 2px; } #gxrxncxehg .gt_last_summary_row { padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #gxrxncxehg .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; } #gxrxncxehg .gt_first_grand_summary_row { padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #gxrxncxehg .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #gxrxncxehg .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #gxrxncxehg .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #gxrxncxehg .gt_footnote { margin: 0px; font-size: 90%; padding-left: 1px; padding-right: 1px; padding-left: 5px; padding-right: 5px; } #gxrxncxehg .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #gxrxncxehg .gt_sourcenote { font-size: 90%; padding-top: 1px; padding-bottom: 1px; padding-left: 5px; padding-right: 5px; } #gxrxncxehg .gt_left { text-align: left; } #gxrxncxehg .gt_center { text-align: center; } #gxrxncxehg .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #gxrxncxehg .gt_font_normal { font-weight: normal; } #gxrxncxehg .gt_font_bold { font-weight: bold; } #gxrxncxehg .gt_font_italic { font-style: italic; } #gxrxncxehg .gt_super { font-size: 65%; } #gxrxncxehg .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 75%; vertical-align: 0.4em; } #gxrxncxehg .gt_asterisk { font-size: 100%; vertical-align: 0; } #gxrxncxehg .gt_indent_1 { text-indent: 5px; } #gxrxncxehg .gt_indent_2 { text-indent: 10px; } #gxrxncxehg .gt_indent_3 { text-indent: 15px; } #gxrxncxehg .gt_indent_4 { text-indent: 20px; } #gxrxncxehg .gt_indent_5 { text-indent: 25px; } A: Drug X N = 134 B: Placebo N = 134 C: Combination N = 132 ONGOING 24 (17.9%) 28 (20.9%) 21 (15.9%) COMPLETED 68 (50.7%) 66 (49.3%) 73 (55.3%) DISCONTINUED ADVERSE EVENT 3 ( 2.2%) 6 ( 4.5%) 5 ( 3.8%) DEATH ADVERSE EVENT 9 ( 6.7%) 7 ( 5.2%) 10 ( 7.6%) DISEASE PROGRESSION 8 ( 6.0%) 6 ( 4.5%) 6 ( 4.5%) LOST TO FOLLOW UP 2 ( 1.5%) 2 ( 1.5%) 2 ( 1.5%) MISSING 2 ( 1.5%) 3 ( 2.2%) 2 ( 1.5%) Post-study reporting of death 1 (&lt;1%) 2 ( 1.5%) 1 (&lt;1%) SUICIDE 2 ( 1.5%) 2 ( 1.5%) 1 (&lt;1%) UNKNOWN 1 (&lt;1%) 1 (&lt;1%) LACK OF EFFICACY 2 ( 1.5%) 2 ( 1.5%) 3 ( 2.3%) PHYSICIAN DECISION 2 ( 1.5%) 3 ( 2.2%) 2 ( 1.5%) PROTOCOL VIOLATION 5 ( 3.7%) 3 ( 2.2%) 4 ( 3.0%) WITHDRAWAL BY PARENT/GUARDIAN 4 ( 3.0%) 2 ( 1.5%) 1 (&lt;1%) WITHDRAWAL BY SUBJECT 1 (&lt;1%) 1 (&lt;1%) 1 (&lt;1%) "],["references.html", "References", " References "]]
