[["index.html", "Tables in Clinical Trials with R Chapter 1 About 1.1 Introduction 1.2 Call for Contributions 1.3 Data Used For Examples 1.4 Installing the R packages", " Tables in Clinical Trials with R R Consortium Tables Working Group 2022-11-24 Chapter 1 About 1.1 Introduction In this book we present various aspects of creating tables with the R language to analyze and report clinical trials data. The book is initiated by the R Consortium working group R Tables for Regulatory Submissions (RTRS). The R Consortium working group R Tables for Regulatory Submissions (RTRS) includes representation from several large pharmaceutical companies and CRO’s. The goal of the working group is to create standards for creating tables that meet the requirements of FDA submission documents, and hence enhance the suitability of R for FDA submissions. It is part of a larger R Consortium effort to facilitate the certification and validation of R packages and tools for FDA submissions thereby allowing drug developers to submit documentation for regulatory approval using the R programming environment in conjunction with open-source packages without the need for closed and often expensive proprietary tools. 1.2 Call for Contributions The content of this book is intended to grow via community contribution, so please add your subject matter expertise to this content by cloning the github repository of this book and make a pull request with your changes. We welcome all contribution, including but not limited to: summarizing table packages adding new example tables clarifying requirements and analyses improving R code In case you are new to using git and GitHub but would like to make a contribution then please write an GitHub issue and we will reach out to you to add the content. The most convenient way to get started is to: clone the GitHub repository of this book install the RStudio IDE Open the RStudio project in rtrs-wg/tables-book/tables-book.Rproj start working, see the Bookdown documentation, you can develop the book with the bookdown::serve_book() call. once ready to share your work create a PR use GitHub issues to communicate with us if you have difficulties 1.3 Data Used For Examples We use synthetic data for the examples in this book. The data is available from the random.cidsc.data R package which contains a number of datasets that follow the CDISC ADaM specifications. Code remotes::install_github(&quot;insightsengineering/random.cdisc.data&quot;) The data in random.cdisc.data is completely synthetic, meaning no patient data has been used to create it. The data is also fairly basic, meaning real study data is has often more signal and patterns. Code data(package=&quot;random.cdisc.data&quot;)$results[, &quot;Item&quot;] [1] &quot;cadab&quot; &quot;cadae&quot; &quot;cadaette&quot; &quot;cadcm&quot; &quot;caddv&quot; &quot;cadeg&quot; [7] &quot;cadex&quot; &quot;cadhy&quot; &quot;cadlb&quot; &quot;cadmh&quot; &quot;cadpc&quot; &quot;cadpp&quot; [13] &quot;cadqs&quot; &quot;cadrs&quot; &quot;cadsl&quot; &quot;cadsub&quot; &quot;cadtr&quot; &quot;cadtte&quot; [19] &quot;cadvs&quot; note that the prepending c stands for caches. So, for example the cached synthetic subject level dataset ADSL: Code data(&quot;cadsl&quot;, package = &quot;random.cdisc.data&quot;) head(cadsl) STUDYID USUBJID SUBJID SITEID AGE AGEU SEX 1 AB12345 AB12345-CHN-3-id-128 id-128 CHN-3 32 YEARS M 2 AB12345 AB12345-CHN-15-id-262 id-262 CHN-15 35 YEARS M 3 AB12345 AB12345-RUS-3-id-378 id-378 RUS-3 30 YEARS F 4 AB12345 AB12345-CHN-11-id-220 id-220 CHN-11 26 YEARS F 5 AB12345 AB12345-CHN-7-id-267 id-267 CHN-7 40 YEARS M 6 AB12345 AB12345-CHN-15-id-201 id-201 CHN-15 49 YEARS M RACE ETHNIC COUNTRY DTHFL INVID 1 ASIAN HISPANIC OR LATINO CHN Y INV ID CHN-3 2 BLACK OR AFRICAN AMERICAN NOT HISPANIC OR LATINO CHN N INV ID CHN-15 3 ASIAN NOT HISPANIC OR LATINO RUS N INV ID RUS-3 4 ASIAN NOT HISPANIC OR LATINO CHN N INV ID CHN-11 5 ASIAN NOT HISPANIC OR LATINO CHN N INV ID CHN-7 6 ASIAN NOT HISPANIC OR LATINO CHN Y INV ID CHN-15 INVNAM ARM ARMCD ACTARM ACTARMCD TRT01P 1 Dr. CHN-3 Doe A: Drug X ARM A A: Drug X ARM A A: Drug X 2 Dr. CHN-15 Doe C: Combination ARM C C: Combination ARM C C: Combination 3 Dr. RUS-3 Doe C: Combination ARM C C: Combination ARM C C: Combination 4 Dr. CHN-11 Doe B: Placebo ARM B B: Placebo ARM B B: Placebo 5 Dr. CHN-7 Doe B: Placebo ARM B B: Placebo ARM B B: Placebo 6 Dr. CHN-15 Doe C: Combination ARM C C: Combination ARM C C: Combination TRT01A TRT02P TRT02A REGION1 STRATA1 STRATA2 1 A: Drug X B: Placebo A: Drug X Asia C S2 2 C: Combination B: Placebo C: Combination Asia C S1 3 C: Combination A: Drug X B: Placebo Eurasia A S1 4 B: Placebo B: Placebo B: Placebo Asia B S2 5 B: Placebo C: Combination A: Drug X Asia C S1 6 C: Combination B: Placebo C: Combination Asia C S2 BMRKR1 BMRKR2 ITTFL SAFFL BMEASIFL BEP01FL AEWITHFL RANDDT 1 14.424934 MEDIUM Y Y Y Y N 2019-02-22 2 4.055463 LOW Y Y N N Y 2019-02-26 3 2.803240 HIGH Y Y Y N N 2019-02-24 4 10.262734 MEDIUM Y Y Y Y N 2019-02-27 5 6.206763 LOW Y Y N N N 2019-03-01 6 6.906799 MEDIUM Y Y Y N N 2019-03-05 TRTSDTM TRTEDTM TRT01SDTM 1 2019-02-24 11:09:18 2022-02-12 03:55:58 2019-02-24 11:09:18 2 2019-02-26 09:05:00 2022-02-26 02:32:36 2019-02-26 09:05:00 3 2019-02-28 03:19:08 2022-02-27 20:46:44 2019-02-28 03:19:08 4 2019-03-01 13:33:03 2022-03-01 07:00:39 2019-03-01 13:33:03 5 2019-03-02 00:09:16 2022-03-01 17:36:52 2019-03-02 00:09:16 6 2019-03-05 15:23:44 2022-02-19 03:34:25 2019-03-05 15:23:44 TRT01EDTM TRT02SDTM TRT02EDTM 1 2021-02-11 22:06:46 2021-02-11 22:06:46 2022-02-12 03:55:58 2 2021-02-25 20:43:24 2021-02-25 20:43:24 2022-02-26 02:32:36 3 2021-02-27 14:57:32 2021-02-27 14:57:32 2022-02-27 20:46:44 4 2021-03-01 01:11:27 2021-03-01 01:11:27 2022-03-01 07:00:39 5 2021-03-01 11:47:40 2021-03-01 11:47:40 2022-03-01 17:36:52 6 2021-02-18 21:45:13 2021-02-18 21:45:13 2022-02-19 03:34:25 AP01SDTM AP01EDTM AP02SDTM 1 2019-02-24 11:09:18 2021-02-11 22:06:46 2021-02-11 22:06:46 2 2019-02-26 09:05:00 2021-02-25 20:43:24 2021-02-25 20:43:24 3 2019-02-28 03:19:08 2021-02-27 14:57:32 2021-02-27 14:57:32 4 2019-03-01 13:33:03 2021-03-01 01:11:27 2021-03-01 01:11:27 5 2019-03-02 00:09:16 2021-03-01 11:47:40 2021-03-01 11:47:40 6 2019-03-05 15:23:44 2021-02-18 21:45:13 2021-02-18 21:45:13 AP02EDTM EOSSTT EOTSTT EOSDT EOSDY DCSREAS 1 2022-02-12 03:55:58 DISCONTINUED DISCONTINUED 2022-02-12 1084 DEATH 2 2022-02-26 02:32:36 COMPLETED COMPLETED 2022-02-26 1096 &lt;NA&gt; 3 2022-02-27 20:46:44 COMPLETED COMPLETED 2022-02-27 1096 &lt;NA&gt; 4 2022-03-01 07:00:39 COMPLETED COMPLETED 2022-03-01 1096 &lt;NA&gt; 5 2022-03-01 17:36:52 COMPLETED COMPLETED 2022-03-01 1096 &lt;NA&gt; 6 2022-02-19 03:34:25 DISCONTINUED DISCONTINUED 2022-02-19 1082 DEATH DTHDT DTHCAUS DTHCAT LDDTHELD LDDTHGR1 LSTALVDT DTHADY 1 2022-03-06 ADVERSE EVENT ADVERSE EVENT 22 &lt;=30 2022-03-06 1106 2 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; NA &lt;NA&gt; 2022-03-17 NA 3 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; NA &lt;NA&gt; 2022-03-11 NA 4 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; NA &lt;NA&gt; 2022-03-26 NA 5 &lt;NA&gt; &lt;NA&gt; &lt;NA&gt; NA &lt;NA&gt; 2022-03-15 NA 6 2022-02-22 ADVERSE EVENT ADVERSE EVENT 3 &lt;=30 2022-02-22 1085 ADTHAUT study_duration_secs 1 Yes 63113904 2 &lt;NA&gt; 63113904 3 &lt;NA&gt; 63113904 4 &lt;NA&gt; 63113904 5 &lt;NA&gt; 63113904 6 Yes 63113904 Code adsl &lt;- cadsl 1.4 Installing the R packages At some point we may switch to renv to install the R packages used for this book. For right now you can install the packages yourself with: Code install.packages(c(&quot;rtables&quot;, &quot;gt&quot;, &quot;remotes&quot;, &quot;tidyverse&quot;, &quot;bookdown&quot;, &quot;tables&quot;)) install.packages(&#39;flextable&#39;, repos = &#39;https://davidgohel.r-universe.dev&#39;) remotes::install_github(&quot;insightsengineering/random.cdisc.data&quot;) remotes::install_github(&quot;insightsengineering/nestcolor&quot;) remotes::install_github(&quot;insightsengineering/tern&quot;) In each of the sections below, we will reset R to close to the present state at the start of the section, so readers can execute the demonstration code more or less independently of the other sections. This is done using the functions defined below. In your own documents, you wouldn’t need these resets. "],["tablepkgs.html", "Chapter 2 Overview table R packages 2.1 gt 2.2 r2rtf 2.3 rtables 2.4 flextable 2.5 tables", " Chapter 2 Overview table R packages We summarize various R packages (ordered alphabetically) to create production-ready tables in clinical research. The list is by no means complete; if you know another package that has been useful for you to create tables or listing using clinical trial data. Please contribute to this chapter. 2.1 gt The gt (website) package provides a high-level and declarative interface for composing tables. Contains a variety of formatter functions for transforming cell values from an input data frame to the desired reporting values (combines mutation and aesthetic styling with options for: scientific notation, uncertainty, ranges, percentages, suffixes, localized currency, etc.). Multiple output formats are supported with the same declarative interface (e.g., HTML, LaTeX/PDF, and RTF). 2.2 r2rtf The r2rtf (website) package creates production-ready tables and figures in RTF format. The R package is designed to provide simple “verb” functions that correspond to each component of a table, to help you translate data frame(s) to a table in RTF file. enables pipes (%&gt;%). only focus on table format. Data manipulation and analysis shall be handled by other R packages. (e.g., tidyverse) minimizes package dependency Chapter 1-9 of The R for Clinical Study Reports and Submission book provides examples by using r2rtf package. 2.3 rtables The rtables package defines a pipe-able grammar for declaring complex table structure layouts via nested splitting - in row- and column-space - and the specification of analysis functions which will calculate cell values within that structure. These pre-data table layouts are then applied to data to build the table, during which all necessary data grouping implied by the row and column splits, cell value calculation, and tabulation occurs automatically. Additional table features such as titles, footers, and referential footnotes are supported. ASCII, HTML, and PDF are supported as output formats for rendering tables. rtables source code is on GitHub as well as the documentation. rtables is also available on CRAN. 2.4 flextable flextable is providing a grammar for creating and customizing tables. The following formats are supported: ‘Word’ (.docx), ‘PowerPoint’ (.pptx), ‘PDF’ ,‘HTML’ and R ‘Grid Graphics’. The syntax is the same for the user regardless of the type of output to be produced. A set of functions allows the creation, definition of cell arrangement, addition of headers or footers, formatting and definition of cell content (i.e. text and or images). The package also offers a set of high-level functions that allow, for example, tabular reporting of statistical models and the creation of complex cross tabulations. Source code is on GitHub, a user manual is available. flextable is available on CRAN. 2.5 tables The tables package provides a formula-driven interface for computing the contents of tables and formatting them. It was inspired by SAS PROC TABULATE, but is not compatible with it. The user computes a table object by specifying a formula, with the left-hand side giving the rows, and the right-hand side giving the columns; the formula describes the summary functions to apply and how to organize them. The objects can be subsetted or combined using matrix-like operations. Tables can be rendered in plain text, LaTeX code to appear in a PDF document, or HTML code for a web document. The package is on CRAN. Source is maintained on R-forge at https://r-forge.r-project.org/projects/tables/ and mirrored on Github at https://github.com/rforge/tables/. Vignettes in the package serve as a user manual. Browse them at https://rdrr.io/cran/tables/, or install the package, then run browseVignettes(package = \"tables\"). "],["formatting-and-rendering-tables.html", "Chapter 3 Formatting and Rendering Tables 3.1 Title &amp; Footnotes 3.2 Captions 3.3 Pagination 3.4 Rendering Tables", " Chapter 3 Formatting and Rendering Tables Table generation usually is a two step process Derive the cell value and tabulate them. Create the final table output, save it to a file to be shared with collaborators. Chapter Commonly Used Tables focuses with the work involved in 1, in this chapter we discuss the various aspects of creating the final outputs that is commonly stored in a file with a particular file format (pdf, txt, html, docx or rtf). 3.1 Title &amp; Footnotes Commonly rendered tables that are reported to the health authorities have titles and footnotes with information such as: what is summarized in the table database lock date patient sub-population notes by study team notes regarding statistical algorithms chosen provenance information including path to program and when the table was created Often footnotes include cell references. 3.1.1 Title and Footnotes in rtables The basic_table function in rtables has the argument titles, subtitles, main_footer, prov_footer to add titles and footnotes to tables. rtables also supports referential footnotes. So for example a basic demographics table created with rtables via tern with title and footnotes would look as follows: Code resetSession() library(rtables) lyt &lt;- basic_table( title = &quot;Demographic Table - All Patients&quot;, subtitles = c(&quot;Cutoff Date: June 01, 2022&quot;, &quot;Arm B received a placebo.&quot;), main_footer = c(&quot;Missing data is omitted.&quot;) ) |&gt; split_cols_by(&quot;ARM&quot;) |&gt; analyze(c(&quot;AGE&quot;, &quot;SEX&quot;)) build_table(lyt, adsl) Demographic Table - All Patients Cutoff Date: June 01, 2022 Arm B received a placebo. ———————————————————————————————————————————————— A: Drug X B: Placebo C: Combination ———————————————————————————————————————————————— AGE Mean 33.77 35.43 35.43 SEX F 79 82 70 M 55 52 62 ———————————————————————————————————————————————— Missing data is omitted. 3.1.2 Title and Footnotes in flextable Titles and notes can be added and formatted with the ‘flextable’ package. It is possible to add them in the header and in the footer. Several methods are possible but for most needs, the add_header_lines() and add_footer_lines() functions will be the easiest to use. Let’s create first a flextable from an aggregation that will be used to illustrate the features. Code resetSession() library(flextable) library(dplyr) z &lt;- adsl |&gt; group_by(ARM, SEX) |&gt; summarise(avg = mean(AGE), sd = sd(AGE)) |&gt; tabulator(rows = &quot;SEX&quot;, columns = &quot;ARM&quot;, Y = as_paragraph(avg, &quot; (&quot;, sd, &quot;)&quot;)) |&gt; as_flextable() z .tabwid table{ border-spacing:0px !important; border-collapse:collapse; line-height:1; margin-left:auto; margin-right:auto; border-width: 0; border-color: transparent; caption-side: top; } .tabwid-caption-bottom table{ caption-side: bottom; } .tabwid_left table{ margin-left:0; } .tabwid_right table{ margin-right:0; } .tabwid td, .tabwid th { padding: 0; } .tabwid a { text-decoration: none; } .tabwid thead { background-color: transparent; } .tabwid tfoot { background-color: transparent; } .tabwid table tr { background-color: transparent; } .katex-display { margin: 0 0 !important; } .cl-56b7324a{}.cl-56afa5ca{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-56b2ef46{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-56b2ef50{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-56b2ef5a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-56b2ef5b{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-56b2ef64{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-56b2ef65{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-56b30710{width:0.562in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56b3071a{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56b3071b{width:1.015in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56b3071c{width:1.065in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56b30724{width:1.442in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56b30725{width:0.562in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56b30726{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56b3072e{width:1.015in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56b3072f{width:1.065in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56b30730{width:1.442in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56b30738{width:0.562in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56b30739{width:1.015in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56b30742{width:1.065in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56b30743{width:1.442in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}SEXA: Drug XB: PlaceboC: CombinationF32.8 (6.1)34.2 (7.0)35.2 (7.4)M35.2 (7.0)37.3 (8.9)35.7 (8.2) The following shows how to add titles or notes: Code z |&gt; add_header_lines(&quot;hello world&quot;) |&gt; add_footer_lines(&quot;bye bye world&quot;) .tabwid table{ border-spacing:0px !important; border-collapse:collapse; line-height:1; margin-left:auto; margin-right:auto; border-width: 0; border-color: transparent; caption-side: top; } .tabwid-caption-bottom table{ caption-side: bottom; } .tabwid_left table{ margin-left:0; } .tabwid_right table{ margin-right:0; } .tabwid td, .tabwid th { padding: 0; } .tabwid a { text-decoration: none; } .tabwid thead { background-color: transparent; } .tabwid tfoot { background-color: transparent; } .tabwid table tr { background-color: transparent; } .katex-display { margin: 0 0 !important; } .cl-56dd4b42{}.cl-56d5e06e{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-56d9132e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-56d91342{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-56d91343{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-56d9134c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-56d9134d{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-56d91356{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-56d91357{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-56d92896{width:0.562in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56d928a0{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56d928a1{width:1.015in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56d928aa{width:1.065in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56d928ab{width:1.442in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56d928ac{width:0.562in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56d928b4{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56d928be{width:1.015in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56d928bf{width:1.065in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56d928c0{width:1.442in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56d928c8{width:0.562in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56d928c9{width:1.015in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56d928d2{width:1.065in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56d928dc{width:1.442in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56d928dd{width:0.562in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56d928de{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56d928e6{width:1.015in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56d928e7{width:1.065in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-56d928f0{width:1.442in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}hello worldSEXA: Drug XB: PlaceboC: CombinationF32.8 (6.1)34.2 (7.0)35.2 (7.4)M35.2 (7.0)37.3 (8.9)35.7 (8.2)bye bye world For Word output, users can prepend a table number that will auto-incremente. Code docx_file &lt;- &quot;reports/flextable-title-01.docx&quot; ft &lt;- add_header_lines(z, &quot;hello world&quot;) |&gt; prepend_chunks( i = 1, j = 1, part = &quot;header&quot;, as_chunk(&quot;Table &quot;), as_word_field(&quot;SEQ tab \\u005C* Arabic&quot;), as_chunk(&quot;: &quot;)) |&gt; add_footer_lines(&quot;bye bye world&quot;) |&gt; theme_vanilla() save_as_docx(ft, ft, path = docx_file) reports/flextable-title-01.docx Footnotes are also available in ‘flextable’ with function footnote(). The function lets users add footnotes and references to it on the table. Code footnote(z, i = c(1, 2, 2), j = c(1, 5, 7), value = as_paragraph(&quot;hello world&quot;), ref_symbols = &quot;(1)&quot;) .tabwid table{ border-spacing:0px !important; border-collapse:collapse; line-height:1; margin-left:auto; margin-right:auto; border-width: 0; border-color: transparent; caption-side: top; } .tabwid-caption-bottom table{ caption-side: bottom; } .tabwid_left table{ margin-left:0; } .tabwid_right table{ margin-right:0; } .tabwid td, .tabwid th { padding: 0; } .tabwid a { text-decoration: none; } .tabwid thead { background-color: transparent; } .tabwid tfoot { background-color: transparent; } .tabwid table tr { background-color: transparent; } .katex-display { margin: 0 0 !important; } .cl-5760466e{}.cl-57590e9e{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-57590ea8{font-family:'DejaVu Sans';font-size:6.6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.3pt;}.cl-575c3c0e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-575c3c18{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-575c3c22{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-575c3c23{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-575c3c2c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1;background-color:transparent;}.cl-575c3c2d{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-575c3c2e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-575c50e0{width:0.562in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-575c50ea{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-575c50eb{width:1.015in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-575c50f4{width:1.065in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-575c50f5{width:1.442in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 1.5pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-575c50fe{width:0.562in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-575c50ff{width:0.079in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-575c5100{width:1.015in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-575c5108{width:1.065in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-575c5109{width:1.442in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-575c510a{width:0.562in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-575c5112{width:1.015in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-575c5113{width:1.065in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-575c5114{width:1.442in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-575c511c{width:0.562in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-575c511d{width:0.079in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-575c511e{width:1.015in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-575c5126{width:1.065in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-575c5127{width:1.442in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}SEXA: Drug XB: PlaceboC: CombinationF(1)32.8 (6.1)34.2 (7.0)35.2 (7.4)M35.2 (7.0)37.3 (8.9)(1)35.7 (8.2)(1)(1)hello world 3.1.3 Titles and footnotes in the tables package The tables package concentrates on the table itself. The titles are generally written as part of the surrounding document. Footnotes would be added after constructing the table by modifying individual entries. Alternatively, only the footnote markers need to be added by modifying entries, and then the table object is converted to the format supported by the kableExtra package, and customizations can then be applied. Code resetSession() adsl &lt;- cadsl library(tables) library(kableExtra) sd_in_parens &lt;- function(x) sprintf(&quot;(%.1f)&quot;, sd(x)) tab &lt;- tabular(SEX ~ Heading()*ARM* Heading()*AGE* Heading()*(mean + sd_in_parens), data = adsl) rowLabels(tab)[1,1] &lt;- paste(rowLabels(tab)[1,1], &quot;&lt;sup&gt;a&lt;/sup&gt;&quot;) tab[2,2] &lt;- sprintf(&quot;%s%s&quot;, tab[2,2], &quot;&lt;sup&gt;b&lt;/sup&gt;&quot;) tab[2,3] &lt;- sprintf(&quot;%.2f%s&quot;, tab[2,3], &quot;&lt;sup&gt;b&lt;/sup&gt;&quot;) toKable(tab) |&gt; kable_styling(full_width = FALSE) |&gt; add_footnote(c(&quot;This is a label footnote&quot;, &quot;These are cell footnotes&quot;)) SEX A: Drug X B: Placebo C: Combination F a 32.76 (6.1) 34.24 (7.0) 35.20 (7.4) M 35.22 (7.0)b 37.31b (8.9) 35.69 (8.2) a This is a label footnote b These are cell footnotes 3.2 Captions A caption is a single paragraph of text describing the table it is associated to. Captions are often used because they allow you to cross-reference tables or list them in a ‘list of tables’ with the corresponding page numbers. 3.2.1 Captions in flextable The set_caption() function in ‘flextable’ is the recommanded way to add captions. Code resetSession() library(flextable) flextable(head(cars)) |&gt; set_caption( caption = &quot;a caption&quot;, autonum = officer::run_autonum(seq_id = &quot;tab&quot;, bkm = &quot;flextable-label&quot;)) .tabwid table{ border-spacing:0px !important; border-collapse:collapse; line-height:1; margin-left:auto; margin-right:auto; border-width: 0; border-color: transparent; caption-side: top; } .tabwid-caption-bottom table{ caption-side: bottom; } .tabwid_left table{ margin-left:0; } .tabwid_right table{ margin-right:0; } .tabwid td, .tabwid th { padding: 0; } .tabwid a { text-decoration: none; } .tabwid thead { background-color: transparent; } .tabwid tfoot { background-color: transparent; } .tabwid table tr { background-color: transparent; } .katex-display { margin: 0 0 !important; } .cl-57a8acc4{}.cl-57a12a58{font-family:'DejaVu Sans';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-57a427bc{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-57a43ac2{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 2pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-57a43ac3{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-57a43acc{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;} Table 3.1: a caption speeddist4241074722816910 In bookdown, use the syntax \\@ref(tab:flextable-label) to create a linked reference to the table. See an example of a reference: 3.1. With ‘Quarto’, the R chunk code should be transformed as: Code #| label: tbl-flextable-label #| tbl-cap: a caption flextable(head(cars)) 3.2.2 Captions in the tables package As with titles, captions would be added as part of the surrounding document rather than part of the table object. 3.3 Pagination Historically tables have been printed to paper for submissions. Hence large tables that would not fit onto a single printed page (e.g. letter &amp; portrait) would have to be split into multiple tables that can be printed to the preferred page size. This process of splitting the table is called pagination of tables. Pagination is a complex task as it requires to repeat information so that the tables on each page are correct tables with all relevant information for context. 3.3.1 Pagination in rtables In rtables pagination can be done with the paginate_table function which has a number of arguments to split the table, see the example documentation. 3.3.2 Pagination in flextable In ‘flextable’, there is no concept of pagination. The recommended method is to create a flextable for each modality of a group and to separate them with a page break; from R, this implies looping over a set of modalities with a for statement or a call to the lapply() function. Note this concept of page break is only valid for paginated documents, i.e. Word, PDF, eventually HTML with paged.js formats. In an ‘R Markdown’ document, the markdown code to insert a page break is \\newpage; with the package ‘officer’, you have to use body_add_break() (for Word documents only). 3.3.3 Pagination in the tables package Tables that span multiple pages are supported in PDF output using the LaTeX longtable package, specified when converting to LaTeX. 3.4 Rendering Tables The choice of file format is often dictated by your company’s processes to include the tables in a report. 3.4.1 ASCII 3.4.2 PDF 3.4.3 HTML 3.4.4 WORD 3.4.5 RTF "],["commontables.html", "Chapter 4 Commonly Used Tables 4.1 Demographic Tables 4.2 Event Tables 4.3 Laboratory Tables 4.4 Time to Event Analysis Tables 4.5 Concomitant Medications 4.6 Disposition", " Chapter 4 Commonly Used Tables 4.1 Demographic Tables 4.1.1 rtables Using rtables only: Code resetSession() library(rtables) a_demo_num &lt;- function(x) { in_rows(n = length(x), &quot;Mean (SD)&quot; = rcell(c(mean(x, na.rm = TRUE), sd(x, na.rm=TRUE)), format = &quot;xx.x (xx.x)&quot;), &quot;Median&quot; = median(x,na.rm = TRUE), &quot;Min - Max&quot; = rcell(range(x, na.rm = TRUE), format = &quot;xx.x - xx.x&quot;)) } a_demo_fac &lt;- function(x) { in_rows(.list = c(c(n = length(x)), table(x))) } lyt &lt;- basic_table(title = &quot;x.x: Study Subject Data&quot;, subtitles= c(&quot;x.x.x: Demographic Characteristics&quot;, &quot;Table x.x.x.x: Demographic Characteristics - Full Analysis Set&quot;), prov_footer = &quot;Source: ADSL DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY&quot;) |&gt; split_cols_by(&quot;ARM&quot;) |&gt; analyze(c(&quot;AGE&quot;, &quot;SEX&quot;, &quot;COUNTRY&quot;), afun = list(AGE = a_demo_num, SEX = a_demo_fac, COUNTRY = a_demo_fac)) build_table(lyt, ex_adsl) x.x: Study Subject Data x.x.x: Demographic Characteristics Table x.x.x.x: Demographic Characteristics - Full Analysis Set ——————————————————————————————————————————————————————————————— A: Drug X B: Placebo C: Combination ——————————————————————————————————————————————————————————————— AGE n 134 134 132 Mean (SD) 33.8 (6.6) 35.4 (7.9) 35.4 (7.7) Median 33 35 35 Min - Max 21.0 - 50.0 21.0 - 62.0 20.0 - 69.0 SEX n 134 134 132 F 79 77 66 M 51 55 60 U 3 2 4 UNDIFFERENTIATED 1 0 2 COUNTRY n 134 134 132 CHN 74 81 64 USA 10 13 17 BRA 13 7 10 PAK 12 9 10 NGA 8 7 11 RUS 5 8 6 JPN 5 4 9 GBR 4 3 2 CAN 3 2 3 CHE 0 0 0 ——————————————————————————————————————————————————————————————— Source: ADSL DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY Using rtables and tern Code library(tern) lyt &lt;- basic_table(title = &quot;x.x: Study Subject Data&quot;, subtitles= c(&quot;x.x.x: Demographic Characteristics&quot;, &quot;Table x.x.x.x: Demographic Characteristics - Full Analysis Set&quot;), prov_footer = &quot;Source: ADSL DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY&quot;) |&gt; split_cols_by(&quot;ARM&quot;) |&gt; summarize_vars(c(&quot;AGE&quot;, &quot;SEX&quot;, &quot;COUNTRY&quot;)) build_table(lyt, ex_adsl) x.x: Study Subject Data x.x.x: Demographic Characteristics Table x.x.x.x: Demographic Characteristics - Full Analysis Set ——————————————————————————————————————————————————————————————— A: Drug X B: Placebo C: Combination ——————————————————————————————————————————————————————————————— AGE n 134 134 132 Mean (SD) 33.8 (6.6) 35.4 (7.9) 35.4 (7.7) Median 33.0 35.0 35.0 Min - Max 21.0 - 50.0 21.0 - 62.0 20.0 - 69.0 SEX n 134 134 132 F 79 (59%) 77 (57.5%) 66 (50%) M 51 (38.1%) 55 (41%) 60 (45.5%) U 3 (2.2%) 2 (1.5%) 4 (3%) UNDIFFERENTIATED 1 (0.7%) 0 2 (1.5%) COUNTRY n 134 134 132 CHN 74 (55.2%) 81 (60.4%) 64 (48.5%) USA 10 (7.5%) 13 (9.7%) 17 (12.9%) BRA 13 (9.7%) 7 (5.2%) 10 (7.6%) PAK 12 (9%) 9 (6.7%) 10 (7.6%) NGA 8 (6%) 7 (5.2%) 11 (8.3%) RUS 5 (3.7%) 8 (6%) 6 (4.5%) JPN 5 (3.7%) 4 (3%) 9 (6.8%) GBR 4 (3%) 3 (2.2%) 2 (1.5%) CAN 3 (2.2%) 2 (1.5%) 3 (2.3%) CHE 0 0 0 ——————————————————————————————————————————————————————————————— Source: ADSL DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY 4.1.2 gt Code resetSession() library(gt) library(tidyverse) # We will use ex_adsl but will assign a unit to the Age column ex_adsl &lt;- formatters::ex_adsl gt_adsl &lt;- ex_adsl attr(gt_adsl$AGE, &quot;units&quot;) &lt;- &quot;Years&quot; # This is a customized summary function # It creates numeric and categorical summaries for specified variables, following the rtables exmaple custom_summary &lt;- function(df, group_var, sum_var){ group_var &lt;- rlang::ensym(group_var) sum_var &lt;- rlang::ensym(sum_var) is_categorical &lt;- is.character(eval(expr(`$`(df, !!sum_var)))) | is.factor(eval(expr(`$`(df, !!sum_var)))) if (is_categorical){ df &lt;- df %&gt;% dplyr::group_by(!!group_var) %&gt;% dplyr::mutate(N = n()) %&gt;% dplyr::ungroup() %&gt;% dplyr::group_by(!!group_var, !!sum_var) %&gt;% dplyr::summarize(val = n(), sd = 100*n()/mean(N)) %&gt;% dplyr::ungroup() %&gt;% tidyr::pivot_wider(id_cols = !!sum_var, names_from = !!group_var, values_from = c(val, sd)) %&gt;% dplyr::rename(label = !!sum_var) %&gt;% dplyr::mutate(isnum = FALSE, across(where(is.numeric), ~ifelse(is.na(.), 0, .))) sum_unit &lt;- &quot;, n (%)&quot; } else { sum_unit &lt;- sprintf(&quot; (%s)&quot;, attr(eval(expr(`$`(df, !!sum_var))), &quot;units&quot;)) df &lt;- df %&gt;% dplyr::group_by(!!group_var) %&gt;% dplyr::summarize(n = sum(!is.na(!!sum_var)), mean = mean(!!sum_var, na.rm = TRUE), sd = sd(!!sum_var, na.rm = TRUE), median = median(!!sum_var, na.rm = TRUE), min = min(!!sum_var, na.rm = TRUE), max = max(!!sum_var, na.rm = TRUE), min_max = NA) %&gt;% dplyr::ungroup() %&gt;% tidyr::pivot_longer(cols = c(n, mean, median, min_max), names_to = &quot;label&quot;, values_to = &quot;val&quot;) %&gt;% dplyr::mutate(sd = ifelse(label == &quot;mean&quot;, sd, NA), max = ifelse(label == &quot;min_max&quot;, max, NA), min = ifelse(label == &quot;min_max&quot;, min, NA), label = dplyr::recode(label, &quot;mean&quot; = &quot;Mean (SD)&quot;, &quot;min_max&quot; = &quot;Min - Max&quot;, &quot;median&quot; = &quot;Median&quot;)) %&gt;% tidyr::pivot_wider(id_cols = label, names_from = !!group_var, values_from = c(val, sd, min, max)) %&gt;% dplyr::mutate(isnum = TRUE) } df %&gt;% dplyr::mutate(category = paste0(stringr::str_to_title(deparse(substitute(!!sum_var))), sum_unit)) } # Perform aggregation for variables Age, Sex and Country adsl_summary &lt;- purrr::map_df(.x = vars(AGE, SEX, COUNTRY), .f = ~custom_summary(df = gt_adsl, group_var = ARM, sum_var = !!.x)) # Count number of patients per Arm total_n_arm &lt;- ex_adsl %&gt;% dplyr::group_by(ARM) %&gt;% dplyr::summarise(N = n()) %&gt;% dplyr::ungroup() # gt gt(adsl_summary, rowname_col = &quot;label&quot;, groupname_col = &quot;category&quot;) %&gt;% tab_header( title = &quot;x.x: Study Subject Data&quot;, subtitle = html(&quot;x.x.x: Demographic Characteristics&lt;br&gt;Table x.x.x.x: Demographic Characteristics - Full Analysis Set&quot;), preheader = c(&quot;Protocol: XXXXX&quot;, &quot;Cutoff date: DDMMYYYY&quot;) ) %&gt;% tab_source_note(&quot;Source: ADSL DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY&quot;) %&gt;% opt_align_table_header(align = &quot;left&quot;) %&gt;% fmt_integer(columns = starts_with(c(&quot;val&quot;, &quot;min&quot;, &quot;max&quot;)), rows = label != &quot;Mean (SD)&quot;) %&gt;% fmt_number(columns = starts_with(c(&quot;val&quot;, &quot;sd&quot;)), rows = label == &quot;Mean (SD)&quot;, decimals = 1) %&gt;% fmt_number(columns = starts_with(&quot;sd&quot;), rows = isnum == FALSE, decimals = 1) %&gt;% sub_missing(missing_text = &quot;&quot;) %&gt;% summary_rows(groups = c(&quot;Sex, n (%)&quot;, &quot;Country, n (%)&quot;), columns = starts_with(&quot;val&quot;), fns = list(n = ~sum(.)), missing_text = &quot;&quot;, formatter = fmt_integer) %&gt;% cols_merge_n_pct(col_n = &quot;val_A: Drug X&quot;, col_pct = &quot;sd_A: Drug X&quot;) %&gt;% cols_merge_n_pct(col_n = &quot;val_B: Placebo&quot;, col_pct = &quot;sd_B: Placebo&quot;) %&gt;% cols_merge_n_pct(col_n = &quot;val_C: Combination&quot;, col_pct = &quot;sd_C: Combination&quot;) %&gt;% cols_merge_range(col_begin = &quot;min_A: Drug X&quot;, col_end = &quot;max_A: Drug X&quot;, sep = &quot; - &quot;) %&gt;% cols_merge_range(col_begin = &quot;min_B: Placebo&quot;, col_end = &quot;max_B: Placebo&quot;, sep = &quot; - &quot;) %&gt;% cols_merge_range(col_begin = &quot;min_C: Combination&quot;, col_end = &quot;max_C: Combination&quot;, sep = &quot; - &quot;) %&gt;% cols_merge(columns = c(&quot;val_A: Drug X&quot;, &quot;min_A: Drug X&quot;), pattern = &quot;{1}{2}&quot;) %&gt;% cols_merge(columns = c(&quot;val_B: Placebo&quot;, &quot;min_B: Placebo&quot;), pattern = &quot;{1}{2}&quot;) %&gt;% cols_merge(columns = c(&quot;val_C: Combination&quot;, &quot;min_C: Combination&quot;), pattern = &quot;{1}{2}&quot;) %&gt;% cols_hide(columns = isnum) %&gt;% cols_align(align = c(&quot;center&quot;), columns = c(&quot;val_A: Drug X&quot;, &quot;val_B: Placebo&quot;, &quot;val_C: Combination&quot;)) %&gt;% cols_align(align = &quot;center&quot;, columns = 1) %&gt;% cols_label(&quot;val_A: Drug X&quot; = html(sprintf(&quot;A: Drug X&lt;br&gt; N=%i (100%%)&quot;, total_n_arm$N[1])), &quot;val_B: Placebo&quot; = html(sprintf(&quot;B: Placebo&lt;br&gt; N=%i (100%%)&quot;, total_n_arm$N[2])), &quot;val_C: Combination&quot; = html(sprintf(&quot;C: Combination&lt;br&gt; N=%i (100%%)&quot;, total_n_arm$N[3]))) %&gt;% tab_options( table.font.size = 9, page.orientation = &quot;landscape&quot;, page.numbering = TRUE, page.header.use_tbl_headings = TRUE, page.footer.use_tbl_notes = TRUE) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #srqyyrpcnu .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 9px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #srqyyrpcnu .gt_heading { background-color: #FFFFFF; text-align: left; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #srqyyrpcnu .gt_caption { padding-top: 4px; padding-bottom: 4px; } #srqyyrpcnu .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #srqyyrpcnu .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #srqyyrpcnu .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #srqyyrpcnu .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #srqyyrpcnu .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #srqyyrpcnu .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #srqyyrpcnu .gt_column_spanner_outer:first-child { padding-left: 0; } #srqyyrpcnu .gt_column_spanner_outer:last-child { padding-right: 0; } #srqyyrpcnu .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #srqyyrpcnu .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #srqyyrpcnu .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #srqyyrpcnu .gt_from_md > :first-child { margin-top: 0; } #srqyyrpcnu .gt_from_md > :last-child { margin-bottom: 0; } #srqyyrpcnu .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #srqyyrpcnu .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; } #srqyyrpcnu .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; } #srqyyrpcnu .gt_row_group_first td { border-top-width: 2px; } #srqyyrpcnu .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #srqyyrpcnu .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #srqyyrpcnu .gt_first_summary_row.thick { border-top-width: 2px; } #srqyyrpcnu .gt_last_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #srqyyrpcnu .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #srqyyrpcnu .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #srqyyrpcnu .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #srqyyrpcnu .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #srqyyrpcnu .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #srqyyrpcnu .gt_footnote { margin: 0px; font-size: 90%; padding-left: 4px; padding-right: 4px; padding-left: 5px; padding-right: 5px; } #srqyyrpcnu .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #srqyyrpcnu .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #srqyyrpcnu .gt_left { text-align: left; } #srqyyrpcnu .gt_center { text-align: center; } #srqyyrpcnu .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #srqyyrpcnu .gt_font_normal { font-weight: normal; } #srqyyrpcnu .gt_font_bold { font-weight: bold; } #srqyyrpcnu .gt_font_italic { font-style: italic; } #srqyyrpcnu .gt_super { font-size: 65%; } #srqyyrpcnu .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 75%; vertical-align: 0.4em; } #srqyyrpcnu .gt_asterisk { font-size: 100%; vertical-align: 0; } #srqyyrpcnu .gt_indent_1 { text-indent: 5px; } #srqyyrpcnu .gt_indent_2 { text-indent: 10px; } #srqyyrpcnu .gt_indent_3 { text-indent: 15px; } #srqyyrpcnu .gt_indent_4 { text-indent: 20px; } #srqyyrpcnu .gt_indent_5 { text-indent: 25px; } x.x: Study Subject Data x.x.x: Demographic CharacteristicsTable x.x.x.x: Demographic Characteristics - Full Analysis Set A: Drug X N=134 (100%) B: Placebo N=134 (100%) C: Combination N=132 (100%) Age (Years) n 134 134 132 Mean (SD) 33.8 (6.6) 35.4 (7.9) 35.4 (7.7) Median 33 35 35 Min - Max 21 - 50 21 - 62 20 - 69 Sex, n (%) F 79 (59.0) 77 (57.5) 66 (50.0) M 51 (38.1) 55 (41.0) 60 (45.5) U 3 (2.2) 2 (1.5) 4 (3.0) UNDIFFERENTIATED 1 (0.7) 0 2 (1.5) n 134 134 132 Country, n (%) CHN 74 (55.2) 81 (60.4) 64 (48.5) USA 10 (7.5) 13 (9.7) 17 (12.9) BRA 13 (9.7) 7 (5.2) 10 (7.6) PAK 12 (9.0) 9 (6.7) 10 (7.6) NGA 8 (6.0) 7 (5.2) 11 (8.3) RUS 5 (3.7) 8 (6.0) 6 (4.5) JPN 5 (3.7) 4 (3.0) 9 (6.8) GBR 4 (3.0) 3 (2.2) 2 (1.5) CAN 3 (2.2) 2 (1.5) 3 (2.3) n 134 134 132 Source: ADSL DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY 4.1.3 flextable Code # The two steps in creating &#39;Demographic Tables&#39; are: # # - summarize the information with the `flextable::summarizor()` function. # It computes a set of statistics for each variable by groups. It returns # a data.frame ready to be used by `flextable::as_flextable()`. # - Create the flextable with the `as_flextable()` function. resetSession() ex_adsl &lt;- formatters::ex_adsl library(flextable) library(tidyverse) library(officer) set_flextable_defaults( border.color = &quot;#AAAAAA&quot;, font.family = &quot;Open Sans&quot;, font.size = 10, padding = 3, line_spacing = 1.4 ) # data adsl &lt;- select(ex_adsl, AGE, SEX, COUNTRY, ARM) # In the illustration, we use labels from the column attributes. col_labels &lt;- map_chr(adsl, function(x) attr(x, &quot;label&quot;)) # Now let&#39;s use the labels and customize the ‘flextable’ output. ft &lt;- summarizor(adsl, by = &quot;ARM&quot;) |&gt; as_flextable(sep_w = 0, separate_with = &quot;variable&quot;, spread_first_col = TRUE) |&gt; align(i = ~ !is.na(variable), align = &quot;left&quot;) |&gt; prepend_chunks(i = ~ is.na(variable), j =&quot;stat&quot;, as_chunk(&quot;\\t&quot;) ) |&gt; labelizor(j = c(&quot;stat&quot;), labels = col_labels, part = &quot;all&quot;) |&gt; autofit() |&gt; add_header_lines( c(&quot;x.x: Study Subject Data&quot;, &quot;x.x.x: Demographic Characteristics&quot;, &quot;Table x.x.x.x: Demographic Characteristics - Full Analysis Set&quot;)) |&gt; add_footer_lines(&quot;Source: ADSL DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY&quot;) ft .tabwid table{ border-spacing:0px !important; border-collapse:collapse; line-height:1; margin-left:auto; margin-right:auto; border-width: 0; border-color: transparent; caption-side: top; } .tabwid-caption-bottom table{ caption-side: bottom; } .tabwid_left table{ margin-left:0; } .tabwid_right table{ margin-right:0; } .tabwid td, .tabwid th { padding: 0; } .tabwid a { text-decoration: none; } .tabwid thead { background-color: transparent; } .tabwid tfoot { background-color: transparent; } .tabwid table tr { background-color: transparent; } .katex-display { margin: 0 0 !important; } .cl-5a3ccf88{}.cl-5a346f14{font-family:'Open Sans';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5a37f09e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5a37f0a8{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5a37f0b2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5a37f0bc{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5a37f0bd{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5a3809a8{width:2.016in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3809b2{width:0.957in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3809bc{width:1.206in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3809c6{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3809c7{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3809c8{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3809d0{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3809d1{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3809da{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3809db{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3809dc{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3809e4{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3809e5{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3809ee{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3809f8{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3809f9{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 0.75pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a3809fa{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0.75pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a380a02{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0.75pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a380a03{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a380a0c{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a380a0d{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a380a0e{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a380a16{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a380a17{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a380a20{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a380a2a{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a380a2b{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a380a2c{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a380a34{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a380a35{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a380a3e{width:2.016in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a380a48{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a380a49{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a380a52{width:2.016in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a380a5c{width:0.957in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5a380a66{width:1.206in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}x.x: Study Subject Datax.x.x: Demographic CharacteristicsTable x.x.x.x: Demographic Characteristics - Full Analysis SetA: Drug X(N=134)B: Placebo(N=134)C: Combination(N=132)Age&emsp;Mean (SD)33.8 (6.6)35.4 (7.9)35.4 (7.7)&emsp;Median (IQR)33.0 (11.0)35.0 (10.0)35.0 (10.0)&emsp;Range21.0 - 50.021.0 - 62.020.0 - 69.0&emsp;Missing0 (0.00%)0 (0.00%)0 (0.00%)Sex&emsp;F79 (58.96%)77 (57.46%)66 (50.00%)&emsp;M51 (38.06%)55 (41.04%)60 (45.45%)&emsp;U3 (2.24%)2 (1.49%)4 (3.03%)&emsp;UNDIFFERENTIATED1 (0.75%)0 (0.00%)2 (1.52%)&emsp;Missing0 (0.00%)0 (0.00%)0 (0.00%)Country&emsp;CHN74 (55.22%)81 (60.45%)64 (48.48%)&emsp;USA10 (7.46%)13 (9.70%)17 (12.88%)&emsp;BRA13 (9.70%)7 (5.22%)10 (7.58%)&emsp;PAK12 (8.96%)9 (6.72%)10 (7.58%)&emsp;NGA8 (5.97%)7 (5.22%)11 (8.33%)&emsp;RUS5 (3.73%)8 (5.97%)6 (4.55%)&emsp;JPN5 (3.73%)4 (2.99%)9 (6.82%)&emsp;GBR4 (2.99%)3 (2.24%)2 (1.52%)&emsp;CAN3 (2.24%)2 (1.49%)3 (2.27%)&emsp;CHE0 (0.00%)0 (0.00%)0 (0.00%)&emsp;Missing0 (0.00%)0 (0.00%)0 (0.00%)Source: ADSL DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY 4.1.4 tables Code resetSession() ex_adsl &lt;- formatters::ex_adsl library(tables) table_options(doCSS = TRUE) meansd &lt;- function(x) sprintf(&quot;%.1f (%.1f)&quot;, mean(x), sd(x)) iqr &lt;- function(x) quantile(x, 0.75) - quantile(x, 0.25) medianiqr &lt;- function(x) sprintf(&quot;%.1f (%.1f)&quot;, median(x), iqr(x)) minmax &lt;- function(x) sprintf(&quot;%.1f - %.1f&quot;, min(x), max(x)) countpercent &lt;- function(num, denom) sprintf(&quot;%d (%.1f%%)&quot;, length(num), 100*length(num)/length(denom)) tabular( Heading(n)*1 + AGE * (Heading(&quot;Mean (SD)&quot;)*meansd + Heading(&quot;Median (IQR)&quot;)*medianiqr + Heading(&quot;Min - Max&quot;)*minmax) + (SEX + COUNTRY)*Heading()* Percent(denom = Equal(ARM), fn = countpercent) ~ Heading()*ARM, data = ex_adsl ) #table324b5247518d .Rtable thead, .Rtable .even { background-color: inherit; } #table324b5247518d .left { text-align:left; } #table324b5247518d .center { text-align:center; } #table324b5247518d .right { text-align:right; } #table324b5247518d .Rtable, #table324b5247518d .Rtable thead { border-collapse: collapse; border-style: solid; border-width: medium 0; border-color: inherit; } #table324b5247518d .Rtable th, #table324b5247518d .Rtable td { padding-left: 0.5em; padding-right: 0.5em; border-width: 0; } A: Drug X B: Placebo C: Combination n 134 134 132 AGE Mean (SD) 33.8 (6.6) 35.4 (7.9) 35.4 (7.7)   Median (IQR) 33.0 (11.0) 35.0 (10.0) 35.0 (10.0)   Min - Max 21.0 - 50.0 21.0 - 62.0 20.0 - 69.0 SEX F 79 (59.0%) 77 (57.5%) 66 (50.0%) M 51 (38.1%) 55 (41.0%) 60 (45.5%) U 3 (2.2%) 2 (1.5%) 4 (3.0%) UNDIFFERENTIATED 1 (0.7%) 0 (0.0%) 2 (1.5%) COUNTRY CHN 74 (55.2%) 81 (60.4%) 64 (48.5%) USA 10 (7.5%) 13 (9.7%) 17 (12.9%) BRA 13 (9.7%) 7 (5.2%) 10 (7.6%) PAK 12 (9.0%) 9 (6.7%) 10 (7.6%) NGA 8 (6.0%) 7 (5.2%) 11 (8.3%) RUS 5 (3.7%) 8 (6.0%) 6 (4.5%) JPN 5 (3.7%) 4 (3.0%) 9 (6.8%) GBR 4 (3.0%) 3 (2.2%) 2 (1.5%) CAN 3 (2.2%) 2 (1.5%) 3 (2.3%) CHE 0 (0.0%) 0 (0.0%) 0 (0.0%) 4.2 Event Tables We will use the ex_adae data included within the formatters package. Code head(formatters::ex_adae) # A tibble: 6 × 48 STUDYID USUBJID SUBJID SITEID AGE SEX RACE COUNTRY INVID ARM ARMCD &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;chr&gt; &lt;fct&gt; &lt;fct&gt; 1 AB12345 AB12345-BRA… id-134 BRA-1 47 M WHITE BRA BRA-1 A: D… ARM A 2 AB12345 AB12345-BRA… id-134 BRA-1 47 M WHITE BRA BRA-1 A: D… ARM A 3 AB12345 AB12345-BRA… id-134 BRA-1 47 M WHITE BRA BRA-1 A: D… ARM A 4 AB12345 AB12345-BRA… id-134 BRA-1 47 M WHITE BRA BRA-1 A: D… ARM A 5 AB12345 AB12345-BRA… id-141 BRA-1 35 F WHITE BRA BRA-1 C: C… ARM C 6 AB12345 AB12345-BRA… id-141 BRA-1 35 F WHITE BRA BRA-1 C: C… ARM C # … with 37 more variables: ACTARM &lt;fct&gt;, ACTARMCD &lt;fct&gt;, STRATA1 &lt;fct&gt;, # STRATA2 &lt;fct&gt;, BMRKR1 &lt;dbl&gt;, BMRKR2 &lt;fct&gt;, ITTFL &lt;fct&gt;, SAFFL &lt;fct&gt;, # BMEASIFL &lt;fct&gt;, BEP01FL &lt;fct&gt;, RANDDT &lt;date&gt;, TRTSDTM &lt;dttm&gt;, # TRTEDTM &lt;dttm&gt;, EOSSTT &lt;fct&gt;, EOSDT &lt;date&gt;, EOSDY &lt;int&gt;, DCSREAS &lt;fct&gt;, # DTHDT &lt;date&gt;, LSTALVDT &lt;date&gt;, study_duration_secs &lt;dbl&gt;, ASEQ &lt;int&gt;, # AESEQ &lt;int&gt;, AETERM &lt;fct&gt;, AELLT &lt;fct&gt;, AEDECOD &lt;fct&gt;, AEHLT &lt;fct&gt;, # AEHLGT &lt;fct&gt;, AEBODSYS &lt;fct&gt;, AESOC &lt;fct&gt;, AESEV &lt;fct&gt;, AESER &lt;fct&gt;, … 4.2.1 Adverse Events 4.2.1.1 rtables Only Adverse Events by ID Code resetSession() library(rtables) s_events_patients &lt;- function(x, labelstr, .N_col) { in_rows( &quot;Patients with at least one event&quot; = rcell(length(unique(x)) * c(1, 1 / .N_col), format = &quot;xx (xx.xx%)&quot;), &quot;Total number of events&quot; = rcell(length(x), format = &quot;xx&quot;) ) } table_count_per_id &lt;- function(df, termvar = &quot;AEDECOD&quot;, idvar = &quot;USUBJID&quot;) { x &lt;- df[[termvar]] id &lt;- df[[idvar]] counts &lt;- table(x[!duplicated(id)]) in_rows( .list = as.vector(counts), .labels = names(counts) ) } lyt &lt;- basic_table(show_colcounts = TRUE) %&gt;% split_cols_by(&quot;ARM&quot;) %&gt;% analyze(&quot;USUBJID&quot;, afun = s_events_patients) %&gt;% split_rows_by(&quot;AEBODSYS&quot;, child_labels = &quot;visible&quot;, split_fun = trim_levels_in_group(&quot;AEDECOD&quot;)) %&gt;% summarize_row_groups(&quot;USUBJID&quot;, cfun = s_events_patients) %&gt;% analyze(&quot;AEDECOD&quot;, table_count_per_id, show_labels = &quot;hidden&quot;, indent_mod = -1) build_table(lyt, ex_adae, alt_counts_df = ex_adsl) A: Drug X B: Placebo C: Combination (N=134) (N=134) (N=132) ————————————————————————————————————————————————————————————————————————————————— Patients with at least one event 122 (91.04%) 123 (91.79%) 120 (90.91%) Total number of events 609 622 703 cl A.1 Patients with at least one event 78 (58.21%) 75 (55.97%) 89 (67.42%) Total number of events 132 130 160 dcd A.1.1.1.1 41 36 50 dcd A.1.1.1.2 37 39 39 cl B.1 Patients with at least one event 47 (35.07%) 49 (36.57%) 43 (32.58%) Total number of events 56 60 62 dcd B.1.1.1.1 47 49 43 cl B.2 Patients with at least one event 79 (58.96%) 74 (55.22%) 85 (64.39%) Total number of events 129 138 143 dcd B.2.1.2.1 34 31 40 dcd B.2.2.3.1 45 43 45 cl C.1 Patients with at least one event 43 (32.09%) 46 (34.33%) 43 (32.58%) Total number of events 55 63 64 dcd C.1.1.1.3 43 46 43 cl C.2 Patients with at least one event 35 (26.12%) 48 (35.82%) 55 (41.67%) Total number of events 48 53 65 dcd C.2.1.2.1 35 48 55 cl D.1 Patients with at least one event 79 (58.96%) 67 (50.00%) 80 (60.61%) Total number of events 127 106 135 dcd D.1.1.1.1 42 31 40 dcd D.1.1.4.2 37 36 40 cl D.2 Patients with at least one event 47 (35.07%) 58 (43.28%) 57 (43.18%) Total number of events 62 72 74 dcd D.2.1.5.3 47 58 57 4.2.1.2 flextable Code resetSession() ex_adsl &lt;- formatters::ex_adsl ex_adae &lt;- formatters::ex_adae library(flextable) library(tidyr) library(dplyr) library(forcats) ae_tabulator &lt;- function(ADSL, ADAE){ subject_cts &lt;- group_by(ADSL, ARM) |&gt; summarise(n_subject = n()) all_event_total_cts &lt;- group_by(ADAE, ARM) |&gt; summarise(n_usub = n_distinct(USUBJID), n_events = n()) aebodsys_cts &lt;- group_by(ADAE, ARM, AEBODSYS) |&gt; summarise(n_usub = n_distinct(USUBJID), n_events = n(), .groups = &quot;drop&quot;) aedecod_cts &lt;- group_by(ADAE, ARM, AEBODSYS, AEDECOD) |&gt; summarise(n_usub = n_distinct(USUBJID), n_events = n(), .groups = &quot;drop&quot;) x &lt;- bind_rows(all_event_total_cts, aebodsys_cts, aedecod_cts) |&gt; mutate( AEBODSYS = fct_expand(AEBODSYS, &quot;ALL1&quot;) |&gt; fct_relevel(&quot;ALL1&quot;), AEDECOD = fct_expand(AEDECOD, &quot;ALL2&quot;) |&gt; fct_relevel(&quot;ALL2&quot;) ) |&gt; left_join(subject_cts, by = &quot;ARM&quot;) |&gt; replace_na(replace = list(AEBODSYS = &quot;ALL1&quot;, AEDECOD = &quot;ALL2&quot;)) |&gt; arrange(AEBODSYS, AEDECOD) |&gt; mutate(pct = n_usub / n_subject) attr(x, &quot;ARM_COUNTS&quot;) &lt;- setNames(subject_cts$n_subject, subject_cts$ARM) x } # Labels for `flextable::labelizor()`: AEDECOD_LABELS &lt;- c( ALL1 = &quot;Patients with at least one event&quot;, ALL2 = &quot;Patients with at least one event&quot;) HEADER_LABELS &lt;- c( AEDECOD = &quot;dictionary-derived term\\n\\tbody system or organ class&quot;, nevents = &quot;Total number\\nof events&quot;, n = &quot;n\\n(% of subjects)&quot;, &quot;ARM A&quot; = &quot;Treatment A&quot;, &quot;ARM B&quot; = &quot;Treatment B&quot; ) # `tabulator()` call: dat &lt;- ae_tabulator(ADSL = ex_adsl, ADAE = ex_adae) ARM_COUNTS &lt;- attr(dat, &quot;ARM_COUNTS&quot;) tab &lt;- tabulator( dat, rows = c(&quot;AEBODSYS&quot;, &quot;AEDECOD&quot;), columns = &quot;ARM&quot;, `n` = as_paragraph(fmt_n_percent(n_usub, pct)), `nevents` = as_paragraph(n_events) ) .ARM_COUNTS &lt;- ARM_COUNTS # flextable creation: ft &lt;- as_flextable(tab, spread_first_col = TRUE) |&gt; fontsize(size = 9, part = &quot;all&quot;) |&gt; prepend_chunks( i = ~ is.na(AEBODSYS), j = 1, as_chunk(&quot;\\t&quot;) ) for(ARM_COD in names(ARM_COUNTS)){ ft &lt;- append_chunks( x = ft, part = &quot;header&quot;, i = 1, j = tabulator_colnames(tab, columns = &quot;n&quot;, ARM %in% !!ARM_COD), as_chunk(ARM_COUNTS[ARM_COD], formatter = fmt_header_n) ) } ft &lt;- labelizor( ft, j = &quot;AEDECOD&quot;, part = &quot;body&quot;, labels = AEDECOD_LABELS) |&gt; labelizor(part = &quot;header&quot;, labels = HEADER_LABELS) |&gt; align(j = 1, align = &quot;left&quot;) |&gt; autofit() ft .tabwid table{ border-spacing:0px !important; border-collapse:collapse; line-height:1; margin-left:auto; margin-right:auto; border-width: 0; border-color: transparent; caption-side: top; } .tabwid-caption-bottom table{ caption-side: bottom; } .tabwid_left table{ margin-left:0; } .tabwid_right table{ margin-right:0; } .tabwid td, .tabwid th { padding: 0; } .tabwid a { text-decoration: none; } .tabwid thead { background-color: transparent; } .tabwid tfoot { background-color: transparent; } .tabwid table tr { background-color: transparent; } .katex-display { margin: 0 0 !important; } .cl-5b72e61c{}.cl-5b6839f6{font-family:'Open Sans';font-size:9pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5b683a0a{font-family:'Open Sans';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5b6c07fc{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5b6c0810{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-5b6c081a{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5b6c081b{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-5b6c0824{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5b6c082e{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-5b6c082f{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5b6c0838{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-5b6c25ca{width:2.493in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c25d4{width:0.1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c25de{width:1.049in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c25df{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 0.75pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c25e8{width:2.493in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c25f2{width:0.1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c25f3{width:1.049in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c25fc{width:1in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c25fd{width:2.493in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c2606{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c2607{width:1.049in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c2608{width:1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c2609{width:2.493in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c2610{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c2611{width:1.049in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c2612{width:1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c261a{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c2624{width:2.493in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c2625{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c2626{width:1.049in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c262e{width:1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c2638{width:2.493in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c2639{width:1.049in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5b6c2642{width:1in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}dictionary-derived term&emsp;body system or organ classA: Drug X(N=134)B: Placebo(N=134)C: Combination(N=132)n(% of subjects)Total numberof eventsn(% of subjects)Total numberof eventsn(% of subjects)Total numberof eventsPatients with at least one event122 (91.0%)609123 (91.8%)622120 (90.9%)703cl A.1&emsp;Patients with at least one event78 (58.2%)13275 (56.0%)13089 (67.4%)160&emsp;dcd A.1.1.1.150 (37.3%)6445 (33.6%)6263 (47.7%)88&emsp;dcd A.1.1.1.248 (35.8%)6848 (35.8%)6850 (37.9%)72cl B.1&emsp;Patients with at least one event47 (35.1%)5649 (36.6%)6043 (32.6%)62&emsp;dcd B.1.1.1.147 (35.1%)5649 (36.6%)6043 (32.6%)62cl B.2&emsp;Patients with at least one event79 (59.0%)12974 (55.2%)13885 (64.4%)143&emsp;dcd B.2.1.2.149 (36.6%)6544 (32.8%)6252 (39.4%)66&emsp;dcd B.2.2.3.148 (35.8%)6454 (40.3%)7651 (38.6%)77cl C.1&emsp;Patients with at least one event43 (32.1%)5546 (34.3%)6343 (32.6%)64&emsp;dcd C.1.1.1.343 (32.1%)5546 (34.3%)6343 (32.6%)64cl C.2&emsp;Patients with at least one event35 (26.1%)4848 (35.8%)5355 (41.7%)65&emsp;dcd C.2.1.2.135 (26.1%)4848 (35.8%)5355 (41.7%)65cl D.1&emsp;Patients with at least one event79 (59.0%)12767 (50.0%)10680 (60.6%)135&emsp;dcd D.1.1.1.150 (37.3%)6142 (31.3%)5151 (38.6%)71&emsp;dcd D.1.1.4.248 (35.8%)6642 (31.3%)5550 (37.9%)64cl D.2&emsp;Patients with at least one event47 (35.1%)6258 (43.3%)7257 (43.2%)74&emsp;dcd D.2.1.5.347 (35.1%)6258 (43.3%)7257 (43.2%)74 4.2.1.3 tables The tables package normally generates tables from single datasets, while this kind of table requires information from two: adsl and ex_adae. One way to handle this would be to add the adsl patient count information to a copy of the ex_adae table. In this code we use a different approach: we generate one table of patient counts to produce the heading lines, and a second table with the adverse event data, then use rbind to combine the two tables. Code resetSession() library(tables) table_options(doCSS = TRUE) ex_adae &lt;- formatters::ex_adae subject_counts &lt;- table(adsl$ARM) countpercentid &lt;- function(num, ARM) { n &lt;- length(unique(num)) sprintf(&quot;%d (%.2f%%)&quot;, length(unique(num)), 100*n/subject_counts[ARM[1]]) } count &lt;- function(x) sprintf(&quot;(N=%d)&quot;, length(x)) heading &lt;- tabular(Heading(&quot;&quot;)*1* Heading(&quot;&quot;)*count ~ Heading()*ARM, data = adsl) body &lt;- tabular( Heading(&quot;Patients with at least one event&quot;)* countpercentid*Arguments(ARM = ARM)* Heading()*USUBJID + Heading(&quot;Total number of events&quot;)*1 + Heading()*AEBODSYS* (Heading(&quot;Patients with at least one event&quot;)* Percent(denom = ARM, fn = countpercentid)* Heading()*USUBJID + Heading(&quot;Total number of events&quot;)*1 + Heading()*AEDECOD*DropEmpty()) ~ Heading()*ARM, data = ex_adae ) rbind(heading, body) #table324b2e7ce22d .Rtable thead, .Rtable .even { background-color: inherit; } #table324b2e7ce22d .left { text-align:left; } #table324b2e7ce22d .center { text-align:center; } #table324b2e7ce22d .right { text-align:right; } #table324b2e7ce22d .Rtable, #table324b2e7ce22d .Rtable thead { border-collapse: collapse; border-style: solid; border-width: medium 0; border-color: inherit; } #table324b2e7ce22d .Rtable th, #table324b2e7ce22d .Rtable td { padding-left: 0.5em; padding-right: 0.5em; border-width: 0; } A: Drug X B: Placebo C: Combination (N=134) (N=134) (N=132) Patients with at least one event 122 (91.04%) 123 (91.79%) 120 (90.91%) Total number of events 609 622 703 cl A.1 Patients with at least one event 78 (58.21%) 75 (55.97%) 89 (66.42%)   Total number of events 132 130 160   dcd A.1.1.1.1 64 62 88   dcd A.1.1.1.2 68 68 72 cl B.1 Patients with at least one event 47 (35.07%) 49 (36.57%) 43 (32.09%)   Total number of events 56 60 62   dcd B.1.1.1.1 56 60 62 cl B.2 Patients with at least one event 79 (58.96%) 74 (55.22%) 85 (63.43%)   Total number of events 129 138 143   dcd B.2.1.2.1 65 62 66   dcd B.2.2.3.1 64 76 77 cl C.1 Patients with at least one event 43 (32.09%) 46 (34.33%) 43 (32.09%)   Total number of events 55 63 64   dcd C.1.1.1.3 55 63 64 cl C.2 Patients with at least one event 35 (26.12%) 48 (35.82%) 55 (41.04%)   Total number of events 48 53 65   dcd C.2.1.2.1 48 53 65 cl D.1 Patients with at least one event 79 (58.96%) 67 (50.00%) 80 (59.70%)   Total number of events 127 106 135   dcd D.1.1.1.1 61 51 71   dcd D.1.1.4.2 66 55 64 cl D.2 Patients with at least one event 47 (35.07%) 58 (43.28%) 57 (42.54%)   Total number of events 62 72 74   dcd D.2.1.5.3 62 72 74 4.3 Laboratory Tables 4.4 Time to Event Analysis Tables 4.4.1 Data and models used throughout Code resetSession() library(dplyr) library(tidyr) library(stringr) library(purrr) library(survival) data(&quot;cadaette&quot;, package = &quot;random.cdisc.data&quot;) head(cadaette) # A tibble: 6 × 67 STUDYID USUBJID SUBJID SITEID AGE AGEU SEX RACE ETHNIC COUNTRY DTHFL &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;chr&gt; &lt;int&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; &lt;fct&gt; 1 AB12345 AB12345-BR… id-105 BRA-1 38 YEARS M BLAC… HISPA… BRA N 2 AB12345 AB12345-BR… id-105 BRA-1 38 YEARS M BLAC… HISPA… BRA N 3 AB12345 AB12345-BR… id-105 BRA-1 38 YEARS M BLAC… HISPA… BRA N 4 AB12345 AB12345-BR… id-105 BRA-1 38 YEARS M BLAC… HISPA… BRA N 5 AB12345 AB12345-BR… id-105 BRA-1 38 YEARS M BLAC… HISPA… BRA N 6 AB12345 AB12345-BR… id-105 BRA-1 38 YEARS M BLAC… HISPA… BRA N # … with 56 more variables: INVID &lt;chr&gt;, INVNAM &lt;chr&gt;, ARM &lt;fct&gt;, ARMCD &lt;fct&gt;, # ACTARM &lt;fct&gt;, ACTARMCD &lt;fct&gt;, TRT01P &lt;fct&gt;, TRT01A &lt;fct&gt;, TRT02P &lt;fct&gt;, # TRT02A &lt;fct&gt;, REGION1 &lt;fct&gt;, STRATA1 &lt;fct&gt;, STRATA2 &lt;fct&gt;, BMRKR1 &lt;dbl&gt;, # BMRKR2 &lt;fct&gt;, ITTFL &lt;fct&gt;, SAFFL &lt;fct&gt;, BMEASIFL &lt;fct&gt;, BEP01FL &lt;fct&gt;, # AEWITHFL &lt;fct&gt;, RANDDT &lt;date&gt;, TRTSDTM &lt;dttm&gt;, TRTEDTM &lt;dttm&gt;, # TRT01SDTM &lt;dttm&gt;, TRT01EDTM &lt;dttm&gt;, TRT02SDTM &lt;dttm&gt;, TRT02EDTM &lt;dttm&gt;, # AP01SDTM &lt;dttm&gt;, AP01EDTM &lt;dttm&gt;, AP02SDTM &lt;dttm&gt;, AP02EDTM &lt;dttm&gt;, … Code adtte &lt;- cadaette %&gt;% dplyr::filter(PARAMCD == &quot;AETTE2&quot;, SAFFL == &quot;Y&quot;) Cox Proportional Hazard fit: Code cph &lt;- coxph(Surv(AVAL, CNSR==0) ~ TRT01A + STRATA1, ties = &quot;exact&quot;, data = adtte) Kaplan-Meier Model Code surv_tbl &lt;- as.data.frame(summary(survfit(Surv(AVAL, CNSR==0) ~ TRT01A, data = adtte, conf.type = &quot;log-log&quot;))$table) %&gt;% dplyr::mutate(TRT01A = factor(str_remove(row.names(.), &quot;TRT01A=&quot;), levels = levels(adtte$TRT01A)), ind = FALSE) .kmState &lt;- currentState() 4.4.2 rtables Code resetSession(.kmState) library(rtables) cnsr_counter &lt;- function(df, .var, .N_col) { x &lt;- df[!duplicated(df$USUBJID), .var] x &lt;- x[x != &quot;__none__&quot;] lapply(table(x), function(xi) rcell(xi*c(1, 1/.N_col), format = &quot;xx (xx.xx%)&quot;)) } a_count_subjs &lt;- function(x, .N_col) { in_rows(&quot;Subjects with Adverse Events n (%)&quot; = rcell(length(unique(x)) * c(1, 1 / .N_col), format = &quot;xx (xx.xx%)&quot;)) } a_cph &lt;- function(df, .var, .in_ref_col, .ref_full, full_cox_fit) { if(.in_ref_col) { ret &lt;- replicate(3, list(rcell(NULL))) } else { curtrt &lt;- df[[.var]][1] coefs &lt;- coef(full_cox_fit) sel_pos &lt;- grep(curtrt, names(coefs), fixed = TRUE) hrval &lt;- exp(coefs[sel_pos]) hrvalret &lt;- rcell(hrval, format = &quot;xx.x&quot;) sdf &lt;- survdiff(Surv(AVAL, CNSR==0) ~ TRT01A + STRATA1, data = rbind(df, .ref_full)) pval &lt;- (1-pchisq(sdf$chisq, length(sdf$n)-1))/2 ci_val &lt;- exp(unlist(confint(full_cox_fit)[sel_pos,])) ret &lt;- list(rcell(hrval, format = &quot;xx.x&quot;), rcell(ci_val, format = &quot;(xx.x, xx.x)&quot;), rcell(pval, format = &quot;x.xxxx | (&lt;0.0001)&quot;)) } in_rows(.list = ret, .names = c(&quot;Hazard ratio&quot;, &quot;95% confidence interval&quot;, &quot;p-value (one-sided stratified log rank)&quot;)) } a_tte &lt;- function(df, .var, kp_table) { ind &lt;- grep(df[[.var]][1], row.names(kp_table), fixed = TRUE) minmax &lt;- range(df[[&quot;AVAL&quot;]]) mm_val_str &lt;- format_value(minmax, format = &quot;xx.x, xx.x&quot;) rowfn &lt;- list() if(all(df$CNSR[df$AVAL == minmax[2]])) { mm_val_str &lt;- paste0(mm_val_str, &quot;*&quot;) rowfn &lt;- &quot;* indicates censoring&quot; } in_rows(Median = kp_table[ind, &quot;median&quot;, drop = TRUE], &quot;95% confidence interval&quot; = unlist(kp_table[ind, c(&quot;0.95LCL&quot;, &quot;0.95UCL&quot;)]), &quot;Min Max&quot; = mm_val_str, .formats = c(&quot;xx.xx&quot;, &quot;xx.xx - xx.xx&quot;, &quot;xx&quot;), .row_footnotes = list(NULL, NULL, rowfn)) } adtte2 &lt;- adtte %&gt;% mutate(CNSDTDSC = ifelse(CNSDTDSC == &quot;&quot;, &quot;__none__&quot;, CNSDTDSC)) lyt &lt;- basic_table(show_colcounts = TRUE, title = &quot;x.x: Safety Data&quot;, subtitles = c(&quot;x.x.x: Time to First Serious Adverse Event&quot;, &quot;Table x.x.x.x: Safety Endpoint - Safety Analysis Set&quot;), main_footer = c(&quot;Serious adverse events are defines as (...). All p-values are exploratory.&quot;, &quot;Hazard ratios are from a stratified Cox model of serious adverse event hazard rate,&quot;, &quot;with terms for treatment groups and strata1. Ties were handled using the exact&quot;, &quot;method. Hazard ratios of Placebo Combination over Drug X are presented, an&quot;, &quot;HR &lt; 1 denotes improvement compared to Drug X.&quot;), prov_footer = &quot;Source: ADTTE DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY&quot;) %&gt;% ## column faceting split_cols_by(&quot;ARM&quot;, ref_group = &quot;A: Drug X&quot;) %&gt;% ## overall count analyze(&quot;USUBJID&quot;, a_count_subjs, show_labels = &quot;hidden&quot;) %&gt;% ## Censored Subjects Summary analyze(&quot;CNSDTDSC&quot;, cnsr_counter, var_labels = &quot;Censored Subjects&quot;, show_labels = &quot;visible&quot;) %&gt;% ## CPH analysis analyze(&quot;ARM&quot;, a_cph, extra_args = list(full_cox_fit = cph), show_labels = &quot;hidden&quot;) %&gt;% ## Time-to-event analysis analyze(&quot;ARM&quot;, a_tte, var_labels = &quot;Time to first adverse event&quot;, show_labels = &quot;visible&quot;, extra_args = list(kp_table = surv_tbl), table_names = &quot;kapmeier&quot;) tbl_tte &lt;- build_table(lyt, adtte2) fnotes_at_path(tbl_tte, c(&quot;ma_USUBJID_CNSDTDSC_ARM_kapmeier&quot;, &quot;kapmeier&quot;)) &lt;- &quot;Product-limit (Kaplan-Meier) estimates.&quot; tbl_tte x.x: Safety Data x.x.x: Time to First Serious Adverse Event Table x.x.x.x: Safety Endpoint - Safety Analysis Set ———————————————————————————————————————————————————————————————————————————————————————— A: Drug X B: Placebo C: Combination (N=134) (N=134) (N=132) ———————————————————————————————————————————————————————————————————————————————————————— Subjects with Adverse Events n (%) 134 (100.00%) 134 (100.00%) 132 (100.00%) Censored Subjects Clinical Cut Off 10 (7.46%) 4 (2.99%) 14 (10.61%) Completion or Discontinuation 13 (9.70%) 3 (2.24%) 16 (12.12%) End of AE Reporting Period 22 (16.42%) 4 (2.99%) 14 (10.61%) Hazard ratio 1.5 1.1 95% confidence interval (1.1, 1.9) (0.8, 1.5) p-value (one-sided stratified log rank) 0.0208 0.4619 Time to first adverse event {1} Median 0.39 0.37 0.26 95% confidence interval 0.23 - 0.60 0.25 - 0.46 0.18 - 0.34 Min Max {2} 0.0, 3.0* 0.0, 3.0* 0.0, 3.0* ———————————————————————————————————————————————————————————————————————————————————————— {1} - Product-limit (Kaplan-Meier) estimates. {2} - * indicates censoring ———————————————————————————————————————————————————————————————————————————————————————— Serious adverse events are defines as (...). All p-values are exploratory. Hazard ratios are from a stratified Cox model of serious adverse event hazard rate, with terms for treatment groups and strata1. Ties were handled using the exact method. Hazard ratios of Placebo Combination over Drug X are presented, an HR &lt; 1 denotes improvement compared to Drug X. Source: ADTTE DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY 4.4.3 Cell Value Derivation for gt of Time to Event Analysis Our standard TTE table consists of (a derivation of) four main parts: Descriptive stats including the number of subjects with an event, number of subjects censored and censoring reasons Hazard ratio with corresponding 95% CI from a (stratified) Cox model and a p-value from a stratified log rank test Median time to event Kaplan-Meier analysis Number of patients at risk at specified visits from Kaplan-Meier analysis (omitted here). Code resetSession(.kmState) library(gt) ### Subject Count with events ## surv_tbl calculated above subj_count &lt;- surv_tbl %&gt;% dplyr::mutate(pct = sprintf(&quot;%i (%5.1f)&quot;, events, 100*events/records), label = &quot;Number of subjects with serious adverse event, n (%)&quot;) %&gt;% dplyr::select(label, TRT01A, pct) %&gt;% tidyr::pivot_wider(id_cols = label, names_from = TRT01A, values_from = pct) %&gt;% dplyr::mutate(ind = FALSE) # Number of censored subjects cnsrd_subj_full &lt;- surv_tbl %&gt;% dplyr::mutate(pct = sprintf(&quot;%i (%4.1f)&quot;, records-events, 100*(records-events)/records), CNSDTDSC = &quot;Number of censored subjects, n (%)&quot;) %&gt;% dplyr::select(CNSDTDSC, TRT01A, pct) cnsrd_subj &lt;- adtte %&gt;% dplyr::group_by(TRT01A) %&gt;% dplyr::mutate(CNSR = CNSR/n()) %&gt;% dplyr::ungroup() %&gt;% dplyr::filter(CNSR != 0) %&gt;% dplyr::group_by(TRT01A, CNSDTDSC) %&gt;% dplyr::summarise(pct = sprintf(&quot;%i (%4.1f)&quot;, sum(CNSR != 0), 100*sum(CNSR))) %&gt;% dplyr::ungroup() %&gt;% dplyr::bind_rows(cnsrd_subj_full, .) %&gt;% tidyr::pivot_wider(id_cols = CNSDTDSC, names_from = TRT01A, values_from = pct) %&gt;% dplyr::rename(label = CNSDTDSC) %&gt;% dplyr::mutate(ind = label != &quot;Number of censored subjects, n (%)&quot;) %&gt;% dplyr::arrange(ind) Code ## cph calculated above hr &lt;- exp(coef(cph)) ci_hr &lt;- exp(confint(cph)) # Hazard ratio and 95% CI df_hr &lt;- cbind(ci_hr, hr) %&gt;% as.data.frame() %&gt;% dplyr::filter(grepl(&quot;TRT01A&quot;, row.names(.))) %&gt;% dplyr::mutate(TRT01A = factor(str_remove(row.names(.), &quot;TRT01A&quot;)), ci = sprintf(&quot;[%4.1f, %4.1f]&quot;, round(!!sym(&quot;2.5 %&quot;), 1), round(!!sym(&quot;97.5 %&quot;), 1))) %&gt;% dplyr::select(TRT01A, hr, ci) # Log rank p-value log_rank_test &lt;- purrr::map_df(.x = list(c(&quot;A: Drug X&quot;, &quot;B: Placebo&quot;), c(&quot;A: Drug X&quot;, &quot;C: Combination&quot;)), .f = ~{sdf &lt;- survdiff(Surv(AVAL, CNSR==0) ~ TRT01A + STRATA1, data = adtte %&gt;% dplyr::filter(TRT01A %in% .x)); data.frame(TRT01A = .x[2], pval = (1-pchisq(sdf$chisq, length(sdf$n)-1))/2)}) df_hr_comp &lt;- merge(df_hr, log_rank_test, by = &quot;TRT01A&quot;) %&gt;% dplyr::mutate(hr = sprintf(&quot;%4.1f&quot;, round(hr, 1)), pval = ifelse(pval &lt; 0.0001, &quot;&lt;0.0001&quot;, sprintf(&quot;%6.4f&quot;, round(pval, 4)))) %&gt;% tidyr::pivot_longer(cols = c(hr, ci, pval), names_to = &quot;label&quot;, values_to = &quot;val&quot;) %&gt;% tidyr::pivot_wider(names_from = TRT01A, values_from = &quot;val&quot;) %&gt;% dplyr::mutate(label = dplyr::recode(label, &quot;hr&quot; = &quot;Hazard ratio&quot;, &quot;ci&quot; = &quot;95% confidence interval&quot;, &quot;pval&quot; = &quot;p-value (one-sided stratified log rank)&quot;), ind = FALSE) Code median_survtime &lt;- surv_tbl %&gt;% dplyr::mutate(ci = sprintf(&quot;[%4.2f, %4.2f]&quot;, !!sym(&quot;0.95LCL&quot;), !!sym(&quot;0.95UCL&quot;)), median = sprintf(&quot;%4.2f&quot;, median), id = &quot;&quot;) %&gt;% dplyr::select(TRT01A, id, median, ci) %&gt;% tidyr::pivot_longer(cols = c(id, median, ci), names_to = &quot;label&quot;, values_to = &quot;val&quot;) %&gt;% tidyr::pivot_wider(names_from = TRT01A, values_from = val) %&gt;% dplyr::mutate(ind = label != &quot;id&quot;, label = dplyr::recode(label, &quot;median&quot; = &quot;Median (years)&quot;, &quot;ci&quot; = &quot;95% confidence interval&quot;, &quot;id&quot; = &quot;Time to first serious adverse event (a)&quot;)) min_max &lt;- adtte %&gt;% dplyr::filter(!(AVAL == 0 &amp; CNSR == 1)) %&gt;% dplyr::group_by(TRT01A) %&gt;% dplyr::mutate(max_cnsr = !is.na(AVAL) &amp; AVAL == max(AVAL, na.rm = TRUE) &amp; CNSR == 1) %&gt;% dplyr::summarise(min_max = sprintf(&quot;%4.2f, %4.2f%s&quot;, min(AVAL, na.rm = TRUE), max(AVAL, na.rm = TRUE), ifelse(sum(max_cnsr) &gt; 0, &quot;*&quot;, &quot;&quot;))) %&gt;% dplyr::ungroup() %&gt;% tidyr::pivot_wider(names_from = TRT01A, values_from = min_max) %&gt;% dplyr::mutate(label = &quot;Min, Max (b)&quot;, ind = TRUE) model_sum &lt;- dplyr::bind_rows(subj_count, cnsrd_subj, df_hr_comp, median_survtime, min_max) 4.4.4 gt Code header_n &lt;- adtte %&gt;% dplyr::group_by(TRT01A) %&gt;% dplyr::summarise(TRT = sprintf(&quot;%s&lt;br&gt;N=%i (100%%)&quot;, unique(TRT01A), n())) %&gt;% dplyr::ungroup() ### Begin table creation gt(model_sum) %&gt;% cols_hide(ind) %&gt;% tab_header( title = &quot;x.x: Safety Data&quot;, subtitle = html(&quot;x.x.x: Time to First Serious Adverse Event&lt;br&gt;Table x.x.x.x: Safety Endpoint - Safety Analysis Set&quot;), preheader = c(&quot;Protocol: XXXXX&quot;, &quot;Cutoff date: DDMMYYYY&quot;) ) %&gt;% tab_source_note(&quot;Source: ADTTE DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY&quot;) %&gt;% opt_align_table_header(align = &quot;left&quot;) %&gt;% cols_align(align = c(&quot;center&quot;), columns = c(&quot;A: Drug X&quot;, &quot;B: Placebo&quot;, &quot;C: Combination&quot;)) %&gt;% cols_align(align = &quot;left&quot;, columns = &quot;label&quot;) %&gt;% tab_style(style = cell_text(indent = pct(5)), locations = cells_body(columns = 1, rows = ind == TRUE)) %&gt;% sub_missing(columns = everything(), missing_text = &quot;&quot;) %&gt;% cols_label(&quot;label&quot; = &quot;&quot;, &quot;A: Drug X&quot; = html(header_n$TRT[1]), &quot;B: Placebo&quot; = html(header_n$TRT[2]), &quot;C: Combination&quot; = html(header_n$TRT[3])) %&gt;% tab_footnote(footnote = html(&quot;Serious adverse events are defines as (...). All p-values are exploratory.&lt;br&gt;(a) Product-limit (Kaplan-Meier) estimates. &lt;br&gt;(b) Minimum and maximum of event times. * Denotes censoring.&lt;br&gt;Hazard ratios are from a stratified Cox model of serious adverse event hazard rate, with terms for treatment groups and strata1. Ties were handled using the exact method. Hazard ratios of Placebo/ Combination over Drug X are presented, a HR &lt; 1 denotes improvement compared to Drug X.&quot;)) %&gt;% tab_options( table.font.names = &quot;Courier new&quot;, table.font.size = 9, page.orientation = &quot;landscape&quot;, page.numbering = TRUE, page.header.use_tbl_headings = TRUE, page.footer.use_tbl_notes = TRUE) html { font-family: 'Courier new'; } #pekqqgdswz .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 9px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #pekqqgdswz .gt_heading { background-color: #FFFFFF; text-align: left; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #pekqqgdswz .gt_caption { padding-top: 4px; padding-bottom: 4px; } #pekqqgdswz .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #pekqqgdswz .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #pekqqgdswz .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #pekqqgdswz .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #pekqqgdswz .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #pekqqgdswz .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #pekqqgdswz .gt_column_spanner_outer:first-child { padding-left: 0; } #pekqqgdswz .gt_column_spanner_outer:last-child { padding-right: 0; } #pekqqgdswz .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #pekqqgdswz .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #pekqqgdswz .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #pekqqgdswz .gt_from_md > :first-child { margin-top: 0; } #pekqqgdswz .gt_from_md > :last-child { margin-bottom: 0; } #pekqqgdswz .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #pekqqgdswz .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; } #pekqqgdswz .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; } #pekqqgdswz .gt_row_group_first td { border-top-width: 2px; } #pekqqgdswz .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #pekqqgdswz .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #pekqqgdswz .gt_first_summary_row.thick { border-top-width: 2px; } #pekqqgdswz .gt_last_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #pekqqgdswz .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #pekqqgdswz .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #pekqqgdswz .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #pekqqgdswz .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #pekqqgdswz .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #pekqqgdswz .gt_footnote { margin: 0px; font-size: 90%; padding-left: 4px; padding-right: 4px; padding-left: 5px; padding-right: 5px; } #pekqqgdswz .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #pekqqgdswz .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #pekqqgdswz .gt_left { text-align: left; } #pekqqgdswz .gt_center { text-align: center; } #pekqqgdswz .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #pekqqgdswz .gt_font_normal { font-weight: normal; } #pekqqgdswz .gt_font_bold { font-weight: bold; } #pekqqgdswz .gt_font_italic { font-style: italic; } #pekqqgdswz .gt_super { font-size: 65%; } #pekqqgdswz .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 75%; vertical-align: 0.4em; } #pekqqgdswz .gt_asterisk { font-size: 100%; vertical-align: 0; } #pekqqgdswz .gt_indent_1 { text-indent: 5px; } #pekqqgdswz .gt_indent_2 { text-indent: 10px; } #pekqqgdswz .gt_indent_3 { text-indent: 15px; } #pekqqgdswz .gt_indent_4 { text-indent: 20px; } #pekqqgdswz .gt_indent_5 { text-indent: 25px; } x.x: Safety Data x.x.x: Time to First Serious Adverse EventTable x.x.x.x: Safety Endpoint - Safety Analysis Set A: Drug XN=134 (100%) B: PlaceboN=134 (100%) C: CombinationN=132 (100%) Number of subjects with serious adverse event, n (%) 89 ( 66.4) 123 ( 91.8) 88 ( 66.7) Number of censored subjects, n (%) 45 (33.6) 11 ( 8.2) 44 (33.3) Clinical Cut Off 10 ( 7.5) 4 ( 3.0) 14 (10.6) Completion or Discontinuation 13 ( 9.7) 3 ( 2.2) 16 (12.1) End of AE Reporting Period 22 (16.4) 4 ( 3.0) 14 (10.6) Hazard ratio 1.5 1.1 95% confidence interval [ 1.1, 1.9] [ 0.8, 1.5] p-value (one-sided stratified log rank) 0.0208 0.4619 Time to first serious adverse event (a) Median (years) 0.39 0.37 0.26 95% confidence interval [0.23, 0.60] [0.25, 0.46] [0.18, 0.34] Min, Max (b) 0.00, 3.00* 0.01, 3.00* 0.00, 3.00* Source: ADTTE DDMMYYYY hh:mm; Listing x.xx; SDTM package: DDMMYYYY Serious adverse events are defines as (...). All p-values are exploratory.(a) Product-limit (Kaplan-Meier) estimates. (b) Minimum and maximum of event times. * Denotes censoring.Hazard ratios are from a stratified Cox model of serious adverse event hazard rate, with terms for treatment groups and strata1. Ties were handled using the exact method. Hazard ratios of Placebo/ Combination over Drug X are presented, a HR 4.4.5 flextable Code resetSession(.kmState) ARM_COUNTS &lt;- .ARM_COUNTS # Restore from previous section library(flextable) library(tidyverse) # labels and notes ---- # named vectors that will be used later as # labels for the table. description_labels &lt;- c(SAE = &quot;Number of subjects with serious adverse event&quot;, CENSOR_EVENTS = &quot;Number of censored subjects&quot;, HAZARD_RATIO = &quot;Hazard ratio&quot;, TTF_SAE = &quot;Time to first adverse event&quot;) subdescription_labels &lt;- c(subdescription = &quot;&quot;, ALL = &quot;Censored Subjects&quot;, EST = &quot;Estimate&quot;, CONFINT = &quot;95% confidence interval&quot;, PVALUE = &quot;one-sided stratified log rank p-value&quot;, MEDIAN = &quot;Median&quot;, RANGE = &quot;Min Max&quot;) labels &lt;- c(description_labels, subdescription_labels) additional_notes &lt;- c( &quot;Serious adverse events are defines as (...). All p-values are exploratory.&quot;, paste(&quot;Hazard ratios are from a stratified Cox model&quot;, &quot;of serious adverse event hazard rate, with terms for treatment groups and strata1.&quot;, &quot;Ties were handled using the exact method. Hazard ratios of Placebo/ Combination over&quot;, &quot;Drug X are presented, a HR &lt; 1 denotes improvement compared to Drug X.&quot;)) titles &lt;- c( &quot;x.x: Safety Data&quot;, &quot;x.x.x: Time to First Serious Adverse Event&quot;, &quot;Table x.x.x.x: Safety Endpoint - Safety Analysis Set&quot;) # Data need to be prepared in a single data.frame, # a function is written to make the code simplier to organize. #&#39; @noRd #&#39; @description create a data.frame made of #&#39; several sub data.frame, each for a specific #&#39; calculation. Final result has two specific columns #&#39; &#39;description&#39; and &#39;subdescription&#39; that will #&#39; contain various labels or group labels. prepare_tte_df &lt;- function(adtte, cph, surv_tbl) { ## Number of subjects with serious adverse event ---- subj_count &lt;- surv_tbl |&gt; select(TRT01A, n = events, records) |&gt; mutate(pct = n / records, description = &quot;SAE&quot;, subdescription = &quot;ALL&quot;) ## Number of censored subjects ---- subj_censored &lt;- subj_count |&gt; mutate( n = records - n, pct = 1 - pct, description = &quot;CENSOR_EVENTS&quot;, subdescription = &quot;ALL&quot; ) ## Number of censored subjects - detail per CNSDTDSC ---- subj_censored_detail &lt;- adtte |&gt; filter(CNSR &gt; 0) |&gt; count(TRT01A, CNSDTDSC) |&gt; left_join(subj_count |&gt; select(TRT01A, records), by = &quot;TRT01A&quot;) |&gt; mutate(pct = n / records, description = &quot;CENSOR_EVENTS&quot;) |&gt; rename(subdescription = &quot;CNSDTDSC&quot;) ## Hazard ratio and 95% CI ---- coefs_hr &lt;- cbind(exp(confint(cph)), y = exp(coef(cph))) |&gt; as.data.frame() |&gt; rownames_to_column(var = &quot;TRT01A&quot;) |&gt; filter(grepl(&quot;TRT01A&quot;, TRT01A)) |&gt; mutate(TRT01A = str_replace(TRT01A, &quot;TRT01A&quot;, &quot;&quot;)) hr_dat &lt;- bind_rows( select(coefs_hr, TRT01A, LCL = `2.5 %`, UCL = `97.5 %`) |&gt; mutate(description = &quot;HAZARD_RATIO&quot;, subdescription = &quot;CONFINT&quot;), select(coefs_hr, TRT01A, y) |&gt; mutate(description = &quot;HAZARD_RATIO&quot;, subdescription = &quot;EST&quot;) ) ## p-value (one-sided stratified log rank) ---- pval_dat &lt;- purrr::map_df( .x = list(c(&quot;A: Drug X&quot;, &quot;B: Placebo&quot;), c(&quot;A: Drug X&quot;, &quot;C: Combination&quot;)), .f = ~ { sdf &lt;- survdiff(Surv(AVAL, CNSR == 0) ~ TRT01A + STRATA1, data = adtte |&gt; dplyr::filter(TRT01A %in% .x)) data.frame(TRT01A = .x[2], description = &quot;HAZARD_RATIO&quot;, subdescription = &quot;PVALUE&quot;, y = (1 - pchisq(sdf$chisq, length(sdf$n) - 1)) / 2) } ) ## Time to first serious adverse event ---- tfe_dat &lt;- bind_rows( surv_tbl |&gt; select(TRT01A, LCL = `0.95LCL`, UCL = `0.95UCL`) |&gt; mutate(description = &quot;TTF_SAE&quot;, subdescription = &quot;CONFINT&quot;), surv_tbl |&gt; select(TRT01A, y = median) |&gt; mutate(description = &quot;TTF_SAE&quot;, subdescription = &quot;MEDIAN&quot;), adtte |&gt; filter(!(AVAL == 0 &amp; CNSR == 1)) |&gt; group_by(TRT01A) |&gt; mutate(max_cnsr = !is.na(AVAL) &amp; AVAL == max(AVAL, na.rm = TRUE) &amp; CNSR == 1) |&gt; summarise( min = min(AVAL, na.rm = TRUE), max = max(AVAL, na.rm = TRUE), is_censored = sum(max_cnsr) &gt; 0, description = &quot;TTF_SAE&quot;, subdescription = &quot;RANGE&quot; ) ) cnsdtdsc_levels &lt;- unique(adtte$CNSDTDSC) |&gt; sort() |&gt; setdiff(&quot;&quot;) dat &lt;- bind_rows(subj_count, subj_censored, subj_censored_detail, hr_dat, pval_dat, tfe_dat) |&gt; as_tibble() |&gt; ## factor for easy ordering ---- mutate( description = factor(description, levels = c(&quot;SAE&quot;, &quot;CENSOR_EVENTS&quot;, &quot;HAZARD_RATIO&quot;, &quot;TTF_SAE&quot;)), subdescription = factor(subdescription, levels = c(&quot;ALL&quot;, cnsdtdsc_levels, &quot;NUSUBJID&quot;, &quot;MEDIAN&quot;, &quot;EST&quot;, &quot;CONFINT&quot;, &quot;PVALUE&quot;, &quot;RANGE&quot;))) dat } dat &lt;- prepare_tte_df(adtte, cph, surv_tbl) # Now data.frame is ready to be formatted with `fmt_time_to_event()`. # The function handle each special cases to be covered so that # the four main parts are formatted as expected. library(glue) library(dplyr) # format fun ---- fmt_time_to_event &lt;- function(description, subdescription, y, cts, pcts, LCL, UCL, min, max, is_censored) { case_when( !is.na(cts) &amp; !is.na(pcts) ~ glue(&#39;{sprintf(&quot;%.0f&quot;, cts)} ({sprintf(&quot;%.02f&quot;, pcts*100)}%)&#39;), !is.na(y) &amp; !subdescription %in% &quot;PVALUE&quot; ~ glue(&#39;{sprintf(&quot;%.02f&quot;, y)}&#39;), !is.na(y) &amp; subdescription %in% &quot;PVALUE&quot; ~ glue(&quot;{scales::label_pvalue()(y)}&quot;), !is.na(LCL) &amp; !is.na(UCL) ~ glue(&#39;[{sprintf(&quot;%.02f&quot;, LCL)}, {sprintf(&quot;%.02f&quot;, UCL)}]&#39;), !is.na(LCL) &amp; !is.na(UCL) ~ glue(&#39;[{sprintf(&quot;%.02f&quot;, LCL)}, {sprintf(&quot;%.02f&quot;, UCL)}]&#39;), !is.na(min) &amp; !is.na(max) &amp; is_censored ~ glue(&#39;{sprintf(&quot;%.02f&quot;, min)}, {sprintf(&quot;%.02f&quot;, max)}*&#39;), !is.na(min) &amp; !is.na(max) &amp; !is_censored ~ glue(&#39;{sprintf(&quot;%.02f&quot;, min)}, {sprintf(&quot;%.02f&quot;, max)}&#39;), TRUE ~ &quot;&quot; ) } # use `tabulator()` and `as_flextable()` together to create the table. tab &lt;- tabulator(dat, rows = c(&quot;description&quot;, &quot;subdescription&quot;), columns = &quot;TRT01A&quot;, content_cell = as_paragraph( fmt_time_to_event( description = description, subdescription = subdescription, y = y, cts = n, pcts = pct, LCL = LCL, UCL = UCL, min = min, max = max, is_censored = is_censored)) ) ft &lt;- as_flextable(x = tab, spread_first_col = TRUE, separate_with = &quot;description&quot;, sep_w = 0) |&gt; # footnotes footnote( j = 1, i = ~ description %in% c(&quot;CENSOR_EVENTS&quot;, &quot;SAE&quot;), ref_symbols = &quot; (1)&quot;, value = as_paragraph(&quot; Number of subjects (% of subjects)&quot;) ) |&gt; footnote( j = 1, i = ~ description %in% &quot;TTF_SAE&quot; &amp; is.na(subdescription), ref_symbols = &quot; (2)&quot;, value = as_paragraph(&quot; Product-limit (Kaplan-Meier) estimates.&quot;) ) |&gt; footnote( j = 1, i = ~ subdescription %in% &quot;RANGE&quot;, ref_symbols = &quot; (3)&quot;, value = as_paragraph(&quot; * indicates censoring&quot;) ) |&gt; add_footer_lines(values = additional_notes) |&gt; # labels labelizor(j = &quot;subdescription&quot;, labels = labels, part = &quot;all&quot;) |&gt; # indentation prepend_chunks(i = ~ is.na(description), j = &quot;subdescription&quot;, as_chunk(&quot;\\t&quot;)) |&gt; align(i = ~ !is.na(description), align = &quot;left&quot;) |&gt; autofit() |&gt; add_header_lines(values = titles) |&gt; hline_top(part = &quot;header&quot;, border = fp_border_default(width = 0)) |&gt; hline(part = &quot;header&quot;, i = 1:2, border = fp_border_default(width = 0)) for (ARM_COD in names(ARM_COUNTS)) { ft &lt;- append_chunks(x = ft, part = &quot;header&quot;, i = 4, j = tabulator_colnames(tab, columns = &quot;content_cell&quot;, TRT01A %in% !!ARM_COD), as_chunk(ARM_COUNTS[ARM_COD], formatter = fmt_header_n)) } ft .tabwid table{ border-spacing:0px !important; border-collapse:collapse; line-height:1; margin-left:auto; margin-right:auto; border-width: 0; border-color: transparent; caption-side: top; } .tabwid-caption-bottom table{ caption-side: bottom; } .tabwid_left table{ margin-left:0; } .tabwid_right table{ margin-right:0; } .tabwid td, .tabwid th { padding: 0; } .tabwid a { text-decoration: none; } .tabwid thead { background-color: transparent; } .tabwid tfoot { background-color: transparent; } .tabwid table tr { background-color: transparent; } .katex-display { margin: 0 0 !important; } .cl-5db3a66e{}.cl-5dab8b6e{font-family:'Open Sans';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5dab8b82{font-family:'Open Sans';font-size:6pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3pt;}.cl-5daef43e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5daef448{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5daef452{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5daef453{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5daef45c{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5daf0bb8{width:3.345in;background-color:transparent;vertical-align: bottom;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0bc2{width:0.957in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0bc3{width:1.036in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0bcc{width:1.206in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0bcd{width:3.345in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0bd6{width:0.957in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0bd7{width:1.036in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0bd8{width:1.206in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0be0{width:3.345in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0be1{width:0.957in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0bea{width:1.036in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0beb{width:1.206in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0bf4{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0bf5{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0bfe{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c08{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c09{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c12{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c1c{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c1d{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c1e{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c26{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c27{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c30{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c31{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c3a{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c44{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c4e{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c4f{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 0.75pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c58{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0.75pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c59{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 0.75pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c62{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0.75pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c6c{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c6d{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c76{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c77{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c80{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c81{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c82{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c8a{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c8b{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c94{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c95{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c9e{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0.75pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0c9f{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0ca8{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0ca9{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0cb2{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0cb3{width:3.345in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0cbc{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0cc6{width:1.036in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0cc7{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0cd0{width:3.345in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0cd1{width:0.957in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0cd2{width:1.036in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5daf0cda{width:1.206in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(255, 255, 255, 0.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}x.x: Safety Datax.x.x: Time to First Serious Adverse EventTable x.x.x.x: Safety Endpoint - Safety Analysis SetA: Drug X(N=134)B: Placebo(N=134)C: Combination(N=132)Number of subjects with serious adverse event (1)89 (66.42%)123 (91.79%)88 (66.67%)Number of censored subjects (1)&emsp;Censored Subjects45 (33.58%)11 (8.21%)44 (33.33%)&emsp;Clinical Cut Off10 (7.46%)4 (2.99%)14 (10.61%)&emsp;Completion or Discontinuation13 (9.70%)3 (2.24%)16 (12.12%)&emsp;End of AE Reporting Period22 (16.42%)4 (2.99%)14 (10.61%)Hazard ratio&emsp;Estimate1.461.09&emsp;95% confidence interval[1.11, 1.92][0.81, 1.47]&emsp;one-sided stratified log rank p-value0.0210.462Time to first adverse event (2)&emsp;Median0.390.370.26&emsp;95% confidence interval[0.23, 0.60][0.25, 0.46][0.18, 0.34]&emsp;Min Max (3)0.00, 3.00*0.01, 3.00*0.00, 3.00* (1) Number of subjects (% of subjects) (2) Product-limit (Kaplan-Meier) estimates. (3) * indicates censoringSerious adverse events are defines as (...). All p-values are exploratory.Hazard ratios are from a stratified Cox model of serious adverse event hazard rate, with terms for treatment groups and strata1. Ties were handled using the exact method. Hazard ratios of Placebo/ Combination over Drug X are presented, a HR &lt; 1 denotes improvement compared to Drug X. 4.4.6 tables Code resetSession(.kmState) library(tables) table_options(doCSS = TRUE) ex_adae &lt;- formatters::ex_adae subject_counts &lt;- table(adsl$ARM) countpercentid &lt;- function(num, ARM) { n &lt;- length(unique(num)) sprintf(&quot;%d (%.2f%%)&quot;, length(unique(num)), 100*n/subject_counts[ARM[1]]) } valuepercent &lt;- function(x, ARM) { sprintf(&quot;%d (%.2f%%)&quot;, x, 100*x/subject_counts[ARM] ) } blanks &lt;- function(x) &quot;&quot; count &lt;- function(x) sprintf(&quot;(N=%d)&quot;, length(x)) hazardratio &lt;- function(ARM) { entry &lt;- paste0(&quot;TRT01A&quot;, ARM) coef &lt;- coef(cph) if (entry %in% names(coef)) sprintf(&quot;%.1f&quot;, exp(coef[entry])) else &quot;&quot; } hazardratioconfint &lt;- function(ARM) { entry &lt;- paste0(&quot;TRT01A&quot;, ARM) confint &lt;- confint(cph) if (entry %in% rownames(confint)) { confint &lt;- as.numeric(confint[entry,]) sprintf(&quot;(%.1f, %.1f)&quot;, exp(confint[1]), exp(confint[2])) } else &quot;&quot; } hazardpvalue &lt;- function(ARM) { if (ARM == &quot;A: Drug X&quot;) &quot;&quot; else { twogroups &lt;- c(&quot;A: Drug X&quot;, ARM) sdf &lt;- survdiff(Surv(AVAL, CNSR==0) ~ TRT01A + STRATA1, data = adtte, subset = TRT01A %in% twogroups) pval &lt;- (1-pchisq(sdf$chisq, length(sdf$n)-1))/2 sprintf(&quot;%.4f&quot;, pval) } } Median &lt;- function(ARM) { vals &lt;- subset(surv_tbl, TRT01A == ARM) sprintf(&quot;%.2f&quot;, vals$median) } minmaxevent &lt;- function(ARM) { vals &lt;- subset(adtte, TRT01A == ARM) sprintf(&quot;%.2f, %.2f&quot;, min(vals$AVAL), max(vals$AVAL)) } eventCI &lt;- function(ARM) { vals &lt;- subset(surv_tbl, TRT01A == ARM) sprintf(&quot;[%.2f, %.2f]&quot;, vals$`0.95LCL`, vals$`0.95UCL`) } heading &lt;- tabular(Heading(&quot;&quot;)*count ~ Heading()*ARM, data = adsl) part1 &lt;- tabular( Heading(&quot;Subjects with serious adverse events&quot;)* events*Heading()* valuepercent*Arguments(ARM = TRT01A) ~ Heading()*TRT01A, data = surv_tbl ) part2 &lt;- tabular( Heading(&quot;Number of censored subjects&quot;)* blanks + Factor(CNSDTDSC, &quot;&quot;)* Heading()*countpercentid*Arguments(ARM = TRT01A)* Heading()*USUBJID ~ Heading()*TRT01A, data = subset(adtte, nchar(CNSDTDSC) &gt; 0)) part3 &lt;- tabular( ( Heading(&quot;Hazard ratio&quot;)*hazardratio + Heading(&quot;95% confidence interval&quot;)*hazardratioconfint + Heading(&quot;p-value (one-sided stratified log rank)&quot;)*hazardpvalue + Heading(&quot;Time to first serious adverse event&quot;)*blanks + Heading(&quot;Median (years)&quot;)*Median + Heading(&quot;95% confidence interval&quot;)*eventCI + Heading(&quot;Min, Max&quot;)*minmaxevent)* Heading()*as.character(TRT01A) ~ Heading()*TRT01A, data = surv_tbl) rbind(heading, part1, part2, part3) #table324bf66ce8c .Rtable thead, .Rtable .even { background-color: inherit; } #table324bf66ce8c .left { text-align:left; } #table324bf66ce8c .center { text-align:center; } #table324bf66ce8c .right { text-align:right; } #table324bf66ce8c .Rtable, #table324bf66ce8c .Rtable thead { border-collapse: collapse; border-style: solid; border-width: medium 0; border-color: inherit; } #table324bf66ce8c .Rtable th, #table324bf66ce8c .Rtable td { padding-left: 0.5em; padding-right: 0.5em; border-width: 0; } A: Drug X B: Placebo C: Combination (N=134) (N=134) (N=132) Subjects with serious adverse events 89 (66.42%) 123 (91.79%) 88 (66.67%) Number of censored subjects       Clinical Cut Off 10 (7.46%) 4 (2.99%) 14 (10.61%) Completion or Discontinuation 13 (9.70%) 3 (2.24%) 16 (12.12%) End of AE Reporting Period 22 (16.42%) 4 (2.99%) 14 (10.61%) Hazard ratio   1.5 1.1 95% confidence interval   (1.1, 1.9) (0.8, 1.5) p-value (one-sided stratified log rank)   0.0208 0.4619 Time to first serious adverse event       Median (years) 0.39 0.37 0.26 95% confidence interval [0.23, 0.60] [0.25, 0.46] [0.18, 0.34] Min, Max 0.00, 3.00 0.00, 3.00 0.00, 3.00 4.5 Concomitant Medications 4.5.1 gt Code resetSession() library(dplyr) library(tidyr) library(gt) data(&quot;cadcm&quot;, package = &quot;random.cdisc.data&quot;) data(&quot;cadsl&quot;, package = &quot;random.cdisc.data&quot;) cmdecod_levels &lt;- c(&quot;Number of sujects with any concomitant medication&quot;, levels(cadcm$CMDECOD)) cmclas_levels &lt;- c(NA, levels(cadcm$CMCLAS)) adcm &lt;- cadcm |&gt; select(CMDECOD, CMCLAS, TRT01A) |&gt; mutate( CMDECOD = factor(CMDECOD, levels = cmdecod_levels), CMCLAS = factor(CMCLAS, levels = cmclas_levels) ) ct_cm &lt;- dplyr::group_by(cadcm, TRT01A) |&gt; dplyr::summarize(n = dplyr::n_distinct(USUBJID)) |&gt; dplyr::left_join(count(cadsl, TRT01A, name = &quot;nall&quot;), by = &quot;TRT01A&quot;) |&gt; dplyr::mutate(pct = n / nall, nall = NULL, CMDECOD = factor(&quot;Number of sujects with any concomitant medication&quot;, levels = cmdecod_levels)) ct_adcm &lt;- dplyr::group_by(cadcm, TRT01A, CMCLAS, CMDECOD) |&gt; dplyr::summarize(n = dplyr::n_distinct(USUBJID)) |&gt; dplyr::left_join(count(cadsl, TRT01A, name = &quot;nall&quot;), by = &quot;TRT01A&quot;) |&gt; dplyr::mutate(pct = n / nall, nall = NULL) gt_adcm &lt;- dplyr::bind_rows(ct_cm, ct_adcm) |&gt; tidyr::pivot_wider(id_cols = c(CMCLAS, CMDECOD), names_from = TRT01A, values_from = c(n, pct)) ## don&#39;t print it yet, uncomment when its ready ##gt_adcm %&gt;% gt() trt_n &lt;- cadsl |&gt; dplyr::filter(SAFFL == &quot;Y&quot;) |&gt; dplyr::group_by(TRT01A) |&gt; dplyr::summarize(n = sprintf(&quot;%s \\nN=%i (100%%)&quot;, unique(TRT01A), dplyr::n())) |&gt; dplyr::ungroup() tab_n &lt;- dplyr::pull(trt_n, n) |&gt; as.list() names(tab_n) &lt;- paste(&quot;n&quot;, dplyr::pull(trt_n, TRT01A), sep = &quot;_&quot;) gt_adcm |&gt; gt(rowname_col = &quot;CMDECOD&quot;) |&gt; tab_header( title = &quot;Conmed Example&quot;, subtitle = md(&quot;Uses the *adcm* dataset from **random.cdisc.data**&quot;) ) |&gt; opt_align_table_header(align = &quot;left&quot;) |&gt; fmt_percent(columns = dplyr::starts_with(&quot;pct_&quot;), decimals = 1) |&gt; cols_merge_n_pct(col_n = &quot;n_A: Drug X&quot;, col_pct = &quot;pct_A: Drug X&quot;) |&gt; cols_merge_n_pct(col_n = &quot;n_B: Placebo&quot;, col_pct = &quot;pct_B: Placebo&quot;) |&gt; cols_merge_n_pct(col_n = &quot;n_C: Combination&quot;, col_pct = &quot;pct_C: Combination&quot;) |&gt; tab_row_group( label = &quot;medcl A&quot;, rows = CMCLAS == &quot;medcl A&quot; ) |&gt; tab_row_group( label = &quot;medcl B&quot;, rows = CMCLAS == &quot;medcl B&quot; ) |&gt; tab_row_group( label = &quot;medcl C&quot;, rows = CMCLAS == &quot;medcl C&quot; ) |&gt; row_group_order( groups = c(NA, paste(&quot;medcl&quot;, LETTERS[1:2])) ) |&gt; cols_hide(CMCLAS) |&gt; cols_label( `n_A: Drug X` = md(tab_n[[1]]), `n_B: Placebo` = md(tab_n[[2]]), `n_C: Combination` = md(tab_n[[3]]) ) |&gt; cols_width( 1 ~ px(500), everything() ~ px(150) ) |&gt; cols_align( align = &quot;center&quot;, columns = everything() ) |&gt; cols_align( align = &quot;left&quot;, columns = 1 ) html { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Helvetica Neue', 'Fira Sans', 'Droid Sans', Arial, sans-serif; } #eljctvvsab .gt_table { display: table; border-collapse: collapse; margin-left: auto; margin-right: auto; color: #333333; font-size: 16px; font-weight: normal; font-style: normal; background-color: #FFFFFF; width: auto; border-top-style: solid; border-top-width: 2px; border-top-color: #A8A8A8; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #A8A8A8; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; } #eljctvvsab .gt_heading { background-color: #FFFFFF; text-align: left; border-bottom-color: #FFFFFF; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #eljctvvsab .gt_caption { padding-top: 4px; padding-bottom: 4px; } #eljctvvsab .gt_title { color: #333333; font-size: 125%; font-weight: initial; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; border-bottom-color: #FFFFFF; border-bottom-width: 0; } #eljctvvsab .gt_subtitle { color: #333333; font-size: 85%; font-weight: initial; padding-top: 0; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; border-top-color: #FFFFFF; border-top-width: 0; } #eljctvvsab .gt_bottom_border { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #eljctvvsab .gt_col_headings { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; } #eljctvvsab .gt_col_heading { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 6px; padding-left: 5px; padding-right: 5px; overflow-x: hidden; } #eljctvvsab .gt_column_spanner_outer { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: normal; text-transform: inherit; padding-top: 0; padding-bottom: 0; padding-left: 4px; padding-right: 4px; } #eljctvvsab .gt_column_spanner_outer:first-child { padding-left: 0; } #eljctvvsab .gt_column_spanner_outer:last-child { padding-right: 0; } #eljctvvsab .gt_column_spanner { border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: bottom; padding-top: 5px; padding-bottom: 5px; overflow-x: hidden; display: inline-block; width: 100%; } #eljctvvsab .gt_group_heading { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; text-align: left; } #eljctvvsab .gt_empty_group_heading { padding: 0.5px; color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; vertical-align: middle; } #eljctvvsab .gt_from_md > :first-child { margin-top: 0; } #eljctvvsab .gt_from_md > :last-child { margin-bottom: 0; } #eljctvvsab .gt_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; margin: 10px; border-top-style: solid; border-top-width: 1px; border-top-color: #D3D3D3; border-left-style: none; border-left-width: 1px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 1px; border-right-color: #D3D3D3; vertical-align: middle; overflow-x: hidden; } #eljctvvsab .gt_stub { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; } #eljctvvsab .gt_stub_row_group { color: #333333; background-color: #FFFFFF; font-size: 100%; font-weight: initial; text-transform: inherit; border-right-style: solid; border-right-width: 2px; border-right-color: #D3D3D3; padding-left: 5px; padding-right: 5px; vertical-align: top; } #eljctvvsab .gt_row_group_first td { border-top-width: 2px; } #eljctvvsab .gt_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #eljctvvsab .gt_first_summary_row { border-top-style: solid; border-top-color: #D3D3D3; } #eljctvvsab .gt_first_summary_row.thick { border-top-width: 2px; } #eljctvvsab .gt_last_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #eljctvvsab .gt_grand_summary_row { color: #333333; background-color: #FFFFFF; text-transform: inherit; padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; } #eljctvvsab .gt_first_grand_summary_row { padding-top: 8px; padding-bottom: 8px; padding-left: 5px; padding-right: 5px; border-top-style: double; border-top-width: 6px; border-top-color: #D3D3D3; } #eljctvvsab .gt_striped { background-color: rgba(128, 128, 128, 0.05); } #eljctvvsab .gt_table_body { border-top-style: solid; border-top-width: 2px; border-top-color: #D3D3D3; border-bottom-style: solid; border-bottom-width: 2px; border-bottom-color: #D3D3D3; } #eljctvvsab .gt_footnotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #eljctvvsab .gt_footnote { margin: 0px; font-size: 90%; padding-left: 4px; padding-right: 4px; padding-left: 5px; padding-right: 5px; } #eljctvvsab .gt_sourcenotes { color: #333333; background-color: #FFFFFF; border-bottom-style: none; border-bottom-width: 2px; border-bottom-color: #D3D3D3; border-left-style: none; border-left-width: 2px; border-left-color: #D3D3D3; border-right-style: none; border-right-width: 2px; border-right-color: #D3D3D3; } #eljctvvsab .gt_sourcenote { font-size: 90%; padding-top: 4px; padding-bottom: 4px; padding-left: 5px; padding-right: 5px; } #eljctvvsab .gt_left { text-align: left; } #eljctvvsab .gt_center { text-align: center; } #eljctvvsab .gt_right { text-align: right; font-variant-numeric: tabular-nums; } #eljctvvsab .gt_font_normal { font-weight: normal; } #eljctvvsab .gt_font_bold { font-weight: bold; } #eljctvvsab .gt_font_italic { font-style: italic; } #eljctvvsab .gt_super { font-size: 65%; } #eljctvvsab .gt_footnote_marks { font-style: italic; font-weight: normal; font-size: 75%; vertical-align: 0.4em; } #eljctvvsab .gt_asterisk { font-size: 100%; vertical-align: 0; } #eljctvvsab .gt_indent_1 { text-indent: 5px; } #eljctvvsab .gt_indent_2 { text-indent: 10px; } #eljctvvsab .gt_indent_3 { text-indent: 15px; } #eljctvvsab .gt_indent_4 { text-indent: 20px; } #eljctvvsab .gt_indent_5 { text-indent: 25px; } Conmed Example Uses the adcm dataset from random.cdisc.data A: Drug X N=134 (100%) B: Placebo N=134 (100%) C: Combination N=132 (100%) Number of sujects with any concomitant medication 122 (91.0%) 123 (91.8%) 120 (90.9%) medcl A medname A_1/3 54 (40.3%) 49 (36.6%) 69 (52.3%) medname A_2/3 53 (39.6%) 50 (37.3%) 56 (42.4%) medname A_3/3 45 (33.6%) 54 (40.3%) 48 (36.4%) medcl B medname B_1/4 52 (38.8%) 57 (42.5%) 59 (44.7%) medname B_2/4 52 (38.8%) 55 (41.0%) 56 (42.4%) medname B_3/4 47 (35.1%) 47 (35.1%) 52 (39.4%) medname B_4/4 50 (37.3%) 45 (33.6%) 55 (41.7%) medcl C medname C_1/2 51 (38.1%) 50 (37.3%) 56 (42.4%) medname C_2/2 52 (38.8%) 58 (43.3%) 60 (45.5%) 4.5.2 flextable Code resetSession() library(flextable) library(dplyr) library(forcats) data(&quot;cadcm&quot;, package = &quot;random.cdisc.data&quot;) data(&quot;cadsl&quot;, package = &quot;random.cdisc.data&quot;) cmdecod_levels &lt;- c(&quot;N_CM&quot;, levels(cadcm$CMDECOD)) cmclas_levels &lt;- c(&quot;N_CM&quot;, levels(cadcm$CMCLAS)) adcm &lt;- cadcm |&gt; select(CMDECOD, CMCLAS, TRT01A) |&gt; mutate( CMDECOD = factor(CMDECOD, levels = cmdecod_levels), CMCLAS = factor(CMCLAS, levels = cmclas_levels) ) trt_count &lt;- group_by(cadsl, TRT01A) |&gt; summarise(n = n()) trt_count &lt;- setNames(trt_count$n, trt_count$TRT01A) ct_cm &lt;- group_by(cadcm, TRT01A) |&gt; summarise(n = n_distinct(USUBJID)) |&gt; left_join(count(cadsl, TRT01A, name = &quot;nall&quot;), by = &quot;TRT01A&quot;) |&gt; mutate(pct = n / nall, nall = NULL, CMCLAS = factor(&quot;N_CM&quot;, levels = cmclas_levels), CMDECOD = factor(&quot;N_CM&quot;, levels = cmdecod_levels)) ct_adcm &lt;- group_by(cadcm, TRT01A, CMCLAS, CMDECOD) |&gt; summarize(n = n_distinct(USUBJID)) |&gt; ungroup() |&gt; left_join(count(cadsl, TRT01A, name = &quot;nall&quot;), by = &quot;TRT01A&quot;) |&gt; mutate(pct = n / nall, nall = NULL) dat &lt;- bind_rows(ct_cm, ct_adcm) tab &lt;- tabulator( dat, rows = c(&quot;CMCLAS&quot;, &quot;CMDECOD&quot;), columns = &quot;TRT01A&quot;, cts = as_paragraph(fmt_n_percent(n, pct))) ft &lt;- as_flextable(tab, spread_first_col = TRUE) |&gt; prepend_chunks( i = ~ is.na(CMCLAS) &amp; seq_along(CMCLAS) &gt; 1, j = 1, as_chunk(&quot;\\t&quot;) ) for(TRT01A_COD in names(trt_count)){ ft &lt;- append_chunks( x = ft, part = &quot;header&quot;, i = 1, j = tabulator_colnames(tab, columns = &quot;cts&quot;, TRT01A %in% !!TRT01A_COD), as_chunk(trt_count[TRT01A_COD], formatter = fmt_header_n) ) } ft &lt;- autofit(ft) |&gt; align(j = 1, align = &quot;left&quot;) |&gt; labelizor(part = &quot;all&quot;, j = &quot;CMDECOD&quot;, labels = c(CMDECOD=&quot;&quot;, N_CM = &quot;Number of sujects with any concomitant medication&quot;)) |&gt; hline_top(part = &quot;header&quot;, border = fp_border_default(width=2)) |&gt; set_caption(&quot;Conmed Example\\nUses the &#39;adcm&#39; dataset from &#39;random.cdisc.data&#39;&quot;) ft .tabwid table{ border-spacing:0px !important; border-collapse:collapse; line-height:1; margin-left:auto; margin-right:auto; border-width: 0; border-color: transparent; caption-side: top; } .tabwid-caption-bottom table{ caption-side: bottom; } .tabwid_left table{ margin-left:0; } .tabwid_right table{ margin-right:0; } .tabwid td, .tabwid th { padding: 0; } .tabwid a { text-decoration: none; } .tabwid thead { background-color: transparent; } .tabwid tfoot { background-color: transparent; } .tabwid table tr { background-color: transparent; } .katex-display { margin: 0 0 !important; } .cl-5e9354f8{}.cl-5e8b1cca{font-family:'Open Sans';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5e8b1cd4{font-family:'Open Sans';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5e8e959e{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5e8e95b2{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-5e8e95bc{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5e8e95c6{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5e8e95c7{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-5e8e95d0{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5e8e95d1{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-5e8eae94{width:1.782in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 2pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5e8eae9e{width:0.1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 2pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5e8eaea8{width:0.957in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 2pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5e8eaeb2{width:1.206in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 2pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5e8eaeb3{width:1.782in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5e8eaebc{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5e8eaebd{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5e8eaec6{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5e8eaec7{width:1.782in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5e8eaed0{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5e8eaed1{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5e8eaeda{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5e8eaee4{width:1.782in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5e8eaee5{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5e8eaeee{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5e8eaef8{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5e8eaef9{width:1.782in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5e8eaefa{width:0.957in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5e8eaf02{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;} Table 4.1: Conmed Example Uses the ‘adcm’ dataset from ‘random.cdisc.data’ A: Drug X(N=134)B: Placebo(N=134)C: Combination(N=132)Number of sujects with any concomitant medication122 (91.0%)123 (91.8%)120 (90.9%)medcl A&emsp;medname A_1/354 (40.3%)49 (36.6%)69 (52.3%)&emsp;medname A_2/353 (39.6%)50 (37.3%)56 (42.4%)&emsp;medname A_3/345 (33.6%)54 (40.3%)48 (36.4%)medcl B&emsp;medname B_1/452 (38.8%)57 (42.5%)59 (44.7%)&emsp;medname B_2/452 (38.8%)55 (41.0%)56 (42.4%)&emsp;medname B_3/447 (35.1%)47 (35.1%)52 (39.4%)&emsp;medname B_4/450 (37.3%)45 (33.6%)55 (41.7%)medcl C&emsp;medname C_1/251 (38.1%)50 (37.3%)56 (42.4%)&emsp;medname C_2/252 (38.8%)58 (43.3%)60 (45.5%) 4.5.3 tables Code resetSession() data(&quot;cadcm&quot;, package = &quot;random.cdisc.data&quot;) library(tables) table_options(doCSS = TRUE) subject_counts &lt;- table(adsl$ARM) countpercentid &lt;- function(num, ARM) { n &lt;- length(unique(num)) sprintf(&quot;%d (%.2f%%)&quot;, length(unique(num)), 100*n/subject_counts[ARM[1]]) } count &lt;- function(x) sprintf(&quot;(N=%d)&quot;, length(x)) heading &lt;- tabular(Heading(&quot;&quot;)*1*Heading(&quot;&quot;)*count ~ Heading()*ARM, data = adsl) body &lt;- tabular( (Heading(&quot;Any concomitant medication&quot;)*1 + Heading()*CMCLAS* Heading()*CMDECOD*DropEmpty())* Heading()*countpercentid*Arguments(ARM = TRT01A)* Heading()*USUBJID ~ Heading()*TRT01A, data = cadcm) rbind(heading, body) #table324b23cdb8cf .Rtable thead, .Rtable .even { background-color: inherit; } #table324b23cdb8cf .left { text-align:left; } #table324b23cdb8cf .center { text-align:center; } #table324b23cdb8cf .right { text-align:right; } #table324b23cdb8cf .Rtable, #table324b23cdb8cf .Rtable thead { border-collapse: collapse; border-style: solid; border-width: medium 0; border-color: inherit; } #table324b23cdb8cf .Rtable th, #table324b23cdb8cf .Rtable td { padding-left: 0.5em; padding-right: 0.5em; border-width: 0; } A: Drug X B: Placebo C: Combination (N=134) (N=134) (N=132) Any concomitant medication 122 (91.04%) 123 (91.79%) 120 (90.91%) medcl A medname A_1/3 54 (40.30%) 49 (36.57%) 69 (52.27%)   medname A_2/3 53 (39.55%) 50 (37.31%) 56 (42.42%)   medname A_3/3 45 (33.58%) 54 (40.30%) 48 (36.36%) medcl B medname B_1/4 52 (38.81%) 57 (42.54%) 59 (44.70%)   medname B_2/4 52 (38.81%) 55 (41.04%) 56 (42.42%)   medname B_3/4 47 (35.07%) 47 (35.07%) 52 (39.39%)   medname B_4/4 50 (37.31%) 45 (33.58%) 55 (41.67%) medcl C medname C_1/2 51 (38.06%) 50 (37.31%) 56 (42.42%)   medname C_2/2 52 (38.81%) 58 (43.28%) 60 (45.45%) 4.6 Disposition 4.6.1 rtables Code resetSession() library(dplyr) library(magrittr) library(rtables) data(&quot;cadsl&quot;, package = &quot;random.cdisc.data&quot;) r_adsl &lt;- cadsl %&gt;% select(USUBJID, EOSSTT, DCSREAS) %&gt;% filter(EOSSTT != &quot;COMPLETED&quot;) lyt &lt;- basic_table() build_table(lyt, r_adsl) all obs —————————— 4.6.2 flextable Code resetSession() library(survival) library(tidyverse) library(flextable) library(glue) adsl &lt;- cadsl |&gt; select(USUBJID, TRT01A, EOSSTT, DCSREAS) labels &lt;- tools::toTitleCase(tolower(levels(adsl$DCSREAS))) names(labels) &lt;- levels(adsl$DCSREAS) # data parts calculations part_header &lt;- adsl |&gt; count(TRT01A, name = &quot;n_part&quot;) part_completed &lt;- adsl |&gt; filter(EOSSTT %in% &quot;COMPLETED&quot;) |&gt; mutate(DCSREAS = &quot;&quot;) |&gt; count(TRT01A, EOSSTT, DCSREAS) part_discontinued &lt;- adsl |&gt; filter(EOSSTT %in% &quot;DISCONTINUED&quot;) |&gt; count(TRT01A, EOSSTT, DCSREAS) part_death &lt;- cadsl |&gt; filter(EOSSTT %in% &quot;DISCONTINUED&quot;, DCSREAS %in% &quot;DEATH&quot;) |&gt; count(TRT01A, EOSSTT, DTHCAUS) |&gt; mutate(EOSSTT = forcats::fct_expand(EOSSTT, &quot;Death Cause&quot;), EOSSTT = &quot;Death Cause&quot;, DTHCAUS = tools::toTitleCase(tolower(DTHCAUS)) ) |&gt; rename(DCSREAS = DTHCAUS) dat &lt;- bind_rows( part_completed, part_discontinued, part_death) |&gt; inner_join(part_header, by = &quot;TRT01A&quot;) |&gt; mutate(percent = n / n_part, n_part = NULL) # Now the flextable creation with help of `tabulator()`. tab &lt;- tabulator( dat, rows = c(&quot;EOSSTT&quot;, &quot;DCSREAS&quot;), columns = &quot;TRT01A&quot;, `content_cell` = as_paragraph(fmt_n_percent(n, percent)) ) ft &lt;- as_flextable(tab, spread_first_col = TRUE, columns_alignment = &quot;right&quot; ) TRT_COUNTS &lt;- setNames(part_header$n_part, part_header$TRT01A) for (TRT_COD in names(TRT_COUNTS)) { ft &lt;- append_chunks(x = ft, part = &quot;header&quot;, i = 1, j = tabulator_colnames(tab, columns = &quot;content_cell&quot;, TRT01A %in% !!TRT_COD), as_chunk(TRT_COUNTS[TRT_COD], formatter = function(n) sprintf(&quot;\\n(N=%.0f)&quot;, n))) } ft &lt;- ft |&gt; labelizor( labels = c(labels, DCSREAS = &quot;&quot;, ANY = &quot;Number of patients&quot;, COMPLETED = &quot;Completed&quot;, DISCONTINUED = &quot;Discontinued&quot;), j = &quot;DCSREAS&quot;, part = &quot;all&quot;) |&gt; align(i = ~!is.na(EOSSTT) | seq_along(EOSSTT) == 1, j = 1, align = &quot;left&quot;) |&gt; prepend_chunks(i = ~is.na(EOSSTT), j = &quot;DCSREAS&quot;, as_chunk(&quot;\\t&quot;)) |&gt; autofit() ft .tabwid table{ border-spacing:0px !important; border-collapse:collapse; line-height:1; margin-left:auto; margin-right:auto; border-width: 0; border-color: transparent; caption-side: top; } .tabwid-caption-bottom table{ caption-side: bottom; } .tabwid_left table{ margin-left:0; } .tabwid_right table{ margin-right:0; } .tabwid td, .tabwid th { padding: 0; } .tabwid a { text-decoration: none; } .tabwid thead { background-color: transparent; } .tabwid tfoot { background-color: transparent; } .tabwid table tr { background-color: transparent; } .katex-display { margin: 0 0 !important; } .cl-5f69cdda{}.cl-5f619ed0{font-family:'Open Sans';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5f619ee4{font-family:'Open Sans';font-size:10pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-5f64f918{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5f64f922{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-5f64f936{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5f64f940{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5f64f941{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-5f64f94a{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:3pt;padding-top:3pt;padding-left:3pt;padding-right:3pt;line-height: 1.4;background-color:transparent;}.cl-5f64f94b{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:0;padding-top:0;padding-left:0;padding-right:0;line-height: 1.4;background-color:transparent;}.cl-5f65131c{width:2.772in;background-color:transparent;vertical-align: bottom;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f651326{width:0.1in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f651330{width:0.877in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f65133a{width:0.882in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f65133b{width:1.206in;background-color:transparent;vertical-align: middle;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 1.5pt solid rgba(170, 170, 170, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f651344{width:2.772in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f651345{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f651346{width:0.877in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f65134e{width:0.882in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f651358{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f651359{width:2.772in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f65135a{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f651362{width:0.877in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f65136c{width:0.882in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f65136d{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f65136e{width:2.772in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f651376{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f651377{width:0.877in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f651378{width:0.882in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f651380{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f651381{width:2.772in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f65138a{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f65138b{width:0.877in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f651394{width:0.882in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f651395{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f65139e{width:2.772in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f65139f{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f6513a8{width:0.877in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f6513a9{width:0.882in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f6513aa{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f6513b2{width:2.772in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f6513b3{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f6513bc{width:0.877in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f6513bd{width:0.882in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f6513c6{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f6513c7{width:2.772in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f6513c8{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f6513d0{width:0.877in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f6513d1{width:0.882in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f6513da{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f6513db{width:0.1in;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f6513e4{width:2.772in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f6513e5{width:0.877in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f6513ee{width:0.882in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-5f6513ef{width:1.206in;background-color:transparent;vertical-align: top;border-bottom: 1.5pt solid rgba(170, 170, 170, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}A: Drug X(N=134)B: Placebo(N=134)C: Combination(N=132)Completed68 (50.7%)66 (49.3%)73 (55.3%)Discontinued&emsp;Adverse Event3 (02.2%)6 (04.5%)5 (03.8%)&emsp;Death25 (18.7%)23 (17.2%)22 (16.7%)&emsp;Lack of Efficacy2 (01.5%)2 (01.5%)3 (02.3%)&emsp;Physician Decision2 (01.5%)3 (02.2%)2 (01.5%)&emsp;Protocol Violation5 (03.7%)3 (02.2%)4 (03.0%)&emsp;Withdrawal by Parent/Guardian4 (03.0%)2 (01.5%)1 (00.8%)&emsp;Withdrawal by Subject1 (00.7%)1 (00.7%)1 (00.8%)Death Cause&emsp;Adverse Event9 (06.7%)7 (05.2%)10 (07.6%)&emsp;Disease Progression8 (06.0%)6 (04.5%)6 (04.5%)&emsp;Lost to Follow Up2 (01.5%)2 (01.5%)2 (01.5%)&emsp;Missing2 (01.5%)3 (02.2%)2 (01.5%)&emsp;Post-Study Reporting of Death1 (00.7%)2 (01.5%)1 (00.8%)&emsp;Suicide2 (01.5%)2 (01.5%)1 (00.8%)&emsp;Unknown1 (00.7%)1 (00.7%) 4.6.3 tables Code resetSession() adsl &lt;- cadsl # Change the labels to title case levels(adsl$EOSSTT) &lt;- tools::toTitleCase(tolower(levels(adsl$EOSSTT))) levels(adsl$DCSREAS) &lt;- tools::toTitleCase(tolower(levels(adsl$DCSREAS))) levels(adsl$DTHCAUS) &lt;- tools::toTitleCase(tolower(levels(adsl$DTHCAUS))) library(tables) subject_counts &lt;- table(adsl$ARM) countpercentid &lt;- function(num, ARM) { n &lt;- length(unique(num)) sprintf(&quot;%d (%.2f%%)&quot;, length(unique(num)), 100*n/subject_counts[ARM[1]]) } count &lt;- function(x) sprintf(&quot;(N=%d)&quot;, length(x)) heading &lt;- tabular(Heading(&quot;&quot;)*1*Heading(&quot;&quot;)*count ~ Heading()*TRT01A, data = adsl) part1 &lt;- tabular( Heading(&quot;&quot;)*EOSSTT*DropEmpty()* Heading(&quot;&quot;)*1* Heading()*countpercentid*Arguments(ARM = TRT01A)* Heading()*USUBJID ~ Heading()*TRT01A, data = subset(adsl, EOSSTT != &quot;Discontinued&quot;)) part2 &lt;- tabular( Heading(&quot;&quot;)*EOSSTT* Heading(&quot;&quot;)*DCSREAS*DropEmpty()* Heading()*countpercentid*Arguments(ARM = TRT01A)* Heading()*USUBJID ~ Heading()*TRT01A, data = subset(adsl, EOSSTT == &quot;Discontinued&quot; &amp; DCSREAS != &quot;Death&quot;)) part3 &lt;- tabular( Heading(&quot;&quot;)*DCSREAS* Heading(&quot;&quot;)*DTHCAUS*DropEmpty()* Heading()*countpercentid*Arguments(ARM = TRT01A)* Heading()*USUBJID ~ Heading()*TRT01A, data = subset(adsl, EOSSTT == &quot;Discontinued&quot; &amp; DCSREAS == &quot;Death&quot;)) rbind(heading, part1, part2, part3) #table324b5dfc324 .Rtable thead, .Rtable .even { background-color: inherit; } #table324b5dfc324 .left { text-align:left; } #table324b5dfc324 .center { text-align:center; } #table324b5dfc324 .right { text-align:right; } #table324b5dfc324 .Rtable, #table324b5dfc324 .Rtable thead { border-collapse: collapse; border-style: solid; border-width: medium 0; border-color: inherit; } #table324b5dfc324 .Rtable th, #table324b5dfc324 .Rtable td { padding-left: 0.5em; padding-right: 0.5em; border-width: 0; } A: Drug X B: Placebo C: Combination (N=134) (N=134) (N=132) Completed 68 (50.75%) 66 (49.25%) 73 (55.30%) Ongoing 24 (17.91%) 28 (20.90%) 21 (15.91%) Discontinued Adverse Event 3 (2.24%) 6 (4.48%) 5 (3.79%)   Lack of Efficacy 2 (1.49%) 2 (1.49%) 3 (2.27%)   Physician Decision 2 (1.49%) 3 (2.24%) 2 (1.52%)   Protocol Violation 5 (3.73%) 3 (2.24%) 4 (3.03%)   Withdrawal by Parent/Guardian 4 (2.99%) 2 (1.49%) 1 (0.76%)   Withdrawal by Subject 1 (0.75%) 1 (0.75%) 1 (0.76%) Death Adverse Event 9 (6.72%) 7 (5.22%) 10 (7.58%)   Disease Progression 8 (5.97%) 6 (4.48%) 6 (4.55%)   Lost to Follow Up 2 (1.49%) 2 (1.49%) 2 (1.52%)   Missing 2 (1.49%) 3 (2.24%) 2 (1.52%)   Post-Study Reporting of Death 1 (0.75%) 2 (1.49%) 1 (0.76%)   Suicide 2 (1.49%) 2 (1.49%) 1 (0.76%)   Unknown 1 (0.75%) 1 (0.75%)   "],["references.html", "References", " References "]]
